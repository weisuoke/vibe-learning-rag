# 30字核心

> **一句话掌握 Provider 与 Model 切换的本质**

---

## 核心表达

**Pi 支持 15+ Provider 动态切换，通过 Ctrl+P 快速循环 Scoped Models，配置分层优先，实现成本优化与多模型协作**

---

## 关键词解析

### 15+ Provider
- **内置支持**：Anthropic (Claude)、OpenAI (GPT)、xAI (Grok)、Google (Gemini)、Mistral、Cohere、Groq 等
- **自定义集成**：Ollama、LM Studio、OpenRouter、Azure OpenAI、AWS Bedrock
- **统一接口**：所有 Provider 通过相同的 API 抽象层调用

### 动态切换
- **运行时切换**：无需重启，通过 `/model` 命令即时切换
- **热重载**：`/reload` 命令重新加载配置文件
- **会话延续**：`/session` 命令在不同模型间继续对话

### Ctrl+P 快速循环
- **键盘快捷键**：`Ctrl+P` 向前循环，`Shift+Ctrl+P` 向后循环
- **Scoped Models**：预配置 3-5 个常用模型，快速切换
- **零中断**：切换过程不影响当前工作流

### 配置分层优先
- **优先级顺序**：CLI 参数 > 项目配置 (.pi/settings.json) > 全局配置 (~/.pi/agent/settings.json) > 环境变量 > 默认值
- **灵活覆盖**：项目级配置可覆盖全局设置
- **安全存储**：API 密钥存储在 auth.json (0600 权限)

### 成本优化
- **任务分级**：简单任务用 Haiku，复杂任务用 Sonnet，极端情况用 Opus
- **成本对比**：Haiku ($0.25/MTok) vs Sonnet ($3/MTok) vs Opus ($15/MTok)
- **智能选择**：根据任务复杂度自动选择合适模型

### 多模型协作
- **Fallback 链**：主模型失败时自动切换到备用模型
- **专业分工**：代码生成用 Claude，数据分析用 GPT-4，本地测试用 Ollama
- **并行验证**：同一任务用不同模型验证结果

---

## 为什么这 30 字重要？

### 1. 抓住核心能力
- **Provider 多样性**：15+ 选择覆盖所有主流 LLM
- **切换便捷性**：Ctrl+P 一键切换，无需命令行
- **配置灵活性**：分层优先级满足不同场景

### 2. 解决实际问题
- **成本控制**：通过模型选择降低 80% API 费用
- **可靠性保障**：Fallback 机制避免单点故障
- **开发效率**：快捷键切换节省 90% 操作时间

### 3. 体现设计哲学
- **抽象统一**：Provider 抽象层屏蔽底层差异
- **配置优先**：声明式配置优于命令式操作
- **用户友好**：键盘快捷键优于命令行输入

---

## 与 AI Agent 开发的联系

### 场景 1：成本优化
```typescript
// 任务分级策略
const taskComplexity = analyzeTask(userInput);
if (taskComplexity === 'simple') {
  switchModel('claude-3-5-haiku-20241022');  // $0.25/MTok
} else if (taskComplexity === 'medium') {
  switchModel('claude-3-5-sonnet-20241022'); // $3/MTok
} else {
  switchModel('claude-opus-4-20250514');     // $15/MTok
}
```

### 场景 2：多模型协作
```typescript
// 代码生成 + 代码审查
const code = await generateCode('claude-3-5-sonnet-20241022');
const review = await reviewCode('gpt-4-turbo', code);
const finalCode = await refineCode('claude-opus-4-20250514', code, review);
```

### 场景 3：本地开发 + 云端部署
```typescript
// 开发阶段用本地模型
if (process.env.NODE_ENV === 'development') {
  setProvider('ollama', 'llama3.1:8b');
} else {
  // 生产环境用云端模型
  setProvider('anthropic', 'claude-3-5-sonnet-20241022');
}
```

---

## 速记口诀

**15 家供应商，Ctrl+P 快切换**
**配置分三层，成本能优化**
**多模型协作，AI Agent 必备**

---

## 下一步

- **深入理解**：阅读 [02_第一性原理.md](./02_第一性原理.md) 了解为什么需要 Provider 切换
- **核心概念**：阅读 [03_核心概念_01_Provider定义与配置.md](./03_核心概念_01_Provider定义与配置.md) 学习配置方法
- **快速上手**：阅读 [04_最小可用.md](./04_最小可用.md) 掌握 20% 核心知识

---

**记住**：Provider 切换不是为了炫技，而是为了在成本、性能、可靠性之间找到最佳平衡点。
