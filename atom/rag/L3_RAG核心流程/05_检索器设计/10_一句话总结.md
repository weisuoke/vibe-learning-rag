# 一句话总结

**检索器是 RAG 系统的查询引擎，通过向量检索（语义匹配）、关键词检索（精确匹配）或混合检索（两者结合）从知识库中找到最相关的 Top-K 文档，配合相似度阈值和 MMR 多样性控制，为 LLM 提供高质量的上下文，是实现精准问答的关键组件。**

---

## 核心要点回顾

| 维度 | 核心内容 |
|------|----------|
| **定义** | 从知识库中找到最相关文档的组件 |
| **三种类型** | 向量检索、关键词检索、混合检索 |
| **关键参数** | Top-K、相似度阈值、MMR |
| **生产推荐** | 混合检索 + 适当的 Top-K |
| **核心价值** | 检索质量决定答案质量 |

---

## 检索器设计公式

```
高效检索器 = 混合检索策略 + 合适的 Top-K + 质量过滤 + 多样性控制
```

---

## 下一步学习

- → [06_上下文注入与生成](../06_上下文注入与生成/) - 将检索结果组装成 Prompt 并生成答案
- → L4_RAG进阶优化 - 混合检索策略、ReRank、Query 改写

---

## 快速参考卡

```
┌─────────────────────────────────────────────────────────────┐
│                    检索器设计速查                             │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  检索器类型：                                                │
│  • 向量检索 → 语义匹配 → 自然语言问答                         │
│  • BM25检索 → 精确匹配 → 代码/错误码搜索                      │
│  • 混合检索 → 两者结合 → 生产环境首选                         │
│                                                             │
│  关键参数：                                                  │
│  • Top-K: 5-10（从5开始调整）                                │
│  • 相似度阈值: 0.6-0.8                                       │
│  • MMR lambda: 0.5（平衡相关性和多样性）                      │
│                                                             │
│  常见误区：                                                  │
│  ✗ Top-K 越大越好 → 会引入噪声和增加成本                      │
│  ✗ 向量检索万能 → 对专有名词不敏感                            │
│  ✗ 相似度高=答案对 → 语义相近≠能回答问题                      │
│                                                             │
│  代码模板：                                                  │
│  retriever = vectorstore.as_retriever(search_kwargs={"k":5})│
│  hybrid = EnsembleRetriever(retrievers=[vec, bm25])         │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 学习检查清单

- [ ] 理解检索器在 RAG 系统中的位置和作用
- [ ] 能区分向量检索和关键词检索的适用场景
- [ ] 知道如何创建混合检索器
- [ ] 能根据场景选择合适的 Top-K 值
- [ ] 理解相似度阈值和 MMR 的作用
- [ ] 能避免检索器设计中的常见误区
- [ ] 能用 LangChain 实现完整的检索器

---

**恭喜完成「检索器设计」学习！**

下一站：[上下文注入与生成](../06_上下文注入与生成/) - 学习如何将检索结果转化为高质量答案。
