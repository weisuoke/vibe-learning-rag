# GraphRAG知识图谱检索 - 概览

> 基于知识图谱的结构化检索技术,将 RAG 准确率提升至 91%

---

## 知识点定位

**层级**: L4_RAG进阶优化 > 新兴架构 > GraphRAG知识图谱检索

**前置知识**:
- ✅ L3_RAG核心流程 (RAG架构、检索器设计、向量存储)
- ✅ L2_LLM核心 (Transformer、Prompt Engineering)
- ✅ L1_NLP基础 (Embedding、语义相似度)

**后续学习**:
- → Agentic RAG智能代理检索
- → Adaptive RAG自适应策略

---

## 为什么学习 GraphRAG?

### 问题场景

**传统 Vector RAG 的局限**:

```python
# 场景: 复杂多跳查询
query = "Alice 和 Bob 通过哪些中间人有联系?"

# Vector RAG 的问题
# ❌ 只能找到 Alice 或 Bob 的相关文档
# ❌ 无法推理多跳关系
# ❌ 缺乏全局理解能力
```

**GraphRAG 的优势**:

```python
# GraphRAG 的能力
# ✅ 构建实体关系图: Alice → Charlie → Bob
# ✅ 多跳推理: 找到中间人 Charlie
# ✅ 全局理解: 社区检测发现关系网络
# ✅ 可解释性: 展示推理路径
```

### 核心价值

1. **准确率提升**: 复杂查询准确率提升 3.4x - 91%
2. **多跳推理**: 支持 2-3 跳关系查询
3. **全局理解**: 社区检测提供整体视角
4. **可解释性**: 清晰的推理路径
5. **成本优化**: LazyGraphRAG 降至 0.1% 成本

---

## 学习目标

学完本知识点,你将能够:

- [ ] 理解 GraphRAG 的核心原理和架构
- [ ] 掌握知识图谱构建的完整流程
- [ ] 实现实体关系提取和社区检测
- [ ] 使用 Local & Global 搜索策略
- [ ] 构建 Vector RAG + Graph RAG 混合系统
- [ ] 优化 GraphRAG 的成本和性能
- [ ] 在生产环境中部署 GraphRAG

---

## 核心内容结构

### 1. 第一性原理 (02)
- GraphRAG 的本质: 结构化知识表示
- 为什么需要图结构?
- 从 Vector 到 Graph 的演进

### 2. 核心概念 (03_1 - 03_5)

**核心概念 1: 知识图谱构建**
- 从文本到图的转换过程
- 实体识别与关系抽取
- 图存储与索引

**核心概念 2: 实体关系提取**
- LLM 驱动的提取策略
- Prompt Engineering 技巧
- 实体消歧与规范化

**核心概念 3: 社区检测算法**
- Leiden 分层聚类
- 社区摘要生成
- 全局理解能力

**核心概念 4: Local vs Global 搜索**
- Local Search: 实体上下文
- Global Search: 社区报告
- DRIFT Search: 动态融合

**核心概念 5: 混合检索策略**
- Vector RAG + Graph RAG 协同
- 查询路由器设计
- 成本优化策略

### 3. 实战代码 (07_1 - 07_4)

**场景 1: 基础 GraphRAG 实现**
- Microsoft GraphRAG 快速搭建
- 文档索引与查询
- 结果分析

**场景 2: 知识图谱构建**
- 从零构建知识图谱
- 实体提取 (OpenAI)
- Neo4j 存储与可视化

**场景 3: Local & Global 搜索**
- 实现双模式检索
- DRIFT Search 实现
- 性能对比

**场景 4: RAG 混合检索**
- 生产级混合系统
- 查询路由器
- 成本监控

---

## 技术栈 (2025-2026)

### 官方框架
- **Microsoft GraphRAG** v3.0.2 (2026年2月)
- **Neo4j GraphRAG Python** (生产级)
- **FalkorDB** (高性能图数据库)

### 核心依赖
```python
# 知识图谱构建
openai                  # 实体关系提取
networkx                # 图操作
python-louvain          # 社区检测

# 图存储
neo4j                   # 图数据库
py2neo                  # Neo4j Python 客户端

# RAG 框架
langchain               # RAG 编排
langchain-openai        # OpenAI 集成
chromadb                # 向量存储 (混合检索)
```

---

## 学习路径

```
基础理解 (30分钟)
├─ 30字核心 + 第一性原理
├─ 双重类比 (前端 + 日常生活)
└─ 反直觉点 (避坑指南)
    ↓
核心概念 (2小时)
├─ 知识图谱构建
├─ 实体关系提取
├─ 社区检测算法
├─ Local vs Global 搜索
└─ 混合检索策略
    ↓
实战代码 (3小时)
├─ 场景1: 基础 GraphRAG 实现
├─ 场景2: 知识图谱构建
├─ 场景3: Local & Global 搜索
└─ 场景4: RAG 混合检索
    ↓
进阶掌握 (1小时)
├─ 面试必问 (2个高频问题)
├─ 化骨绵掌 (10个知识卡片)
└─ 生产实践 (成本优化)
```

**总学习时间**: 6-7 小时 (速成版 3-4 小时)

---

## 关键数据 (2025-2026)

### 准确率提升
- **FalkorDB**: 3.4x 提升
- **综合基准**: 86.31% 准确率
- **AWS 报告**: 50.83% → 80%
- **Microsoft**: 91% (复杂查询)

### 成本优化
- **LazyGraphRAG**: 索引成本降至 0.1%
- **查询成本**: 降低 700x+
- **FalkorDB**: 10-90% 成本节省

### 适用场景
- ✅ 多跳复杂查询 (2-3 跳)
- ✅ 关系推理 (实体间联系)
- ✅ 企业知识库 (结构化知识)
- ✅ 可解释性要求高的场景
- ❌ 简单语义查询 (用 Vector RAG 更快更便宜)

---

## 与 Vector RAG 的对比

| 维度 | Vector RAG | GraphRAG | 混合架构 |
|------|-----------|----------|---------|
| **知识表示** | 向量 (丢失结构) | 图 (保留结构) | 向量 + 图 |
| **检索机制** | 语义相似度 (单跳) | 图遍历 (多跳) | 智能路由 |
| **适用场景** | 简单语义查询 | 复杂关系查询 | 全场景覆盖 |
| **准确率** | 基线 | 3.4x 提升 | 最优 |
| **成本** | 低 | 高 (优化后可降至 0.1%) | 中等 |
| **实现复杂度** | 简单 | 复杂 | 中等 |
| **生产成熟度** | 成熟 | 2025-2026 成熟 | 主流方案 |

---

## 实际应用场景

### 场景 1: 企业知识库
```python
# 问题: "公司的采购流程涉及哪些部门?"
# GraphRAG 优势:
# - 构建部门关系图
# - 多跳推理: 采购部 → 财务部 → 审批部
# - 全局理解: 整个流程的完整视图
```

### 场景 2: 学术文献分析
```python
# 问题: "这篇论文引用了哪些相关工作?"
# GraphRAG 优势:
# - 构建引用关系图
# - 社区检测: 发现研究主题
# - 可解释性: 展示引用路径
```

### 场景 3: 金融风控
```python
# 问题: "这个客户与哪些高风险客户有关联?"
# GraphRAG 优势:
# - 构建客户关系网络
# - 多跳推理: 发现间接关联
# - 风险传播分析
```

---

## 常见误区

1. **"GraphRAG 会取代 Vector RAG"** ❌
   - 正确: 两者互补,混合使用
   - 简单查询用 Vector 更快更便宜

2. **"GraphRAG 适合所有场景"** ❌
   - 正确: 仅适合关系密集、多跳查询
   - 简单语义查询 Vector 足够

3. **"GraphRAG 成本太高无法生产"** ❌
   - 正确: LazyGraphRAG 降至 0.1% 成本
   - 2025-2026 优化技术成熟

4. **"知识图谱越大越好"** ❌
   - 正确: 需要平衡粒度和性能
   - 过细导致噪音,过粗丢失细节

---

## 学习检查清单

完成本知识点学习后,检查是否掌握:

### 理论理解
- [ ] 能用一句话解释 GraphRAG 的本质
- [ ] 理解 GraphRAG 与 Vector RAG 的区别
- [ ] 掌握知识图谱构建的完整流程
- [ ] 理解社区检测的作用
- [ ] 掌握 Local & Global 搜索的区别

### 实战能力
- [ ] 能使用 Microsoft GraphRAG 快速搭建系统
- [ ] 能从文本中提取实体和关系
- [ ] 能使用 Neo4j 存储和查询图数据
- [ ] 能实现 Local & Global 搜索
- [ ] 能构建 Vector + Graph 混合系统

### 生产实践
- [ ] 理解 GraphRAG 的成本优化策略
- [ ] 掌握查询路由器的设计
- [ ] 能评估 GraphRAG 的适用场景
- [ ] 理解 LazyGraphRAG 的优化原理

---

## 参考资源

### 官方文档
- [Microsoft GraphRAG 官方文档](https://microsoft.github.io/graphrag)
- [Neo4j GraphRAG Python](https://neo4j.com/docs/graphrag-python/)
- [FalkorDB 文档](https://docs.falkordb.com/)

### 学术论文
- "RAG vs. GraphRAG: A Systematic Evaluation" (arXiv 2502.11371, 2025)
- "When to use Graphs in RAG" (arXiv 2506.05690v2, 2025)
- "LazyGraphRAG: Setting a New Standard for Quality and Cost" (Microsoft Research, 2025)

### 技术博客
- "Graph RAG in 2026: A Practitioner's Guide" (Medium, 2026)
- "GraphRAG vs Vector RAG: Accuracy Benchmark" (FalkorDB, 2025)
- "Why Vector RAG Fails at Enterprise Scale" (Medium, 2025)

### 基准测试
- GraphRAG-Bench (2025)
- BenchmarkQED (Microsoft, 2025)
- FalkorDB Accuracy Benchmark (2025)

---

## 下一步

1. **立即开始**: 阅读 `01_30字核心.md` 快速理解本质
2. **深入理解**: 学习 `02_第一性原理.md` 建立底层认知
3. **核心概念**: 逐个攻克 5 个核心概念
4. **动手实践**: 完成 4 个实战代码场景
5. **面试准备**: 掌握 `08_面试必问.md` 的 2 个高频问题
6. **知识内化**: 复习 `09_化骨绵掌.md` 的 10 个知识卡片

---

**版本**: v1.0 (基于 2025-2026 生产级实践)
**最后更新**: 2026-02-17
**维护者**: Claude Code
