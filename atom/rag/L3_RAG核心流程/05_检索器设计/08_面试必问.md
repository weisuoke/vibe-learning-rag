# 面试必问

检索器设计相关的高频面试问题，以及如何给出出彩的回答。

---

## 问题1："如何设计一个高效的 RAG 检索器？"

### 普通回答（❌ 不出彩）

> "用向量数据库存储文档的 Embedding，然后用余弦相似度检索最相关的文档。"

### 出彩回答（✅ 推荐）

> **设计高效的 RAG 检索器需要从三个层面考虑：**
>
> **1. 检索策略层面**
>
> 我会采用**混合检索**策略，结合向量检索和关键词检索（BM25）：
> - 向量检索捕捉语义相似性，解决同义词、跨语言等问题
> - BM25 检索保证精确匹配，对专有名词、代码、错误码等场景很重要
> - 使用 RRF（倒数排名融合）合并两者结果
>
> **2. 参数调优层面**
>
> - **Top-K**：根据查询复杂度动态调整，简单问题 K=3-5，复杂问题 K=8-10
> - **相似度阈值**：设置 0.6-0.7 的阈值过滤低质量结果，避免"幻觉"
> - **MMR**：当结果重复度高时，使用 MMR 增加多样性
>
> **3. 工程优化层面**
>
> - 元数据过滤：支持按时间、来源、权限等条件预过滤
> - 查询改写：对用户查询进行扩展或改写，提高召回率
> - ReRank：用 Cross-Encoder 对初筛结果重排序，提高精度
>
> **在实际项目中**，我会先用混合检索建立 baseline，然后根据评估指标（召回率、MRR）逐步优化。

### 为什么这个回答出彩？

1. ✅ **结构清晰**：三个层面，层层递进
2. ✅ **有深度**：不只是"用向量检索"，而是考虑了多种策略
3. ✅ **有实践经验**：提到了具体参数和优化方法
4. ✅ **有方法论**：先 baseline 后优化的工程思维

---

## 问题2："向量检索和关键词检索有什么区别？什么时候用哪个？"

### 普通回答（❌ 不出彩）

> "向量检索用 Embedding，关键词检索用 BM25。向量检索更先进。"

### 出彩回答（✅ 推荐）

> **两者的核心区别在于"相关性"的定义方式：**
>
> | 维度 | 向量检索 | 关键词检索（BM25） |
> |------|----------|-------------------|
> | 相关性定义 | 语义相似（意思相近） | 词汇匹配（词相同） |
> | 核心算法 | 余弦相似度 | TF-IDF 变体 |
> | 优势 | 同义词、跨语言、容错 | 精确匹配、可解释性 |
> | 劣势 | 对专有名词不敏感 | 不理解语义 |
>
> **选择策略：**
>
> - **纯向量检索**：自然语言问答、语义搜索、推荐系统
> - **纯关键词检索**：代码搜索、错误码查询、精确术语匹配
> - **混合检索（推荐）**：生产环境的大多数场景
>
> **一个真实案例**：
>
> 我们的技术文档系统最初只用向量检索，用户搜索 `ERR_CONNECTION_REFUSED` 时，返回的是"网络连接问题"的通用文档，而不是这个具体错误的解决方案。加入 BM25 后，精确匹配的文档排到了第一位，用户满意度提升了 30%。

### 为什么这个回答出彩？

1. ✅ **对比清晰**：用表格展示核心区别
2. ✅ **有选择策略**：不是"哪个更好"，而是"什么时候用哪个"
3. ✅ **有真实案例**：用具体例子说明问题和解决方案
4. ✅ **有数据支撑**：提到了"满意度提升 30%"

---

## 问题3："Top-K 参数怎么选？设大了会怎样？"

### 普通回答（❌ 不出彩）

> "K 一般设 5-10，太大会返回太多结果。"

### 出彩回答（✅ 推荐）

> **Top-K 的选择需要平衡三个因素：**
>
> **1. 召回率 vs 精度**
> - K 太小：可能漏掉相关内容（召回率低）
> - K 太大：引入噪声，干扰 LLM（精度低）
>
> **2. Token 成本**
> - 每增加一个文档块，约增加 300-500 Token
> - K=5 vs K=50，成本相差 10 倍
>
> **3. "Lost in the Middle" 问题**
> - 研究表明，LLM 对上下文中间部分的关注度较低
> - K 太大时，重要信息可能被"淹没"在中间
>
> **我的选择策略：**
>
> ```
> 事实性问题（"XX 是什么"）  → K = 3-5
> 操作性问题（"如何做 XX"）  → K = 5-8
> 综合性问题（"总结/对比"）  → K = 10-15
> ```
>
> **实践建议**：从 K=5 开始，通过 A/B 测试找到最优值。我们的经验是，大多数场景 K=5-8 是最佳平衡点。

### 为什么这个回答出彩？

1. ✅ **多维度分析**：不只是"大小"，而是分析了三个影响因素
2. ✅ **有理论支撑**：提到了 "Lost in the Middle" 研究
3. ✅ **有具体策略**：给出了不同场景的推荐值
4. ✅ **有实践方法**：A/B 测试、从 baseline 开始

---

## 面试技巧总结

| 问题类型 | 回答策略 |
|----------|----------|
| "是什么" | 定义 + 核心特点 + 与相关概念的区别 |
| "怎么选" | 多维度分析 + 选择策略 + 具体场景 |
| "怎么做" | 分层设计 + 关键参数 + 优化方法 |
| "有什么问题" | 问题描述 + 原因分析 + 解决方案 |

**通用技巧：**
1. 用**结构化**的方式回答（分点、分层）
2. 给出**具体数字**（K=5、阈值 0.7、提升 30%）
3. 举**真实案例**说明问题和解决方案
4. 展示**工程思维**（先 baseline 后优化、A/B 测试）

---

**下一步：** [09_化骨绵掌](./09_化骨绵掌.md) - 10个知识卡片，2分钟掌握一个概念
