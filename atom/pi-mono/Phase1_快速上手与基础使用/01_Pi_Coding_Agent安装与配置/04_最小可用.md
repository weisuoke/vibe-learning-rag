# 最小可用知识

> 掌握 20% 的核心知识，解决 80% 的安装配置问题

---

## 核心理念

**最小可用知识**：只学习最关键的内容，快速上手使用 Pi Coding Agent。

**目标：** 10 分钟内完成安装并开始使用。

---

## 必须掌握的 5 个核心知识点

### 4.1 一行命令安装 Pi

**核心操作：**

```bash
# 全局安装 Pi Coding Agent
npm install -g @mariozechner/pi-coding-agent

# 验证安装
pi --version
# 输出：0.52.12（或更新版本）
```

**必须知道：**
- ✅ 需要 Node.js 18+ 环境
- ✅ 全局安装后，任何目录都能运行 `pi`
- ✅ 更新命令：`npm update -g @mariozechner/pi-coding-agent`

**故障排查：**
```bash
# 检查 Node.js 版本
node --version
# 需要 v18.0.0 或更高

# 检查 npm 版本
npm --version

# 如果安装失败，尝试清理缓存
npm cache clean --force
npm install -g @mariozechner/pi-coding-agent
```

---

### 4.2 配置一个 Provider（二选一）

#### 方案 A：使用 API 密钥（推荐用于生产）

**Anthropic Claude（推荐）：**

```bash
# 1. 获取 API 密钥
# 访问 https://console.anthropic.com/settings/keys

# 2. 设置环境变量
export ANTHROPIC_API_KEY=sk-ant-api03-...

# 3. 启动 Pi
pi

# 4. 验证（Pi 会自动检测并使用 Anthropic）
```

**OpenAI GPT：**

```bash
# 1. 获取 API 密钥
# 访问 https://platform.openai.com/api-keys

# 2. 设置环境变量
export OPENAI_API_KEY=sk-proj-...

# 3. 启动 Pi
pi --provider openai --model gpt-4o
```

**持久化配置（推荐）：**

```bash
# 将环境变量添加到 shell 配置文件
echo 'export ANTHROPIC_API_KEY=sk-ant-api03-...' >> ~/.zshrc
source ~/.zshrc

# 或使用 auth.json（更安全）
mkdir -p ~/.pi/agent
cat > ~/.pi/agent/auth.json << 'EOF'
{
  "anthropic": {
    "type": "api_key",
    "key": "sk-ant-api03-..."
  }
}
EOF
chmod 600 ~/.pi/agent/auth.json
```

#### 方案 B：使用订阅登录（推荐用于个人）

```bash
# 1. 启动 Pi
pi

# 2. 执行登录命令
/login

# 3. 选择 Provider
# - Claude Pro/Max（需要 Anthropic 订阅）
# - ChatGPT Plus/Pro（需要 OpenAI 订阅）
# - GitHub Copilot（需要 GitHub Copilot 订阅）
# - Google Gemini CLI（免费，需要 Google 账号）

# 4. 按照提示完成 OAuth 认证
# 凭证会自动保存到 ~/.pi/agent/auth.json
```

**对比：**

| 方案 | 优点 | 缺点 | 适用场景 |
|------|------|------|---------|
| API 密钥 | 精确控制成本、适合 CI/CD | 需要管理密钥 | 生产环境、团队协作 |
| OAuth 订阅 | 无需管理密钥、自动刷新 | 依赖订阅 | 个人使用、快速上手 |

---

### 4.3 基础交互：四大工具

**Pi 默认提供 4 个工具，LLM 会自动调用：**

```bash
# 启动 Pi
pi

# 示例对话
You: 读取 package.json 文件
# Pi 会调用 read 工具

You: 创建一个 hello.js 文件，输出 Hello World
# Pi 会调用 write 工具

You: 把 hello.js 中的 World 改成 Pi
# Pi 会调用 edit 工具

You: 运行 node hello.js
# Pi 会调用 bash 工具
```

**四大工具：**

| 工具 | 作用 | 示例 |
|------|------|------|
| **read** | 读取文件内容 | 读取 src/index.ts |
| **write** | 创建或覆盖文件 | 创建 README.md |
| **edit** | 精确编辑文件（替换文本） | 修改函数名 |
| **bash** | 执行 shell 命令 | 运行 npm test |

**必须知道：**
- ✅ 你不需要手动调用工具，LLM 会自动选择
- ✅ 工具调用结果会显示在终端（可用 Ctrl+O 折叠/展开）
- ✅ 如果工具调用失败，LLM 会看到错误信息并重试

---

### 4.4 切换模型

**快捷键切换（最快）：**

```bash
# 启动 Pi 后
Ctrl+L  # 打开模型选择器
# 使用方向键选择，Enter 确认
```

**命令切换：**

```bash
# 在 Pi 交互界面中
/model
# 选择新模型

# 或直接指定
/model claude-opus-4
/model gpt-4o
/model grok-2-latest
```

**启动时指定：**

```bash
# 命令行参数
pi --provider anthropic --model claude-opus-4
pi --provider openai --model gpt-4o
pi --provider xai --model grok-2-latest
```

**常用模型推荐：**

| 模型 | 特点 | 适用场景 |
|------|------|---------|
| **claude-sonnet-4** | 平衡性能和成本 | 日常开发 |
| **claude-opus-4** | 最强推理能力 | 复杂任务 |
| **gpt-4o** | 快速响应 | 快速原型 |
| **grok-2-latest** | 实时信息 | 需要最新知识 |
| **gemini-2.0-flash** | 免费、快速 | 学习测试 |

---

### 4.5 项目配置（可选但推荐）

**为项目创建配置文件：**

```bash
# 1. 在项目根目录创建 .pi 目录
mkdir .pi

# 2. 创建项目配置
cat > .pi/settings.json << 'EOF'
{
  "defaultProvider": "anthropic",
  "defaultModel": "claude-sonnet-4",
  "compaction": {
    "keepRecentTokens": 30000
  }
}
EOF

# 3. 创建项目上下文文件（可选）
cat > .pi/AGENTS.md << 'EOF'
# 项目说明

这是一个 TypeScript 项目，使用 npm 管理依赖。

## 代码规范

- 使用 ESLint 和 Prettier
- 函数命名使用 camelCase
- 类型定义使用 TypeScript interface

## 常用命令

- `npm run build` - 构建项目
- `npm test` - 运行测试
- `npm run lint` - 代码检查
EOF

# 4. 提交到 Git（团队共享配置）
git add .pi/
git commit -m "Add Pi configuration"
```

**配置优先级：**
```
CLI 参数 > .pi/settings.json > ~/.pi/agent/settings.json > 默认值
```

---

## 这些知识足以

掌握以上 5 个核心知识点后，你已经可以：

### 基础能力
- ✅ 安装并启动 Pi Coding Agent
- ✅ 使用 API 密钥或 OAuth 认证
- ✅ 与 Pi 进行基础对话
- ✅ 让 Pi 读取、创建、编辑文件
- ✅ 让 Pi 执行 shell 命令
- ✅ 切换不同的 LLM 模型

### 实际应用
- ✅ 让 Pi 帮你修复 bug
- ✅ 让 Pi 帮你生成代码
- ✅ 让 Pi 帮你解释代码
- ✅ 让 Pi 帮你重构代码
- ✅ 让 Pi 帮你写测试

### 为后续学习打基础
- ✅ 理解 Pi 的核心工作原理
- ✅ 理解 Provider 和 Model 的概念
- ✅ 理解配置文件的作用
- ✅ 为学习高级功能做好准备

---

## 快速参考卡

**安装：**
```bash
npm install -g @mariozechner/pi-coding-agent
```

**认证（二选一）：**
```bash
# 方案 A：API 密钥
export ANTHROPIC_API_KEY=sk-ant-...
pi

# 方案 B：OAuth 订阅
pi
/login
```

**基础使用：**
```bash
pi                    # 启动 Pi
Ctrl+L                # 切换模型
/model                # 命令切换模型
/new                  # 新建 Session
/tree                 # 查看对话历史
/quit                 # 退出
```

**项目配置：**
```bash
mkdir .pi
echo '{"defaultModel": "claude-sonnet-4"}' > .pi/settings.json
```

---

## 下一步学习

完成最小可用知识后，建议深入学习：

- **[核心概念](./03_核心概念_01_npm全局安装.md)** - 深入理解每个概念
- **[实战代码](./07_实战代码_01_基础安装与快速开始.md)** - 完整的实战示例
- **[双重类比](./05_双重类比.md)** - 通过类比加深理解
- **[反直觉点](./06_反直觉点.md)** - 避免常见误区

---

**来源：**
- [Pi Coding Agent README](https://github.com/badlogic/pi-mono/blob/main/packages/coding-agent/README.md) - 2026-02-17
- [Providers 文档](https://github.com/badlogic/pi-mono/blob/main/packages/coding-agent/docs/providers.md) - 2026-02-17
- [NPM 包页面](https://www.npmjs.com/package/@mariozechner/pi-coding-agent) - v0.52.12
