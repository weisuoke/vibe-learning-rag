# å®æˆ˜ä»£ç  - åœºæ™¯1ï¼šåŸºç¡€æ ‡é‡è¿‡æ»¤

> å®Œæ•´å¯è¿è¡Œçš„åŸºç¡€æ ‡é‡è¿‡æ»¤ç¤ºä¾‹ï¼ŒæŒæ¡æ ¸å¿ƒç”¨æ³•

---

## åœºæ™¯æè¿°

**ç›®æ ‡**ï¼šåˆ›å»ºä¸€ä¸ªæ–‡æ¡£Collectionï¼Œæ’å…¥æµ‹è¯•æ•°æ®ï¼Œæ¼”ç¤ºåŸºç¡€çš„æ ‡é‡è¿‡æ»¤æ“ä½œã€‚

**æ¶‰åŠçŸ¥è¯†ç‚¹**ï¼š
- Collectionåˆ›å»ºå’ŒSchemaå®šä¹‰
- æ•°æ®æ’å…¥
- åŸºç¡€æ¯”è¾ƒè¿ç®—ç¬¦ï¼ˆ==, !=, >, <, >=, <=ï¼‰
- INè¿ç®—ç¬¦
- LIKEè¿ç®—ç¬¦

---

## å®Œæ•´ä»£ç 

```python
"""
åœºæ™¯1ï¼šåŸºç¡€æ ‡é‡è¿‡æ»¤
æ¼”ç¤ºï¼šMilvusæ ‡é‡è¿‡æ»¤çš„åŸºç¡€ç”¨æ³•
"""

from pymilvus import (
    connections,
    Collection,
    FieldSchema,
    CollectionSchema,
    DataType,
    utility
)
import numpy as np
from typing import List

# ===== 1. è¿æ¥åˆ°Milvus =====
print("=== 1. è¿æ¥åˆ°Milvus ===")
connections.connect(
    alias="default",
    host="localhost",
    port="19530"
)
print("âœ… è¿æ¥æˆåŠŸ")

# ===== 2. å®šä¹‰Collection Schema =====
print("\n=== 2. å®šä¹‰Collection Schema ===")

# å®šä¹‰å­—æ®µ
fields = [
    FieldSchema(name="id", dtype=DataType.INT64, is_primary=True, auto_id=True),
    FieldSchema(name="embedding", dtype=DataType.FLOAT_VECTOR, dim=128),
    FieldSchema(name="title", dtype=DataType.VARCHAR, max_length=500),
    FieldSchema(name="category", dtype=DataType.VARCHAR, max_length=100),
    FieldSchema(name="year", dtype=DataType.INT16),
    FieldSchema(name="price", dtype=DataType.FLOAT),
    FieldSchema(name="rating", dtype=DataType.DOUBLE),
    FieldSchema(name="is_published", dtype=DataType.BOOL),
]

# åˆ›å»ºSchema
schema = CollectionSchema(
    fields=fields,
    description="Document collection for scalar filtering demo"
)

# åˆ›å»ºCollectionï¼ˆå¦‚æœå·²å­˜åœ¨åˆ™åˆ é™¤ï¼‰
collection_name = "scalar_filter_demo"
if utility.has_collection(collection_name):
    utility.drop_collection(collection_name)
    print(f"ğŸ—‘ï¸  åˆ é™¤å·²å­˜åœ¨çš„Collection: {collection_name}")

collection = Collection(name=collection_name, schema=schema)
print(f"âœ… åˆ›å»ºCollection: {collection_name}")

# ===== 3. å‡†å¤‡æµ‹è¯•æ•°æ® =====
print("\n=== 3. å‡†å¤‡æµ‹è¯•æ•°æ® ===")

# ç”Ÿæˆæµ‹è¯•æ•°æ®
test_data = [
    {
        "embedding": np.random.rand(128).tolist(),
        "title": "Pythonæœºå™¨å­¦ä¹ å…¥é—¨",
        "category": "tech",
        "year": 2024,
        "price": 99.99,
        "rating": 4.5,
        "is_published": True
    },
    {
        "embedding": np.random.rand(128).tolist(),
        "title": "Javaç¼–ç¨‹æ€æƒ³",
        "category": "tech",
        "year": 2023,
        "price": 129.99,
        "rating": 4.8,
        "is_published": True
    },
    {
        "embedding": np.random.rand(128).tolist(),
        "title": "æ·±åº¦å­¦ä¹ å®æˆ˜",
        "category": "ai",
        "year": 2024,
        "price": 159.99,
        "rating": 4.7,
        "is_published": True
    },
    {
        "embedding": np.random.rand(128).tolist(),
        "title": "æ•°æ®ç»“æ„ä¸ç®—æ³•",
        "category": "tech",
        "year": 2022,
        "price": 89.99,
        "rating": 4.6,
        "is_published": False
    },
    {
        "embedding": np.random.rand(128).tolist(),
        "title": "äººå·¥æ™ºèƒ½å¯¼è®º",
        "category": "ai",
        "year": 2024,
        "price": 119.99,
        "rating": 4.4,
        "is_published": True
    },
    {
        "embedding": np.random.rand(128).tolist(),
        "title": "Pythonæ•°æ®åˆ†æ",
        "category": "data",
        "year": 2023,
        "price": 109.99,
        "rating": 4.3,
        "is_published": True
    },
    {
        "embedding": np.random.rand(128).tolist(),
        "title": "æœºå™¨å­¦ä¹ å®æˆ˜",
        "category": "ml",
        "year": 2024,
        "price": 139.99,
        "rating": 4.9,
        "is_published": True
    },
    {
        "embedding": np.random.rand(128).tolist(),
        "title": "ç®—æ³•å¯¼è®º",
        "category": "tech",
        "year": 2021,
        "price": 149.99,
        "rating": 4.8,
        "is_published": True
    },
]

# è½¬æ¢ä¸ºåˆ—å¼æ ¼å¼
data = {
    "embedding": [item["embedding"] for item in test_data],
    "title": [item["title"] for item in test_data],
    "category": [item["category"] for item in test_data],
    "year": [item["year"] for item in test_data],
    "price": [item["price"] for item in test_data],
    "rating": [item["rating"] for item in test_data],
    "is_published": [item["is_published"] for item in test_data],
}

# æ’å…¥æ•°æ®
insert_result = collection.insert(data)
print(f"âœ… æ’å…¥ {len(test_data)} æ¡æ•°æ®")
print(f"   æ’å…¥çš„IDèŒƒå›´: {insert_result.primary_keys[0]} - {insert_result.primary_keys[-1]}")

# åˆ›å»ºç´¢å¼•ï¼ˆå‘é‡ç´¢å¼•ï¼‰
print("\n=== 4. åˆ›å»ºå‘é‡ç´¢å¼• ===")
index_params = {
    "index_type": "IVF_FLAT",
    "metric_type": "L2",
    "params": {"nlist": 128}
}
collection.create_index(field_name="embedding", index_params=index_params)
print("âœ… åˆ›å»ºå‘é‡ç´¢å¼•")

# åŠ è½½Collectionåˆ°å†…å­˜
collection.load()
print("âœ… åŠ è½½Collectionåˆ°å†…å­˜")

# ===== 5. åŸºç¡€æ ‡é‡è¿‡æ»¤ç¤ºä¾‹ =====
print("\n=== 5. åŸºç¡€æ ‡é‡è¿‡æ»¤ç¤ºä¾‹ ===")

# å‡†å¤‡æŸ¥è¯¢å‘é‡
query_vector = np.random.rand(128).tolist()

# ç¤ºä¾‹1ï¼šç­‰äºè¿ç®—ç¬¦ ==
print("\nã€ç¤ºä¾‹1ã€‘ç­‰äºè¿ç®—ç¬¦ ==")
print("æŸ¥è¯¢æ¡ä»¶: year == 2024")
results = collection.search(
    data=[query_vector],
    anns_field="embedding",
    param={"metric_type": "L2", "params": {"nprobe": 10}},
    limit=10,
    expr="year == 2024",
    output_fields=["title", "category", "year", "price"]
)
print(f"æ‰¾åˆ° {len(results[0])} æ¡ç»“æœ:")
for hit in results[0]:
    print(f"  - {hit.entity.get('title')} (å¹´ä»½: {hit.entity.get('year')})")

# ç¤ºä¾‹2ï¼šä¸ç­‰äºè¿ç®—ç¬¦ !=
print("\nã€ç¤ºä¾‹2ã€‘ä¸ç­‰äºè¿ç®—ç¬¦ !=")
print("æŸ¥è¯¢æ¡ä»¶: category != 'tech'")
results = collection.search(
    data=[query_vector],
    anns_field="embedding",
    param={"metric_type": "L2", "params": {"nprobe": 10}},
    limit=10,
    expr="category != 'tech'",
    output_fields=["title", "category", "year"]
)
print(f"æ‰¾åˆ° {len(results[0])} æ¡ç»“æœ:")
for hit in results[0]:
    print(f"  - {hit.entity.get('title')} (åˆ†ç±»: {hit.entity.get('category')})")

# ç¤ºä¾‹3ï¼šå¤§äºè¿ç®—ç¬¦ >
print("\nã€ç¤ºä¾‹3ã€‘å¤§äºè¿ç®—ç¬¦ >")
print("æŸ¥è¯¢æ¡ä»¶: price > 120")
results = collection.search(
    data=[query_vector],
    anns_field="embedding",
    param={"metric_type": "L2", "params": {"nprobe": 10}},
    limit=10,
    expr="price > 120",
    output_fields=["title", "price"]
)
print(f"æ‰¾åˆ° {len(results[0])} æ¡ç»“æœ:")
for hit in results[0]:
    print(f"  - {hit.entity.get('title')} (ä»·æ ¼: Â¥{hit.entity.get('price')})")

# ç¤ºä¾‹4ï¼šå°äºç­‰äºè¿ç®—ç¬¦ <=
print("\nã€ç¤ºä¾‹4ã€‘å°äºç­‰äºè¿ç®—ç¬¦ <=")
print("æŸ¥è¯¢æ¡ä»¶: price <= 100")
results = collection.search(
    data=[query_vector],
    anns_field="embedding",
    param={"metric_type": "L2", "params": {"nprobe": 10}},
    limit=10,
    expr="price <= 100",
    output_fields=["title", "price"]
)
print(f"æ‰¾åˆ° {len(results[0])} æ¡ç»“æœ:")
for hit in results[0]:
    print(f"  - {hit.entity.get('title')} (ä»·æ ¼: Â¥{hit.entity.get('price')})")

# ç¤ºä¾‹5ï¼šèŒƒå›´æŸ¥è¯¢
print("\nã€ç¤ºä¾‹5ã€‘èŒƒå›´æŸ¥è¯¢")
print("æŸ¥è¯¢æ¡ä»¶: price >= 100 and price <= 150")
results = collection.search(
    data=[query_vector],
    anns_field="embedding",
    param={"metric_type": "L2", "params": {"nprobe": 10}},
    limit=10,
    expr="price >= 100 and price <= 150",
    output_fields=["title", "price"]
)
print(f"æ‰¾åˆ° {len(results[0])} æ¡ç»“æœ:")
for hit in results[0]:
    print(f"  - {hit.entity.get('title')} (ä»·æ ¼: Â¥{hit.entity.get('price')})")

# ç¤ºä¾‹6ï¼šINè¿ç®—ç¬¦
print("\nã€ç¤ºä¾‹6ã€‘INè¿ç®—ç¬¦")
print("æŸ¥è¯¢æ¡ä»¶: category in ['tech', 'ai']")
results = collection.search(
    data=[query_vector],
    anns_field="embedding",
    param={"metric_type": "L2", "params": {"nprobe": 10}},
    limit=10,
    expr="category in ['tech', 'ai']",
    output_fields=["title", "category"]
)
print(f"æ‰¾åˆ° {len(results[0])} æ¡ç»“æœ:")
for hit in results[0]:
    print(f"  - {hit.entity.get('title')} (åˆ†ç±»: {hit.entity.get('category')})")

# ç¤ºä¾‹7ï¼šLIKEè¿ç®—ç¬¦ï¼ˆå‰ç¼€åŒ¹é…ï¼‰
print("\nã€ç¤ºä¾‹7ã€‘LIKEè¿ç®—ç¬¦ï¼ˆå‰ç¼€åŒ¹é…ï¼‰")
print("æŸ¥è¯¢æ¡ä»¶: title like 'Python%'")
results = collection.search(
    data=[query_vector],
    anns_field="embedding",
    param={"metric_type": "L2", "params": {"nprobe": 10}},
    limit=10,
    expr="title like 'Python%'",
    output_fields=["title"]
)
print(f"æ‰¾åˆ° {len(results[0])} æ¡ç»“æœ:")
for hit in results[0]:
    print(f"  - {hit.entity.get('title')}")

# ç¤ºä¾‹8ï¼šLIKEè¿ç®—ç¬¦ï¼ˆåŒ…å«åŒ¹é…ï¼‰
print("\nã€ç¤ºä¾‹8ã€‘LIKEè¿ç®—ç¬¦ï¼ˆåŒ…å«åŒ¹é…ï¼‰")
print("æŸ¥è¯¢æ¡ä»¶: title like '%æœºå™¨å­¦ä¹ %'")
results = collection.search(
    data=[query_vector],
    anns_field="embedding",
    param={"metric_type": "L2", "params": {"nprobe": 10}},
    limit=10,
    expr="title like '%æœºå™¨å­¦ä¹ %'",
    output_fields=["title"]
)
print(f"æ‰¾åˆ° {len(results[0])} æ¡ç»“æœ:")
for hit in results[0]:
    print(f"  - {hit.entity.get('title')}")

# ç¤ºä¾‹9ï¼šå¸ƒå°”å­—æ®µè¿‡æ»¤
print("\nã€ç¤ºä¾‹9ã€‘å¸ƒå°”å­—æ®µè¿‡æ»¤")
print("æŸ¥è¯¢æ¡ä»¶: is_published == true")
results = collection.search(
    data=[query_vector],
    anns_field="embedding",
    param={"metric_type": "L2", "params": {"nprobe": 10}},
    limit=10,
    expr="is_published == true",
    output_fields=["title", "is_published"]
)
print(f"æ‰¾åˆ° {len(results[0])} æ¡ç»“æœ:")
for hit in results[0]:
    print(f"  - {hit.entity.get('title')} (å·²å‘å¸ƒ: {hit.entity.get('is_published')})")

# ç¤ºä¾‹10ï¼šè¯„åˆ†è¿‡æ»¤
print("\nã€ç¤ºä¾‹10ã€‘è¯„åˆ†è¿‡æ»¤")
print("æŸ¥è¯¢æ¡ä»¶: rating >= 4.5")
results = collection.search(
    data=[query_vector],
    anns_field="embedding",
    param={"metric_type": "L2", "params": {"nprobe": 10}},
    limit=10,
    expr="rating >= 4.5",
    output_fields=["title", "rating"]
)
print(f"æ‰¾åˆ° {len(results[0])} æ¡ç»“æœ:")
for hit in results[0]:
    print(f"  - {hit.entity.get('title')} (è¯„åˆ†: {hit.entity.get('rating')})")

# ===== 6. æ¸…ç†èµ„æº =====
print("\n=== 6. æ¸…ç†èµ„æº ===")
collection.release()
print("âœ… é‡Šæ”¾Collection")

# å¯é€‰ï¼šåˆ é™¤Collection
# utility.drop_collection(collection_name)
# print(f"âœ… åˆ é™¤Collection: {collection_name}")

connections.disconnect("default")
print("âœ… æ–­å¼€è¿æ¥")

print("\n=== ç¤ºä¾‹å®Œæˆ ===")
```

---

## è¿è¡Œè¾“å‡ºç¤ºä¾‹

```
=== 1. è¿æ¥åˆ°Milvus ===
âœ… è¿æ¥æˆåŠŸ

=== 2. å®šä¹‰Collection Schema ===
ğŸ—‘ï¸  åˆ é™¤å·²å­˜åœ¨çš„Collection: scalar_filter_demo
âœ… åˆ›å»ºCollection: scalar_filter_demo

=== 3. å‡†å¤‡æµ‹è¯•æ•°æ® ===
âœ… æ’å…¥ 8 æ¡æ•°æ®
   æ’å…¥çš„IDèŒƒå›´: 450194603831836672 - 450194603831836679

=== 4. åˆ›å»ºå‘é‡ç´¢å¼• ===
âœ… åˆ›å»ºå‘é‡ç´¢å¼•
âœ… åŠ è½½Collectionåˆ°å†…å­˜

=== 5. åŸºç¡€æ ‡é‡è¿‡æ»¤ç¤ºä¾‹ ===

ã€ç¤ºä¾‹1ã€‘ç­‰äºè¿ç®—ç¬¦ ==
æŸ¥è¯¢æ¡ä»¶: year == 2024
æ‰¾åˆ° 4 æ¡ç»“æœ:
  - Pythonæœºå™¨å­¦ä¹ å…¥é—¨ (å¹´ä»½: 2024)
  - æ·±åº¦å­¦ä¹ å®æˆ˜ (å¹´ä»½: 2024)
  - äººå·¥æ™ºèƒ½å¯¼è®º (å¹´ä»½: 2024)
  - æœºå™¨å­¦ä¹ å®æˆ˜ (å¹´ä»½: 2024)

ã€ç¤ºä¾‹2ã€‘ä¸ç­‰äºè¿ç®—ç¬¦ !=
æŸ¥è¯¢æ¡ä»¶: category != 'tech'
æ‰¾åˆ° 4 æ¡ç»“æœ:
  - æ·±åº¦å­¦ä¹ å®æˆ˜ (åˆ†ç±»: ai)
  - äººå·¥æ™ºèƒ½å¯¼è®º (åˆ†ç±»: ai)
  - Pythonæ•°æ®åˆ†æ (åˆ†ç±»: data)
  - æœºå™¨å­¦ä¹ å®æˆ˜ (åˆ†ç±»: ml)

ã€ç¤ºä¾‹3ã€‘å¤§äºè¿ç®—ç¬¦ >
æŸ¥è¯¢æ¡ä»¶: price > 120
æ‰¾åˆ° 3 æ¡ç»“æœ:
  - Javaç¼–ç¨‹æ€æƒ³ (ä»·æ ¼: Â¥129.99)
  - æ·±åº¦å­¦ä¹ å®æˆ˜ (ä»·æ ¼: Â¥159.99)
  - æœºå™¨å­¦ä¹ å®æˆ˜ (ä»·æ ¼: Â¥139.99)

ã€ç¤ºä¾‹4ã€‘å°äºç­‰äºè¿ç®—ç¬¦ <=
æŸ¥è¯¢æ¡ä»¶: price <= 100
æ‰¾åˆ° 2 æ¡ç»“æœ:
  - Pythonæœºå™¨å­¦ä¹ å…¥é—¨ (ä»·æ ¼: Â¥99.99)
  - æ•°æ®ç»“æ„ä¸ç®—æ³• (ä»·æ ¼: Â¥89.99)

ã€ç¤ºä¾‹5ã€‘èŒƒå›´æŸ¥è¯¢
æŸ¥è¯¢æ¡ä»¶: price >= 100 and price <= 150
æ‰¾åˆ° 4 æ¡ç»“æœ:
  - Javaç¼–ç¨‹æ€æƒ³ (ä»·æ ¼: Â¥129.99)
  - äººå·¥æ™ºèƒ½å¯¼è®º (ä»·æ ¼: Â¥119.99)
  - Pythonæ•°æ®åˆ†æ (ä»·æ ¼: Â¥109.99)
  - æœºå™¨å­¦ä¹ å®æˆ˜ (ä»·æ ¼: Â¥139.99)

ã€ç¤ºä¾‹6ã€‘INè¿ç®—ç¬¦
æŸ¥è¯¢æ¡ä»¶: category in ['tech', 'ai']
æ‰¾åˆ° 6 æ¡ç»“æœ:
  - Pythonæœºå™¨å­¦ä¹ å…¥é—¨ (åˆ†ç±»: tech)
  - Javaç¼–ç¨‹æ€æƒ³ (åˆ†ç±»: tech)
  - æ·±åº¦å­¦ä¹ å®æˆ˜ (åˆ†ç±»: ai)
  - æ•°æ®ç»“æ„ä¸ç®—æ³• (åˆ†ç±»: tech)
  - äººå·¥æ™ºèƒ½å¯¼è®º (åˆ†ç±»: ai)
  - ç®—æ³•å¯¼è®º (åˆ†ç±»: tech)

ã€ç¤ºä¾‹7ã€‘LIKEè¿ç®—ç¬¦ï¼ˆå‰ç¼€åŒ¹é…ï¼‰
æŸ¥è¯¢æ¡ä»¶: title like 'Python%'
æ‰¾åˆ° 2 æ¡ç»“æœ:
  - Pythonæœºå™¨å­¦ä¹ å…¥é—¨
  - Pythonæ•°æ®åˆ†æ

ã€ç¤ºä¾‹8ã€‘LIKEè¿ç®—ç¬¦ï¼ˆåŒ…å«åŒ¹é…ï¼‰
æŸ¥è¯¢æ¡ä»¶: title like '%æœºå™¨å­¦ä¹ %'
æ‰¾åˆ° 2 æ¡ç»“æœ:
  - Pythonæœºå™¨å­¦ä¹ å…¥é—¨
  - æœºå™¨å­¦ä¹ å®æˆ˜

ã€ç¤ºä¾‹9ã€‘å¸ƒå°”å­—æ®µè¿‡æ»¤
æŸ¥è¯¢æ¡ä»¶: is_published == true
æ‰¾åˆ° 7 æ¡ç»“æœ:
  - Pythonæœºå™¨å­¦ä¹ å…¥é—¨ (å·²å‘å¸ƒ: True)
  - Javaç¼–ç¨‹æ€æƒ³ (å·²å‘å¸ƒ: True)
  - æ·±åº¦å­¦ä¹ å®æˆ˜ (å·²å‘å¸ƒ: True)
  - äººå·¥æ™ºèƒ½å¯¼è®º (å·²å‘å¸ƒ: True)
  - Pythonæ•°æ®åˆ†æ (å·²å‘å¸ƒ: True)
  - æœºå™¨å­¦ä¹ å®æˆ˜ (å·²å‘å¸ƒ: True)
  - ç®—æ³•å¯¼è®º (å·²å‘å¸ƒ: True)

ã€ç¤ºä¾‹10ã€‘è¯„åˆ†è¿‡æ»¤
æŸ¥è¯¢æ¡ä»¶: rating >= 4.5
æ‰¾åˆ° 5 æ¡ç»“æœ:
  - Pythonæœºå™¨å­¦ä¹ å…¥é—¨ (è¯„åˆ†: 4.5)
  - Javaç¼–ç¨‹æ€æƒ³ (è¯„åˆ†: 4.8)
  - æ·±åº¦å­¦ä¹ å®æˆ˜ (è¯„åˆ†: 4.7)
  - æ•°æ®ç»“æ„ä¸ç®—æ³• (è¯„åˆ†: 4.6)
  - æœºå™¨å­¦ä¹ å®æˆ˜ (è¯„åˆ†: 4.9)

=== 6. æ¸…ç†èµ„æº ===
âœ… é‡Šæ”¾Collection
âœ… æ–­å¼€è¿æ¥

=== ç¤ºä¾‹å®Œæˆ ===
```

---

## ä»£ç è¯´æ˜

### 1. Collection Schemaè®¾è®¡

```python
fields = [
    FieldSchema(name="id", dtype=DataType.INT64, is_primary=True, auto_id=True),
    FieldSchema(name="embedding", dtype=DataType.FLOAT_VECTOR, dim=128),
    FieldSchema(name="title", dtype=DataType.VARCHAR, max_length=500),
    FieldSchema(name="category", dtype=DataType.VARCHAR, max_length=100),
    FieldSchema(name="year", dtype=DataType.INT16),
    FieldSchema(name="price", dtype=DataType.FLOAT),
    FieldSchema(name="rating", dtype=DataType.DOUBLE),
    FieldSchema(name="is_published", dtype=DataType.BOOL),
]
```

**è®¾è®¡è¦ç‚¹**ï¼š
- `id`: ä¸»é”®ï¼Œè‡ªåŠ¨ç”Ÿæˆ
- `embedding`: å‘é‡å­—æ®µï¼Œç”¨äºç›¸ä¼¼åº¦æ£€ç´¢
- `title`, `category`: å­—ç¬¦ä¸²å­—æ®µï¼Œæ”¯æŒç²¾ç¡®åŒ¹é…å’Œæ¨¡ç³ŠåŒ¹é…
- `year`: æ•´æ•°å­—æ®µï¼Œæ”¯æŒèŒƒå›´æŸ¥è¯¢
- `price`, `rating`: æµ®ç‚¹æ•°å­—æ®µï¼Œæ”¯æŒèŒƒå›´æŸ¥è¯¢
- `is_published`: å¸ƒå°”å­—æ®µï¼Œæ”¯æŒçŠ¶æ€è¿‡æ»¤

### 2. æ•°æ®æ’å…¥

```python
# è½¬æ¢ä¸ºåˆ—å¼æ ¼å¼
data = {
    "embedding": [item["embedding"] for item in test_data],
    "title": [item["title"] for item in test_data],
    # ...
}
collection.insert(data)
```

**æ³¨æ„**ï¼šMilvusä½¿ç”¨åˆ—å¼å­˜å‚¨ï¼Œæ’å…¥æ•°æ®æ—¶éœ€è¦å°†è¡Œå¼æ•°æ®è½¬æ¢ä¸ºåˆ—å¼æ ¼å¼ã€‚

### 3. æŸ¥è¯¢å‚æ•°è¯´æ˜

```python
results = collection.search(
    data=[query_vector],              # æŸ¥è¯¢å‘é‡
    anns_field="embedding",           # å‘é‡å­—æ®µå
    param={"metric_type": "L2", "params": {"nprobe": 10}},  # ç´¢å¼•å‚æ•°
    limit=10,                         # è¿”å›Top 10
    expr="year == 2024",              # æ ‡é‡è¿‡æ»¤è¡¨è¾¾å¼
    output_fields=["title", "year"]   # è¿”å›çš„æ ‡é‡å­—æ®µ
)
```

---

## å…³é”®çŸ¥è¯†ç‚¹

### 1. æ¯”è¾ƒè¿ç®—ç¬¦

| è¿ç®—ç¬¦ | ç”¨é€” | ç¤ºä¾‹ |
|--------|------|------|
| `==` | ç²¾ç¡®åŒ¹é… | `year == 2024` |
| `!=` | æ’é™¤ç‰¹å®šå€¼ | `category != 'tech'` |
| `>` | å¤§äº | `price > 120` |
| `<` | å°äº | `rating < 4.0` |
| `>=` | å¤§äºç­‰äº | `year >= 2024` |
| `<=` | å°äºç­‰äº | `price <= 100` |

### 2. INè¿ç®—ç¬¦

```python
# å¤šå€¼åŒ¹é…
expr = "category in ['tech', 'ai', 'ml']"

# ç­‰ä»·äºï¼ˆä½†æ›´ç®€æ´ï¼‰
expr = "category == 'tech' or category == 'ai' or category == 'ml'"
```

### 3. LIKEè¿ç®—ç¬¦

```python
# å‰ç¼€åŒ¹é…ï¼ˆæœ€å¿«ï¼‰
expr = "title like 'Python%'"

# åç¼€åŒ¹é…
expr = "title like '%æ•™ç¨‹'"

# åŒ…å«åŒ¹é…ï¼ˆæœ€æ…¢ï¼‰
expr = "title like '%æœºå™¨å­¦ä¹ %'"
```

---

## å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆæŸ¥è¯¢ç»“æœæ•°é‡å¯èƒ½å°‘äºlimitï¼Ÿ

**A**: æ ‡é‡è¿‡æ»¤ä¼šå…ˆç­›é€‰ç¬¦åˆæ¡ä»¶çš„æ–‡æ¡£ï¼Œå¦‚æœç¬¦åˆæ¡ä»¶çš„æ–‡æ¡£å°‘äºlimitï¼Œåˆ™è¿”å›æ‰€æœ‰ç¬¦åˆæ¡ä»¶çš„æ–‡æ¡£ã€‚

### Q2: å¦‚ä½•æå‡æ ‡é‡è¿‡æ»¤æ€§èƒ½ï¼Ÿ

**A**: ä¸ºé«˜é¢‘è¿‡æ»¤å­—æ®µåˆ›å»ºæ ‡é‡ç´¢å¼•ï¼ˆè§åœºæ™¯3ï¼‰ã€‚

### Q3: å­—ç¬¦ä¸²æ¯”è¾ƒåŒºåˆ†å¤§å°å†™å—ï¼Ÿ

**A**: æ˜¯çš„ï¼Œå»ºè®®åœ¨æ’å…¥æ•°æ®æ—¶ç»Ÿä¸€è½¬æ¢ä¸ºå°å†™ã€‚

---

## ä¸‹ä¸€æ­¥

- **åœºæ™¯2**ï¼šå­¦ä¹ å¤åˆæ¡ä»¶æŸ¥è¯¢ï¼ˆAND/OR/NOTï¼‰
- **åœºæ™¯3**ï¼šå­¦ä¹ æ ‡é‡ç´¢å¼•ä¼˜åŒ–
- **åœºæ™¯4**ï¼šåº”ç”¨åˆ°RAGæ··åˆæ£€ç´¢
