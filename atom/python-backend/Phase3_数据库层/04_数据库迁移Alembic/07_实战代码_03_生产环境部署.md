# å®æˆ˜ä»£ç  - åœºæ™¯3ï¼šç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ä¸ CI/CD

**æœ¬åœºæ™¯æ¼”ç¤º Alembic åœ¨ç”Ÿäº§ç¯å¢ƒçš„éƒ¨ç½²ç­–ç•¥ï¼ŒåŒ…æ‹¬ CI/CD é›†æˆã€é›¶åœæœºè¿ç§»ã€å›æ»šç­–ç•¥ç­‰ã€‚**

---

## åœºæ™¯æ¦‚è¿°

**ç›®æ ‡ï¼š** å°† AI Agent åç«¯é¡¹ç›®éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒï¼Œä½¿ç”¨ CI/CD è‡ªåŠ¨åŒ–è¿ç§»æµç¨‹ï¼Œç¡®ä¿æ•°æ®åº“å˜æ›´å®‰å…¨å¯é ã€‚

**æŠ€æœ¯æ ˆï¼š**
- Python 3.13+
- FastAPI
- SQLAlchemy 2.0
- PostgreSQL 14+
- Alembic
- Docker
- GitHub Actions

---

## å®Œæ•´ä»£ç ç¤ºä¾‹

### 1. Docker å®¹å™¨åŒ–

```dockerfile
# Dockerfile
FROM python:3.13-slim

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    postgresql-client \
    && rm -rf /var/lib/apt/lists/*

# å¤åˆ¶ä¾èµ–æ–‡ä»¶
COPY pyproject.toml uv.lock ./

# å®‰è£… uv å’Œä¾èµ–
RUN pip install uv && uv sync --frozen

# å¤åˆ¶åº”ç”¨ä»£ç 
COPY . .

# æš´éœ²ç«¯å£
EXPOSE 8000

# å¯åŠ¨è„šæœ¬
COPY docker-entrypoint.sh /docker-entrypoint.sh
RUN chmod +x /docker-entrypoint.sh

ENTRYPOINT ["/docker-entrypoint.sh"]
CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000"]
```

```bash
# docker-entrypoint.sh
#!/bin/bash
set -e

echo "=== Starting AI Agent API ==="

# ç­‰å¾…æ•°æ®åº“å°±ç»ª
echo "Waiting for database..."
until PGPASSWORD=$DB_PASSWORD psql -h "$DB_HOST" -U "$DB_USER" -d "$DB_NAME" -c '\q'; do
  echo "Database is unavailable - sleeping"
  sleep 1
done
echo "Database is up!"

# è¿è¡Œæ•°æ®åº“è¿ç§»
echo "Running database migrations..."
alembic upgrade head

# éªŒè¯è¿ç§»æˆåŠŸ
echo "Verifying migration..."
alembic current

echo "=== Migrations completed successfully ==="

# å¯åŠ¨åº”ç”¨
exec "$@"
```

```yaml
# docker-compose.yml
version: '3.8'

services:
  db:
    image: postgres:14
    environment:
      POSTGRES_USER: ai_agent_user
      POSTGRES_PASSWORD: secure_password
      POSTGRES_DB: ai_agent_db
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U ai_agent_user"]
      interval: 5s
      timeout: 5s
      retries: 5

  api:
    build: .
    environment:
      DATABASE_URL: postgresql://ai_agent_user:secure_password@db:5432/ai_agent_db
      DB_HOST: db
      DB_USER: ai_agent_user
      DB_PASSWORD: secure_password
      DB_NAME: ai_agent_db
    ports:
      - "8000:8000"
    depends_on:
      db:
        condition: service_healthy
    volumes:
      - ./alembic:/app/alembic
      - ./app:/app/app

volumes:
  postgres_data:
```

```bash
# æœ¬åœ°æµ‹è¯•
docker-compose up --build

# è¾“å‡ºï¼š
# db_1   | database system is ready to accept connections
# api_1  | === Starting AI Agent API ===
# api_1  | Waiting for database...
# api_1  | Database is up!
# api_1  | Running database migrations...
# api_1  | INFO  [alembic.runtime.migration] Running upgrade  -> abc123, create users table
# api_1  | INFO  [alembic.runtime.migration] Running upgrade abc123 -> def456, add conversations table
# api_1  | === Migrations completed successfully ===
# api_1  | INFO:     Started server process [1]
# api_1  | INFO:     Uvicorn running on http://0.0.0.0:8000
```

---

### 2. GitHub Actions CI/CD

```yaml
# .github/workflows/deploy.yml
name: Deploy to Production

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

env:
  REGISTRY: ghcr.io
  IMAGE_NAME: ${{ github.repository }}

jobs:
  test:
    name: Run Tests
    runs-on: ubuntu-latest

    services:
      postgres:
        image: postgres:14
        env:
          POSTGRES_USER: test_user
          POSTGRES_PASSWORD: test_password
          POSTGRES_DB: test_db
        options: >-
          --health-cmd pg_isready
          --health-interval 10s
          --health-timeout 5s
          --health-retries 5
        ports:
          - 5432:5432

    steps:
      - uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.13'

      - name: Install dependencies
        run: |
          pip install uv
          uv sync

      - name: Run database migrations
        env:
          DATABASE_URL: postgresql://test_user:test_password@localhost:5432/test_db
        run: |
          alembic upgrade head

      - name: Verify migrations
        env:
          DATABASE_URL: postgresql://test_user:test_password@localhost:5432/test_db
        run: |
          alembic current
          alembic history

      - name: Run tests
        env:
          DATABASE_URL: postgresql://test_user:test_password@localhost:5432/test_db
        run: |
          pytest tests/

  check-migrations:
    name: Check Migration Scripts
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.13'

      - name: Install dependencies
        run: |
          pip install uv
          uv sync

      - name: Check for multiple heads
        run: |
          python scripts/check_migrations.py

      - name: Generate SQL preview
        run: |
          alembic upgrade head --sql > migration_preview.sql

      - name: Upload SQL preview
        uses: actions/upload-artifact@v3
        with:
          name: migration-preview
          path: migration_preview.sql

  deploy:
    name: Deploy to Production
    runs-on: ubuntu-latest
    needs: [test, check-migrations]
    if: github.ref == 'refs/heads/main'

    steps:
      - uses: actions/checkout@v3

      - name: Log in to Container Registry
        uses: docker/login-action@v2
        with:
          registry: ${{ env.REGISTRY }}
          username: ${{ github.actor }}
          password: ${{ secrets.GITHUB_TOKEN }}

      - name: Build and push Docker image
        uses: docker/build-push-action@v4
        with:
          context: .
          push: true
          tags: ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:latest

      - name: Deploy to production
        env:
          DEPLOY_KEY: ${{ secrets.DEPLOY_KEY }}
          PRODUCTION_HOST: ${{ secrets.PRODUCTION_HOST }}
        run: |
          # SSH åˆ°ç”Ÿäº§æœåŠ¡å™¨å¹¶éƒ¨ç½²
          ssh -i $DEPLOY_KEY user@$PRODUCTION_HOST << 'EOF'
            cd /app/ai-agent-api
            docker-compose pull
            docker-compose up -d
          EOF

      - name: Verify deployment
        env:
          PRODUCTION_URL: ${{ secrets.PRODUCTION_URL }}
        run: |
          # ç­‰å¾…æœåŠ¡å¯åŠ¨
          sleep 10
          # å¥åº·æ£€æŸ¥
          curl -f $PRODUCTION_URL/health || exit 1
```

```python
# scripts/check_migrations.py
"""
æ£€æŸ¥è¿ç§»è„šæœ¬çš„å®Œæ•´æ€§
"""
import os
import re
import sys

def check_migrations():
    """æ£€æŸ¥è¿ç§»è„šæœ¬æ˜¯å¦æœ‰å¤šä¸ª head"""
    versions_dir = "alembic/versions"
    revisions = {}

    # è¯»å–æ‰€æœ‰è¿ç§»è„šæœ¬
    for filename in os.listdir(versions_dir):
        if not filename.endswith(".py"):
            continue

        filepath = os.path.join(versions_dir, filename)
        with open(filepath) as f:
            content = f.read()

        # æå– revision å’Œ down_revision
        revision_match = re.search(r"revision = ['\"](\w+)['\"]", content)
        down_revision_match = re.search(
            r"down_revision = ['\"](\w+)['\"]|down_revision = None",
            content
        )

        if revision_match:
            revision = revision_match.group(1)
            down_revision = (
                down_revision_match.group(1)
                if down_revision_match and "None" not in down_revision_match.group(0)
                else None
            )
            revisions[revision] = down_revision

    # æ£€æŸ¥æ˜¯å¦æœ‰å¤šä¸ª head
    all_down_revisions = set(r for r in revisions.values() if r)
    heads = [rev for rev in revisions.keys() if rev not in all_down_revisions]

    if len(heads) > 1:
        print(f"âŒ Error: Multiple heads detected: {heads}")
        print("Please merge branches using: alembic merge")
        return False

    if len(heads) == 0:
        print("âŒ Error: No head found")
        return False

    print(f"âœ… Migration check passed. Head: {heads[0]}")
    return True

if __name__ == "__main__":
    if not check_migrations():
        sys.exit(1)
```

---

### 3. é›¶åœæœºè¿ç§»ç­–ç•¥

**åœºæ™¯ï¼š** æ·»åŠ æ–°å­—æ®µï¼Œä½†ä¸èƒ½åœæœº

```python
# ç­–ç•¥ï¼šåˆ†3æ­¥è¿ç§»

# æ­¥éª¤1ï¼šæ·»åŠ æ–°å­—æ®µï¼ˆå¯ç©ºï¼‰
# alembic/versions/step1_add_field.py
"""step 1: add new field (nullable)

Revision ID: step1_abc123
Revises: previous
Create Date: 2026-02-11 16:00:00

"""
from alembic import op
import sqlalchemy as sa

revision = 'step1_abc123'
down_revision = 'previous'

def upgrade():
    # æ·»åŠ æ–°å­—æ®µï¼ˆå¯ç©ºï¼Œä¸å½±å“ç°æœ‰æ•°æ®ï¼‰
    op.add_column('users', sa.Column('avatar_url', sa.String(), nullable=True))
    print("Step 1: Added avatar_url field (nullable)")

def downgrade():
    op.drop_column('users', 'avatar_url')
```

```python
# æ­¥éª¤2ï¼šéƒ¨ç½²æ–°ä»£ç ï¼ˆåŒå†™ï¼‰
# app/services/user.py
def create_user(email: str, username: str, avatar_url: str = None):
    """åˆ›å»ºç”¨æˆ·ï¼ˆåŒå†™ avatar_urlï¼‰"""
    user = User(
        email=email,
        username=username,
        avatar_url=avatar_url  # æ–°ä»£ç å†™å…¥æ–°å­—æ®µ
    )
    db.add(user)
    db.commit()
    return user

def get_user_avatar(user: User) -> str:
    """è·å–ç”¨æˆ·å¤´åƒï¼ˆå…¼å®¹æ—§æ•°æ®ï¼‰"""
    return user.avatar_url or "/default-avatar.png"  # å…¼å®¹ NULL å€¼
```

```python
# æ­¥éª¤3ï¼šè¿ç§»ç°æœ‰æ•°æ®
# alembic/versions/step2_migrate_data.py
"""step 2: migrate existing data

Revision ID: step2_def456
Revises: step1_abc123
Create Date: 2026-02-11 16:10:00

"""
from alembic import op
import sqlalchemy as sa

revision = 'step2_def456'
down_revision = 'step1_abc123'

def upgrade():
    # ä¸ºç°æœ‰ç”¨æˆ·è®¾ç½®é»˜è®¤å¤´åƒ
    op.execute("""
        UPDATE users
        SET avatar_url = '/default-avatar.png'
        WHERE avatar_url IS NULL
    """)
    print("Step 2: Migrated existing data")

def downgrade():
    # æ¸…ç©ºè¿ç§»çš„æ•°æ®
    op.execute("""
        UPDATE users
        SET avatar_url = NULL
        WHERE avatar_url = '/default-avatar.png'
    """)
```

```python
# æ­¥éª¤4ï¼šè®¾ç½®ä¸ºéç©ºï¼ˆå¯é€‰ï¼‰
# alembic/versions/step3_make_not_null.py
"""step 3: make avatar_url not null

Revision ID: step3_ghi789
Revises: step2_def456
Create Date: 2026-02-11 16:20:00

"""
from alembic import op
import sqlalchemy as sa

revision = 'step3_ghi789'
down_revision = 'step2_def456'

def upgrade():
    # è®¾ç½®ä¸ºéç©º
    op.alter_column('users', 'avatar_url',
        existing_type=sa.String(),
        nullable=False
    )
    print("Step 3: Made avatar_url NOT NULL")

def downgrade():
    op.alter_column('users', 'avatar_url',
        existing_type=sa.String(),
        nullable=True
    )
```

**éƒ¨ç½²æµç¨‹ï¼š**

```bash
# 1. éƒ¨ç½²æ­¥éª¤1ï¼ˆæ·»åŠ å­—æ®µï¼‰
git checkout step1
docker-compose up -d
# æœåŠ¡ä¸ä¸­æ–­ï¼Œæ–°å­—æ®µä¸º NULL

# 2. éƒ¨ç½²æ–°ä»£ç ï¼ˆåŒå†™ï¼‰
git checkout step2
docker-compose up -d
# æœåŠ¡ä¸ä¸­æ–­ï¼Œæ–°ç”¨æˆ·å†™å…¥æ–°å­—æ®µ

# 3. è¿è¡Œæ•°æ®è¿ç§»ï¼ˆåå°ï¼‰
docker-compose exec api alembic upgrade head
# è¿ç§»ç°æœ‰æ•°æ®ï¼ŒæœåŠ¡ä¸ä¸­æ–­

# 4. éƒ¨ç½²æ­¥éª¤3ï¼ˆè®¾ç½®éç©ºï¼Œå¯é€‰ï¼‰
git checkout step3
docker-compose up -d
# æœåŠ¡ä¸ä¸­æ–­ï¼Œå­—æ®µå˜ä¸ºéç©º
```

---

### 4. ç”Ÿäº§ç¯å¢ƒè¿ç§»è„šæœ¬

```python
# scripts/migrate_production.py
"""
ç”Ÿäº§ç¯å¢ƒè¿ç§»è„šæœ¬
"""
import os
import sys
import subprocess
from datetime import datetime

def backup_database():
    """å¤‡ä»½æ•°æ®åº“"""
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    backup_file = f"backup_{timestamp}.sql"

    print(f"ğŸ“¦ Backing up database to {backup_file}...")

    cmd = [
        "pg_dump",
        "-h", os.getenv("DB_HOST"),
        "-U", os.getenv("DB_USER"),
        "-d", os.getenv("DB_NAME"),
        "-f", backup_file
    ]

    result = subprocess.run(cmd, capture_output=True, text=True)

    if result.returncode != 0:
        print(f"âŒ Backup failed: {result.stderr}")
        return None

    print(f"âœ… Backup completed: {backup_file}")
    return backup_file

def check_pending_migrations():
    """æ£€æŸ¥å¾…æ‰§è¡Œçš„è¿ç§»"""
    print("ğŸ” Checking pending migrations...")

    # è·å–å½“å‰ç‰ˆæœ¬
    result = subprocess.run(
        ["alembic", "current"],
        capture_output=True,
        text=True
    )
    current_version = result.stdout.strip()
    print(f"Current version: {current_version}")

    # è·å–ç›®æ ‡ç‰ˆæœ¬
    result = subprocess.run(
        ["alembic", "heads"],
        capture_output=True,
        text=True
    )
    target_version = result.stdout.strip()
    print(f"Target version: {target_version}")

    if current_version == target_version:
        print("âœ… Database is up to date")
        return False

    # é¢„è§ˆè¿ç§»
    print("\nğŸ“‹ Pending migrations:")
    subprocess.run(["alembic", "history", "-r", f"{current_version}:head"])

    return True

def run_migrations():
    """è¿è¡Œè¿ç§»"""
    print("\nğŸš€ Running migrations...")

    result = subprocess.run(
        ["alembic", "upgrade", "head"],
        capture_output=True,
        text=True
    )

    print(result.stdout)

    if result.returncode != 0:
        print(f"âŒ Migration failed: {result.stderr}")
        return False

    print("âœ… Migrations completed successfully")
    return True

def verify_migrations():
    """éªŒè¯è¿ç§»"""
    print("\nâœ… Verifying migrations...")

    result = subprocess.run(
        ["alembic", "current"],
        capture_output=True,
        text=True
    )

    print(f"Current version: {result.stdout.strip()}")

    # æ£€æŸ¥æ•°æ®åº“è¿æ¥
    result = subprocess.run(
        ["psql", "-h", os.getenv("DB_HOST"), "-U", os.getenv("DB_USER"),
         "-d", os.getenv("DB_NAME"), "-c", "SELECT 1"],
        capture_output=True,
        text=True
    )

    if result.returncode != 0:
        print(f"âŒ Database connection failed: {result.stderr}")
        return False

    print("âœ… Database connection verified")
    return True

def main():
    """ä¸»å‡½æ•°"""
    print("=" * 50)
    print("ğŸ”§ Production Database Migration")
    print("=" * 50)

    # 1. å¤‡ä»½æ•°æ®åº“
    backup_file = backup_database()
    if not backup_file:
        print("âŒ Backup failed. Aborting migration.")
        sys.exit(1)

    # 2. æ£€æŸ¥å¾…æ‰§è¡Œçš„è¿ç§»
    has_pending = check_pending_migrations()
    if not has_pending:
        print("âœ… No migrations to run")
        return

    # 3. ç¡®è®¤æ‰§è¡Œ
    response = input("\nâš ï¸  Continue with migration? (yes/no): ")
    if response.lower() != "yes":
        print("âŒ Migration cancelled")
        sys.exit(0)

    # 4. è¿è¡Œè¿ç§»
    success = run_migrations()
    if not success:
        print(f"\nâŒ Migration failed. Restore from backup: {backup_file}")
        sys.exit(1)

    # 5. éªŒè¯è¿ç§»
    success = verify_migrations()
    if not success:
        print(f"\nâŒ Verification failed. Restore from backup: {backup_file}")
        sys.exit(1)

    print("\n" + "=" * 50)
    print("âœ… Migration completed successfully!")
    print(f"ğŸ“¦ Backup saved: {backup_file}")
    print("=" * 50)

if __name__ == "__main__":
    main()
```

```bash
# ä½¿ç”¨è¿ç§»è„šæœ¬
python scripts/migrate_production.py

# è¾“å‡ºï¼š
# ==================================================
# ğŸ”§ Production Database Migration
# ==================================================
# ğŸ“¦ Backing up database to backup_20260211_160000.sql...
# âœ… Backup completed: backup_20260211_160000.sql
# ğŸ” Checking pending migrations...
# Current version: abc123def456
# Target version: ghi789jkl012
#
# ğŸ“‹ Pending migrations:
# ghi789jkl012 -> head, add avatar_url to users
#
# âš ï¸  Continue with migration? (yes/no): yes
#
# ğŸš€ Running migrations...
# INFO  [alembic.runtime.migration] Running upgrade abc123 -> ghi789, add avatar_url
# âœ… Migrations completed successfully
#
# âœ… Verifying migrations...
# Current version: ghi789jkl012 (head)
# âœ… Database connection verified
#
# ==================================================
# âœ… Migration completed successfully!
# ğŸ“¦ Backup saved: backup_20260211_160000.sql
# ==================================================
```

---

### 5. å›æ»šç­–ç•¥

```python
# scripts/rollback_production.py
"""
ç”Ÿäº§ç¯å¢ƒå›æ»šè„šæœ¬
"""
import os
import sys
import subprocess
from datetime import datetime

def rollback_migration(steps=1):
    """å›æ»šè¿ç§»"""
    print(f"âª Rolling back {steps} migration(s)...")

    # æ˜¾ç¤ºå½“å‰ç‰ˆæœ¬
    result = subprocess.run(
        ["alembic", "current"],
        capture_output=True,
        text=True
    )
    print(f"Current version: {result.stdout.strip()}")

    # ç¡®è®¤å›æ»š
    response = input(f"\nâš ï¸  Rollback {steps} migration(s)? (yes/no): ")
    if response.lower() != "yes":
        print("âŒ Rollback cancelled")
        sys.exit(0)

    # æ‰§è¡Œå›æ»š
    result = subprocess.run(
        ["alembic", "downgrade", f"-{steps}"],
        capture_output=True,
        text=True
    )

    print(result.stdout)

    if result.returncode != 0:
        print(f"âŒ Rollback failed: {result.stderr}")
        return False

    # æ˜¾ç¤ºæ–°ç‰ˆæœ¬
    result = subprocess.run(
        ["alembic", "current"],
        capture_output=True,
        text=True
    )
    print(f"New version: {result.stdout.strip()}")

    print("âœ… Rollback completed successfully")
    return True

def main():
    """ä¸»å‡½æ•°"""
    if len(sys.argv) < 2:
        print("Usage: python rollback_production.py <steps>")
        print("Example: python rollback_production.py 1")
        sys.exit(1)

    steps = int(sys.argv[1])
    rollback_migration(steps)

if __name__ == "__main__":
    main()
```

```bash
# å›æ»šæœ€åä¸€æ¬¡è¿ç§»
python scripts/rollback_production.py 1

# è¾“å‡ºï¼š
# âª Rolling back 1 migration(s)...
# Current version: ghi789jkl012 (head)
#
# âš ï¸  Rollback 1 migration(s)? (yes/no): yes
#
# INFO  [alembic.runtime.migration] Running downgrade ghi789 -> abc123, add avatar_url
# New version: abc123def456
# âœ… Rollback completed successfully
```

---

### 6. å¥åº·æ£€æŸ¥ç«¯ç‚¹

```python
# app/api/health.py
"""
å¥åº·æ£€æŸ¥ç«¯ç‚¹
"""
from fastapi import APIRouter, Depends
from sqlalchemy.orm import Session
from sqlalchemy import text

from app.core.database import get_db

router = APIRouter()

@router.get("/health")
async def health_check(db: Session = Depends(get_db)):
    """å¥åº·æ£€æŸ¥"""
    try:
        # æ£€æŸ¥æ•°æ®åº“è¿æ¥
        db.execute(text("SELECT 1"))

        # æ£€æŸ¥ Alembic ç‰ˆæœ¬
        result = db.execute(text("SELECT version_num FROM alembic_version"))
        version = result.scalar()

        return {
            "status": "healthy",
            "database": "connected",
            "migration_version": version
        }
    except Exception as e:
        return {
            "status": "unhealthy",
            "error": str(e)
        }
```

```bash
# æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://localhost:8000/health

# è¾“å‡ºï¼š
# {
#   "status": "healthy",
#   "database": "connected",
#   "migration_version": "ghi789jkl012"
# }
```

---

## è¿è¡Œè¾“å‡ºç¤ºä¾‹

```bash
# CI/CD æµç¨‹
$ git push origin main

# GitHub Actions è¾“å‡ºï¼š
# âœ“ Run Tests
#   - Set up Python: âœ“
#   - Install dependencies: âœ“
#   - Run database migrations: âœ“
#   - Verify migrations: âœ“
#   - Run tests: âœ“
#
# âœ“ Check Migration Scripts
#   - Check for multiple heads: âœ“
#   - Generate SQL preview: âœ“
#
# âœ“ Deploy to Production
#   - Build and push Docker image: âœ“
#   - Deploy to production: âœ“
#   - Verify deployment: âœ“

# ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
$ ssh production-server
$ cd /app/ai-agent-api
$ python scripts/migrate_production.py

# è¾“å‡ºï¼š
# ==================================================
# ğŸ”§ Production Database Migration
# ==================================================
# ğŸ“¦ Backing up database...
# âœ… Backup completed: backup_20260211_160000.sql
# ğŸ” Checking pending migrations...
# ğŸ“‹ Pending migrations: 2
# âš ï¸  Continue? yes
# ğŸš€ Running migrations...
# âœ… Migrations completed successfully
# ==================================================
```

---

## å…³é”®è¦ç‚¹

1. **Docker å®¹å™¨åŒ–**ï¼šä½¿ç”¨ docker-entrypoint.sh è‡ªåŠ¨è¿è¡Œè¿ç§»
2. **CI/CD é›†æˆ**ï¼šGitHub Actions è‡ªåŠ¨æµ‹è¯•å’Œéƒ¨ç½²
3. **é›¶åœæœºè¿ç§»**ï¼šåˆ†æ­¥è¿ç§»ï¼ŒåŒå†™ç­–ç•¥
4. **å¤‡ä»½ç­–ç•¥**ï¼šè¿ç§»å‰è‡ªåŠ¨å¤‡ä»½æ•°æ®åº“
5. **å›æ»šç­–ç•¥**ï¼šæä¾›å¿«é€Ÿå›æ»šè„šæœ¬
6. **å¥åº·æ£€æŸ¥**ï¼šç›‘æ§æ•°æ®åº“å’Œè¿ç§»ç‰ˆæœ¬
7. **è¿ç§»éªŒè¯**ï¼šè‡ªåŠ¨æ£€æŸ¥å¤š headã€ç”Ÿæˆ SQL é¢„è§ˆ

---

## ä¸‹ä¸€æ­¥

å®Œæˆç”Ÿäº§ç¯å¢ƒéƒ¨ç½²åï¼Œå¯ä»¥å­¦ä¹ ï¼š
- ç›‘æ§å’Œå‘Šè­¦ï¼ˆæ•°æ®åº“æ€§èƒ½ã€è¿ç§»å¤±è´¥é€šçŸ¥ï¼‰
- å¤šç¯å¢ƒç®¡ç†ï¼ˆå¼€å‘ã€æµ‹è¯•ã€é¢„å‘å¸ƒã€ç”Ÿäº§ï¼‰
- æ•°æ®åº“ç‰ˆæœ¬å®¡è®¡ï¼ˆè®°å½•æ‰€æœ‰è¿ç§»æ“ä½œï¼‰
