# docker-composeç¼–æ’ - å®æˆ˜ä»£ç ï¼šå®Œæ•´å¼€å‘ç¯å¢ƒ

## æ¦‚è¿°

æœ¬æ–‡æä¾›ä¸€ä¸ªå®Œæ•´çš„ AI Agent å¼€å‘ç¯å¢ƒç¤ºä¾‹ï¼ŒåŒ…å« FastAPI + PostgreSQL + Redis + pgAdminï¼Œé€‚åˆå®é™…é¡¹ç›®å¼€å‘ã€‚

**ç›®æ ‡ï¼š**
- å®Œæ•´çš„å¼€å‘å·¥å…·é“¾
- å¥åº·æ£€æŸ¥å’Œä¾èµ–ç®¡ç†
- æ•°æ®æŒä¹…åŒ–å’Œä»£ç çƒ­é‡è½½
- å¼€å‘å·¥å…·é›†æˆï¼ˆpgAdminï¼‰
- å®Œæ•´å¯è¿è¡Œ

---

## 1. é¡¹ç›®ç»“æ„

```
complete-dev-env/
â”œâ”€â”€ docker-compose.yml      # docker-compose é…ç½®
â”œâ”€â”€ Dockerfile              # API é•œåƒæ„å»º
â”œâ”€â”€ requirements.txt        # Python ä¾èµ–
â”œâ”€â”€ .env                    # ç¯å¢ƒå˜é‡
â”œâ”€â”€ .env.example            # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ .gitignore             # Git å¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ init.sql               # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â””â”€â”€ app/
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ main.py            # FastAPI åº”ç”¨
    â”œâ”€â”€ config.py          # é…ç½®ç®¡ç†
    â”œâ”€â”€ database.py        # æ•°æ®åº“è¿æ¥
    â””â”€â”€ models.py          # æ•°æ®æ¨¡å‹
```

---

## 2. æ–‡ä»¶å†…å®¹

### 2.1 docker-compose.yml

```yaml
version: '3.8'

services:
  # FastAPI åº”ç”¨
  api:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: complete-api
    ports:
      - "8000:8000"
    environment:
      - DATABASE_URL=postgresql://user:pass@db:5432/agent_db
      - REDIS_URL=redis://redis:6379
      - DEBUG=true
      - LOG_LEVEL=debug
    depends_on:
      db:
        condition: service_healthy
      redis:
        condition: service_started
    volumes:
      - .:/app:delegated  # ä»£ç çƒ­é‡è½½ï¼ˆMac ä¼˜åŒ–ï¼‰
      - /app/.venv        # æ’é™¤è™šæ‹Ÿç¯å¢ƒ
    command: uvicorn app.main:app --host 0.0.0.0 --reload
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 30s
    restart: unless-stopped
    networks:
      - app-network

  # PostgreSQL æ•°æ®åº“
  db:
    image: postgres:14-alpine
    container_name: complete-db
    environment:
      - POSTGRES_USER=user
      - POSTGRES_PASSWORD=pass
      - POSTGRES_DB=agent_db
    ports:
      - "5432:5432"  # å¼€å‘ç¯å¢ƒæš´éœ²ç«¯å£ï¼ˆæ–¹ä¾¿è°ƒè¯•ï¼‰
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./init.sql:/docker-entrypoint-initdb.d/init.sql:ro
    healthcheck:
      test: ["CMD", "pg_isready", "-U", "user"]
      interval: 5s
      timeout: 3s
      retries: 5
      start_period: 10s
    restart: unless-stopped
    networks:
      - app-network

  # Redis ç¼“å­˜
  redis:
    image: redis:7-alpine
    container_name: complete-redis
    ports:
      - "6379:6379"  # å¼€å‘ç¯å¢ƒæš´éœ²ç«¯å£
    volumes:
      - redis_data:/data
    command: redis-server --appendonly yes
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 5s
      timeout: 3s
      retries: 5
    restart: unless-stopped
    networks:
      - app-network

  # pgAdminï¼ˆæ•°æ®åº“ç®¡ç†å·¥å…·ï¼‰
  pgadmin:
    image: dpage/pgadmin4
    container_name: complete-pgadmin
    ports:
      - "5050:80"
    environment:
      - PGADMIN_DEFAULT_EMAIL=admin@example.com
      - PGADMIN_DEFAULT_PASSWORD=admin
    volumes:
      - pgadmin_data:/var/lib/pgadmin
    depends_on:
      - db
    restart: unless-stopped
    networks:
      - app-network

volumes:
  postgres_data:
  redis_data:
  pgadmin_data:

networks:
  app-network:
    driver: bridge
```

### 2.2 Dockerfile

```dockerfile
FROM python:3.13-slim

WORKDIR /app

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update && apt-get install -y \
    curl \
    && rm -rf /var/lib/apt/lists/*

# å®‰è£… Python ä¾èµ–
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# å¤åˆ¶ä»£ç 
COPY . .

# æš´éœ²ç«¯å£
EXPOSE 8000

# å¯åŠ¨å‘½ä»¤
CMD ["uvicorn", "app.main:app", "--host", "0.0.0.0"]
```

### 2.3 requirements.txt

```txt
# Web æ¡†æ¶
fastapi==0.109.0
uvicorn[standard]==0.27.0

# æ•°æ®åº“
psycopg2-binary==2.9.9
sqlalchemy==2.0.25

# Redis
redis==5.0.1

# æ•°æ®éªŒè¯
pydantic==2.5.3
pydantic-settings==2.1.0

# å·¥å…·
python-dotenv==1.0.0
```

### 2.4 app/config.py

```python
"""
é…ç½®ç®¡ç†
"""

from pydantic_settings import BaseSettings
from functools import lru_cache


class Settings(BaseSettings):
    """åº”ç”¨é…ç½®"""

    # åº”ç”¨é…ç½®
    app_name: str = "Complete Dev Environment"
    debug: bool = True
    log_level: str = "debug"

    # æ•°æ®åº“é…ç½®
    database_url: str = "postgresql://user:pass@localhost:5432/agent_db"

    # Redis é…ç½®
    redis_url: str = "redis://localhost:6379"

    class Config:
        env_file = ".env"
        case_sensitive = False


@lru_cache()
def get_settings() -> Settings:
    """è·å–é…ç½®ï¼ˆå•ä¾‹ï¼‰"""
    return Settings()
```

### 2.5 app/database.py

```python
"""
æ•°æ®åº“è¿æ¥ç®¡ç†
"""

from sqlalchemy import create_engine, text
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import sessionmaker
from app.config import get_settings

settings = get_settings()

# åˆ›å»ºæ•°æ®åº“å¼•æ“
engine = create_engine(
    settings.database_url,
    pool_pre_ping=True,  # è¿æ¥å‰æ£€æŸ¥
    pool_size=5,
    max_overflow=10
)

# åˆ›å»ºä¼šè¯å·¥å‚
SessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)

# åˆ›å»ºåŸºç±»
Base = declarative_base()


def get_db():
    """è·å–æ•°æ®åº“ä¼šè¯ï¼ˆä¾èµ–æ³¨å…¥ï¼‰"""
    db = SessionLocal()
    try:
        yield db
    finally:
        db.close()


def check_db_connection():
    """æ£€æŸ¥æ•°æ®åº“è¿æ¥"""
    try:
        with engine.connect() as conn:
            conn.execute(text("SELECT 1"))
        return True
    except Exception:
        return False
```

### 2.6 app/models.py

```python
"""
æ•°æ®æ¨¡å‹
"""

from sqlalchemy import Column, Integer, String, Text, DateTime
from sqlalchemy.sql import func
from app.database import Base


class Item(Base):
    """Item æ¨¡å‹"""

    __tablename__ = "items"

    id = Column(Integer, primary_key=True, index=True)
    name = Column(String(100), nullable=False, index=True)
    description = Column(Text)
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), onupdate=func.now())

    def __repr__(self):
        return f"<Item(id={self.id}, name='{self.name}')>"
```

### 2.7 app/main.py

```python
"""
å®Œæ•´å¼€å‘ç¯å¢ƒ FastAPI åº”ç”¨
æ¼”ç¤ºï¼šæ•°æ®åº“è¿æ¥ã€Redis ç¼“å­˜ã€å¥åº·æ£€æŸ¥ã€CRUD æ“ä½œ
"""

from fastapi import FastAPI, HTTPException, Depends
from pydantic import BaseModel
from sqlalchemy.orm import Session
import redis
from typing import List

from app.config import get_settings
from app.database import get_db, check_db_connection, Base, engine
from app.models import Item as ItemModel

# é…ç½®
settings = get_settings()

# åˆ›å»ºåº”ç”¨
app = FastAPI(
    title=settings.app_name,
    debug=settings.debug
)

# Redis å®¢æˆ·ç«¯
redis_client = redis.from_url(settings.redis_url, decode_responses=True)


# ===== æ•°æ®æ¨¡å‹ =====
class ItemCreate(BaseModel):
    name: str
    description: str = None


class ItemResponse(BaseModel):
    id: int
    name: str
    description: str = None

    class Config:
        from_attributes = True


# ===== å¯åŠ¨äº‹ä»¶ =====
@app.on_event("startup")
async def startup():
    """å¯åŠ¨æ—¶åˆ›å»ºè¡¨"""
    Base.metadata.create_all(bind=engine)
    print(f"âœ… {settings.app_name} started")
    print(f"ğŸ“Š Database: {settings.database_url}")
    print(f"ğŸ”´ Redis: {settings.redis_url}")


# ===== æ ¹ç«¯ç‚¹ =====
@app.get("/")
async def root():
    """æ ¹ç«¯ç‚¹"""
    return {
        "message": f"Welcome to {settings.app_name}",
        "version": "2.0.0",
        "docs": "/docs"
    }


# ===== å¥åº·æ£€æŸ¥ =====
@app.get("/health")
async def health():
    """å¥åº·æ£€æŸ¥ï¼ˆæ£€æŸ¥æ‰€æœ‰ä¾èµ–ï¼‰"""
    health_status = {
        "status": "healthy",
        "database": "unknown",
        "redis": "unknown"
    }

    # æ£€æŸ¥æ•°æ®åº“
    try:
        if check_db_connection():
            health_status["database"] = "connected"
        else:
            health_status["database"] = "disconnected"
            health_status["status"] = "unhealthy"
    except Exception as e:
        health_status["database"] = f"error: {str(e)}"
        health_status["status"] = "unhealthy"

    # æ£€æŸ¥ Redis
    try:
        redis_client.ping()
        health_status["redis"] = "connected"
    except Exception as e:
        health_status["redis"] = f"error: {str(e)}"
        health_status["status"] = "unhealthy"

    if health_status["status"] == "unhealthy":
        raise HTTPException(status_code=503, detail=health_status)

    return health_status


# ===== CRUD æ“ä½œ =====
@app.post("/items", response_model=ItemResponse)
async def create_item(item: ItemCreate, db: Session = Depends(get_db)):
    """åˆ›å»º item"""
    db_item = ItemModel(name=item.name, description=item.description)
    db.add(db_item)
    db.commit()
    db.refresh(db_item)

    # æ¸…é™¤ç¼“å­˜
    redis_client.delete("items:all")

    return db_item


@app.get("/items", response_model=List[ItemResponse])
async def list_items(db: Session = Depends(get_db)):
    """è·å–æ‰€æœ‰ itemsï¼ˆå¸¦ç¼“å­˜ï¼‰"""
    # å°è¯•ä»ç¼“å­˜è·å–
    cache_key = "items:all"
    cached = redis_client.get(cache_key)

    if cached:
        print("ğŸ“¦ Cache hit")
        # æ³¨æ„ï¼šè¿™é‡Œç®€åŒ–äº†ï¼Œå®é™…åº”è¯¥åºåˆ—åŒ–/ååºåˆ—åŒ–
        pass

    # ä»æ•°æ®åº“è·å–
    items = db.query(ItemModel).order_by(ItemModel.id).all()

    # ç¼“å­˜ç»“æœï¼ˆ60ç§’ï¼‰
    redis_client.setex(cache_key, 60, "cached")

    return items


@app.get("/items/{item_id}", response_model=ItemResponse)
async def get_item(item_id: int, db: Session = Depends(get_db)):
    """è·å–å•ä¸ª item"""
    item = db.query(ItemModel).filter(ItemModel.id == item_id).first()

    if not item:
        raise HTTPException(status_code=404, detail="Item not found")

    return item


@app.put("/items/{item_id}", response_model=ItemResponse)
async def update_item(item_id: int, item: ItemCreate, db: Session = Depends(get_db)):
    """æ›´æ–° item"""
    db_item = db.query(ItemModel).filter(ItemModel.id == item_id).first()

    if not db_item:
        raise HTTPException(status_code=404, detail="Item not found")

    db_item.name = item.name
    db_item.description = item.description
    db.commit()
    db.refresh(db_item)

    # æ¸…é™¤ç¼“å­˜
    redis_client.delete("items:all")

    return db_item


@app.delete("/items/{item_id}")
async def delete_item(item_id: int, db: Session = Depends(get_db)):
    """åˆ é™¤ item"""
    db_item = db.query(ItemModel).filter(ItemModel.id == item_id).first()

    if not db_item:
        raise HTTPException(status_code=404, detail="Item not found")

    db.delete(db_item)
    db.commit()

    # æ¸…é™¤ç¼“å­˜
    redis_client.delete("items:all")

    return {"message": "Item deleted"}


# ===== Redis æ“ä½œç¤ºä¾‹ =====
@app.post("/cache/{key}")
async def set_cache(key: str, value: str):
    """è®¾ç½®ç¼“å­˜"""
    redis_client.setex(key, 60, value)
    return {"message": f"Cache set: {key} = {value}"}


@app.get("/cache/{key}")
async def get_cache(key: str):
    """è·å–ç¼“å­˜"""
    value = redis_client.get(key)

    if not value:
        raise HTTPException(status_code=404, detail="Cache not found")

    return {"key": key, "value": value}
```

### 2.8 init.sql

```sql
-- æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
-- åªåœ¨é¦–æ¬¡å¯åŠ¨æ—¶æ‰§è¡Œ

-- åˆ›å»ºæ‰©å±•ï¼ˆå¦‚æœéœ€è¦ï¼‰
-- CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

-- æ’å…¥æµ‹è¯•æ•°æ®
INSERT INTO items (name, description) VALUES
    ('Sample Item 1', 'This is a sample item'),
    ('Sample Item 2', 'Another sample item'),
    ('Sample Item 3', 'Yet another sample item')
ON CONFLICT DO NOTHING;
```

### 2.9 .env.example

```bash
# åº”ç”¨é…ç½®
APP_NAME=Complete Dev Environment
DEBUG=true
LOG_LEVEL=debug

# æ•°æ®åº“é…ç½®
DATABASE_URL=postgresql://user:pass@db:5432/agent_db
POSTGRES_USER=user
POSTGRES_PASSWORD=pass
POSTGRES_DB=agent_db

# Redis é…ç½®
REDIS_URL=redis://redis:6379

# pgAdmin é…ç½®
PGADMIN_DEFAULT_EMAIL=admin@example.com
PGADMIN_DEFAULT_PASSWORD=admin
```

### 2.10 .env

```bash
# å¤åˆ¶ .env.example å¹¶ä¿®æ”¹
DATABASE_URL=postgresql://user:pass@db:5432/agent_db
REDIS_URL=redis://redis:6379
DEBUG=true
LOG_LEVEL=debug
```

---

## 3. ä½¿ç”¨æ­¥éª¤

### 3.1 å¯åŠ¨ç¯å¢ƒ

```bash
# 1. åˆ›å»ºé¡¹ç›®ç›®å½•
mkdir complete-dev-env && cd complete-dev-env

# 2. åˆ›å»ºæ‰€æœ‰æ–‡ä»¶

# 3. å¤åˆ¶ç¯å¢ƒå˜é‡
cp .env.example .env

# 4. å¯åŠ¨æœåŠ¡
docker-compose up

# æˆ–è€…åå°è¿è¡Œ
docker-compose up -d
```

### 3.2 è®¿é—®æœåŠ¡

**API æœåŠ¡ï¼š**
- API: http://localhost:8000
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

**æ•°æ®åº“ç®¡ç†ï¼š**
- pgAdmin: http://localhost:5050
  - Email: admin@example.com
  - Password: admin

**ç›´æ¥è¿æ¥ï¼š**
- PostgreSQL: localhost:5432
- Redis: localhost:6379

### 3.3 é…ç½® pgAdmin

1. è®¿é—® http://localhost:5050
2. ç™»å½•ï¼ˆadmin@example.com / adminï¼‰
3. æ·»åŠ æœåŠ¡å™¨ï¼š
   - Name: Complete Dev DB
   - Host: dbï¼ˆæœåŠ¡åï¼‰
   - Port: 5432
   - Username: user
   - Password: pass

### 3.4 æµ‹è¯• API

```bash
# 1. å¥åº·æ£€æŸ¥
curl http://localhost:8000/health

# è¾“å‡º
{
  "status": "healthy",
  "database": "connected",
  "redis": "connected"
}

# 2. åˆ›å»º item
curl -X POST http://localhost:8000/items \
  -H "Content-Type: application/json" \
  -d '{"name": "Test Item", "description": "This is a test"}'

# 3. è·å–æ‰€æœ‰ items
curl http://localhost:8000/items

# 4. æµ‹è¯• Redis ç¼“å­˜
curl -X POST http://localhost:8000/cache/test_key \
  -H "Content-Type: application/json" \
  -d '"test_value"'

curl http://localhost:8000/cache/test_key
```

---

## 4. å¼€å‘å·¥ä½œæµ

### 4.1 ä»£ç çƒ­é‡è½½

```bash
# ä¿®æ”¹ app/main.py
# ä¿å­˜åè‡ªåŠ¨é‡å¯

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f api
```

### 4.2 æ•°æ®åº“æ“ä½œ

```bash
# è¿›å…¥æ•°æ®åº“å®¹å™¨
docker-compose exec db psql -U user -d agent_db

# æŸ¥è¯¢æ•°æ®
agent_db=# SELECT * FROM items;
agent_db=# \dt  # æŸ¥çœ‹æ‰€æœ‰è¡¨
agent_db=# \d items  # æŸ¥çœ‹è¡¨ç»“æ„
```

### 4.3 Redis æ“ä½œ

```bash
# è¿›å…¥ Redis å®¹å™¨
docker-compose exec redis redis-cli

# æŸ¥çœ‹æ‰€æœ‰é”®
127.0.0.1:6379> KEYS *

# è·å–å€¼
127.0.0.1:6379> GET items:all

# æŸ¥çœ‹ TTL
127.0.0.1:6379> TTL items:all
```

### 4.4 æŸ¥çœ‹æ—¥å¿—

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker-compose logs

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
docker-compose logs api
docker-compose logs db
docker-compose logs redis

# å®æ—¶æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹æœ€è¿‘ 100 è¡Œ
docker-compose logs --tail=100
```

---

## 5. é«˜çº§åŠŸèƒ½

### 5.1 æ•°æ®åº“è¿ç§»

```bash
# å®‰è£… Alembic
pip install alembic

# åˆå§‹åŒ–è¿ç§»
alembic init alembic

# åˆ›å»ºè¿ç§»
alembic revision --autogenerate -m "Initial migration"

# æ‰§è¡Œè¿ç§»
docker-compose exec api alembic upgrade head
```

### 5.2 æ€§èƒ½ç›‘æ§

```bash
# æŸ¥çœ‹èµ„æºä½¿ç”¨
docker stats

# è¾“å‡º
CONTAINER        CPU %    MEM USAGE / LIMIT
complete-api     1.5%     100MB / 1GB
complete-db      0.5%     50MB / 1GB
complete-redis   0.2%     20MB / 1GB
```

### 5.3 å¤‡ä»½æ•°æ®åº“

```bash
# å¤‡ä»½
docker-compose exec db pg_dump -U user agent_db > backup.sql

# æ¢å¤
docker-compose exec -T db psql -U user agent_db < backup.sql
```

---

## 6. æ•…éšœæ’æŸ¥

### 6.1 å¥åº·æ£€æŸ¥å¤±è´¥

```bash
# æŸ¥çœ‹å¥åº·æ£€æŸ¥çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker-compose logs api

# æ‰‹åŠ¨æµ‹è¯•å¥åº·æ£€æŸ¥
curl http://localhost:8000/health
```

### 6.2 æ•°æ®åº“è¿æ¥å¤±è´¥

```bash
# æ£€æŸ¥æ•°æ®åº“æ˜¯å¦å°±ç»ª
docker-compose exec db pg_isready -U user

# æ£€æŸ¥ç½‘ç»œè¿æ¥
docker-compose exec api ping db
```

### 6.3 Redis è¿æ¥å¤±è´¥

```bash
# æ£€æŸ¥ Redis æ˜¯å¦è¿è¡Œ
docker-compose exec redis redis-cli ping

# è¾“å‡ºåº”è¯¥æ˜¯ PONG
```

---

## 7. æ¸…ç†å’Œé‡ç½®

### 7.1 åœæ­¢æœåŠ¡

```bash
# åœæ­¢æœåŠ¡
docker-compose down

# åœæ­¢å¹¶åˆ é™¤æ•°æ®å·ï¼ˆæ•°æ®ä¼šä¸¢å¤±ï¼ï¼‰
docker-compose down -v
```

### 7.2 é‡å»ºç¯å¢ƒ

```bash
# é‡å»ºé•œåƒ
docker-compose build --no-cache

# é‡å»ºå¹¶å¯åŠ¨
docker-compose up --build
```

### 7.3 æ¸…ç†æ•°æ®

```bash
# åªæ¸…ç† Redis æ•°æ®
docker-compose exec redis redis-cli FLUSHALL

# åªæ¸…ç†æ•°æ®åº“æ•°æ®
docker-compose exec db psql -U user -d agent_db -c "TRUNCATE items CASCADE"
```

---

## 8. æ‰©å±•å»ºè®®

### 8.1 æ·»åŠ å‘é‡æ•°æ®åº“

```yaml
services:
  chroma:
    image: chromadb/chroma:latest
    ports:
      - "8001:8000"
    volumes:
      - chroma_data:/chroma/chroma
    networks:
      - app-network

volumes:
  chroma_data:
```

### 8.2 æ·»åŠ æ¶ˆæ¯é˜Ÿåˆ—

```yaml
services:
  rabbitmq:
    image: rabbitmq:3-management
    ports:
      - "5672:5672"
      - "15672:15672"
    networks:
      - app-network
```

### 8.3 æ·»åŠ ç›‘æ§

```yaml
services:
  prometheus:
    image: prom/prometheus
    ports:
      - "9090:9090"
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml:ro
    networks:
      - app-network
```

---

## 9. å­¦ä¹ è¦ç‚¹

### 9.1 æ ¸å¿ƒåŠŸèƒ½

1. **å®Œæ•´å·¥å…·é“¾**ï¼šAPI + æ•°æ®åº“ + ç¼“å­˜ + ç®¡ç†å·¥å…·
2. **å¥åº·æ£€æŸ¥**ï¼šç¡®ä¿æ‰€æœ‰æœåŠ¡å°±ç»ª
3. **æ•°æ®æŒä¹…åŒ–**ï¼šæ•°æ®åº“å’Œ Redis æ•°æ®ä¸ä¸¢å¤±
4. **ä»£ç çƒ­é‡è½½**ï¼šå¼€å‘æ•ˆç‡æå‡
5. **ç½‘ç»œéš”ç¦»**ï¼šæ‰€æœ‰æœåŠ¡åœ¨åŒä¸€ç½‘ç»œ

### 9.2 æœ€ä½³å®è·µ

1. âœ… ä½¿ç”¨å¥åº·æ£€æŸ¥ + æ¡ä»¶ç­‰å¾…
2. âœ… å¼€å‘ç¯å¢ƒæš´éœ²ç«¯å£ï¼ˆæ–¹ä¾¿è°ƒè¯•ï¼‰
3. âœ… ä½¿ç”¨å‘½åå·æŒä¹…åŒ–æ•°æ®
4. âœ… ä½¿ç”¨ç»‘å®šæŒ‚è½½å®ç°çƒ­é‡è½½
5. âœ… é›†æˆå¼€å‘å·¥å…·ï¼ˆpgAdminï¼‰

### 9.3 ä¸åŸºç¡€ç¯å¢ƒçš„åŒºåˆ«

| ç‰¹æ€§ | åŸºç¡€ç¯å¢ƒ | å®Œæ•´ç¯å¢ƒ |
|------|---------|---------|
| **æœåŠ¡æ•°é‡** | 2ä¸ªï¼ˆAPI + DBï¼‰ | 4ä¸ªï¼ˆAPI + DB + Redis + pgAdminï¼‰ |
| **å¥åº·æ£€æŸ¥** | åªæœ‰ DB | æ‰€æœ‰æœåŠ¡ |
| **ç¼“å­˜** | æ—  | Redis |
| **ç®¡ç†å·¥å…·** | æ—  | pgAdmin |
| **é…ç½®ç®¡ç†** | ç®€å• | å®Œæ•´ï¼ˆconfig.pyï¼‰ |
| **æ•°æ®æ¨¡å‹** | ç®€å• | SQLAlchemy ORM |

---

## 10. æ€»ç»“

**å®Œæ•´å¼€å‘ç¯å¢ƒæä¾›ï¼š**
1. âœ… FastAPI + PostgreSQL + Redis + pgAdmin
2. âœ… å®Œæ•´çš„å¥åº·æ£€æŸ¥å’Œä¾èµ–ç®¡ç†
3. âœ… æ•°æ®æŒä¹…åŒ–å’Œä»£ç çƒ­é‡è½½
4. âœ… å¼€å‘å·¥å…·é›†æˆ
5. âœ… ç”Ÿäº§çº§ä»£ç ç»“æ„

**é€‚ç”¨åœºæ™¯ï¼š**
- å®é™…é¡¹ç›®å¼€å‘
- å›¢é˜Ÿåä½œ
- å­¦ä¹ æœ€ä½³å®è·µ

**ä¸‹ä¸€æ­¥ï¼š**
- å­¦ä¹ å¤šç¯å¢ƒé…ç½®ï¼ˆå¼€å‘/æµ‹è¯•/ç”Ÿäº§ï¼‰
- å­¦ä¹ ç”Ÿäº§çº§é…ç½®ï¼ˆèµ„æºé™åˆ¶ã€ç›‘æ§ï¼‰

---

**ç‰ˆæœ¬ï¼š** v1.0
**æœ€åæ›´æ–°ï¼š** 2026-02-12
**é¢„è®¡å­¦ä¹ æ—¶é—´ï¼š** 1-2 å°æ—¶
