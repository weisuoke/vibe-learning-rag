# åç›´è§‰ç‚¹

> **å­¦ä¹ ç›®æ ‡**: è¯†åˆ«å¹¶çº æ­£ UI ç»„ä»¶å®šåˆ¶ä¸­çš„å¸¸è§è¯¯åŒº
> **é˜…è¯»æ—¶é—´**: 30 åˆ†é’Ÿ
> **éš¾åº¦çº§åˆ«**: â­â­â­ (ä¸­çº§)

---

## æ¦‚è¿°

**åç›´è§‰ç‚¹**æ˜¯æŒ‡é‚£äº›çœ‹ä¼¼åˆç†ä½†å®é™…ä¸Šé”™è¯¯çš„ç†è§£ã€‚è¿™äº›è¯¯åŒºå¾€å¾€æºäºç›´è§‰åˆ¤æ–­æˆ–ä»å…¶ä»–é¢†åŸŸè¿ç§»çš„ç»éªŒï¼Œä½†åœ¨ UI ç»„ä»¶å®šåˆ¶çš„å…·ä½“åœºæ™¯ä¸‹å¹¶ä¸é€‚ç”¨ã€‚

### ä¸ºä»€ä¹ˆéœ€è¦å…³æ³¨åç›´è§‰ç‚¹ï¼Ÿ

**é¿å…æ€§èƒ½é™·é˜±**: é”™è¯¯çš„ä¼˜åŒ–å¯èƒ½é€‚å¾—å…¶å
**é¿å…è®¾è®¡ç¼ºé™·**: é”™è¯¯çš„å‡è®¾å¯¼è‡´ç³»ç»Ÿè®¾è®¡é—®é¢˜
**åŠ æ·±ç†è§£**: çº æ­£è¯¯åŒºèƒ½å¤ŸåŠ æ·±å¯¹æŠ€æœ¯æœ¬è´¨çš„ç†è§£

### æœ¬æ–‡å†…å®¹

æœ¬æ–‡è®¨è®º 3 ä¸ªæœ€å¸¸è§çš„åç›´è§‰ç‚¹ï¼š
1. "å·®åˆ†æ¸²æŸ“æ€»æ˜¯æ›´å¿«"
2. "Widget å¯ä»¥å®šä½åˆ°ä»»ä½•åœ°æ–¹"
3. "è‡ªå®šä¹‰ç¼–è¾‘å™¨åªéœ€è¦å®ç° render()"

---

## è¯¯åŒº 1: "å·®åˆ†æ¸²æŸ“æ€»æ˜¯æ›´å¿«"

### é”™è¯¯ç†è§£

**ç›´è§‰åˆ¤æ–­**:
- å·®åˆ†æ¸²æŸ“åªæ›´æ–°å˜åŒ–çš„éƒ¨åˆ†
- è¾“å‡ºé‡æ›´å°‘
- æ‰€ä»¥ä¸€å®šæ›´å¿«

**é”™è¯¯ç»“è®º**: åº”è¯¥æ€»æ˜¯ä½¿ç”¨å·®åˆ†æ¸²æŸ“

### ä¸ºä»€ä¹ˆè¿™æ˜¯é”™çš„

**å·®åˆ†æ¸²æŸ“æœ‰æˆæœ¬**:

```typescript
function diffRender(prevState: State, currState: State): void {
  // 1. è®¡ç®— diff (O(rows Ã— cols))
  const diff = computeDiff(prevState, currState);

  // 2. åº”ç”¨ diff (O(changed cells))
  applyDiff(diff);
}
```

**æˆæœ¬åˆ†æ**:
- **Diff è®¡ç®—**: O(rows Ã— cols) - å¿…é¡»éå†æ‰€æœ‰ cells
- **Diff åº”ç”¨**: O(changed cells) - åªè¾“å‡ºå˜åŒ–çš„ cells
- **æ€»æˆæœ¬**: O(rows Ã— cols) + O(changed cells)

**å…¨é‡æ¸²æŸ“æˆæœ¬**:
- **ç›´æ¥è¾“å‡º**: O(rows Ã— cols)
- **æ— éœ€è®¡ç®—**: æ²¡æœ‰ diff è®¡ç®—å¼€é”€

**å…³é”®æ´å¯Ÿ**: å·®åˆ†æ¸²æŸ“çš„æ€»æˆæœ¬åŒ…æ‹¬ diff è®¡ç®— + è¾“å‡ºï¼Œè€Œä¸ä»…ä»…æ˜¯è¾“å‡º

### ä¸ºä»€ä¹ˆäººä»¬ä¼šè¿™æ ·æƒ³

**æ¥æº 1: ç›´è§‰è¯¯å¯¼**
- çœ‹åˆ°"åªæ›´æ–°å˜åŒ–"å°±è®¤ä¸ºä¸€å®šæ›´å¿«
- å¿½ç•¥äº† diff è®¡ç®—çš„æˆæœ¬

**æ¥æº 2: Web å¼€å‘ç»éªŒ**
- React Virtual DOM æ€»æ˜¯æ›´å¿«
- ä½† React çš„ diff ç®—æ³•ç»è¿‡é«˜åº¦ä¼˜åŒ–
- ä¸” DOM æ“ä½œæˆæœ¬è¿œé«˜äº diff è®¡ç®—

**æ¥æº 3: ç‰‡é¢ç†è§£**
- åªå…³æ³¨è¾“å‡ºé‡
- å¿½ç•¥äº†è®¡ç®—æˆæœ¬

### æ­£ç¡®ç†è§£

**å·®åˆ†æ¸²æŸ“çš„æ€§èƒ½å–å†³äºå˜åŒ–æ¯”ä¾‹**:

```typescript
function shouldUseDiff(
  prevState: State,
  currState: State
): boolean {
  const totalCells = currState.rows * currState.cols;
  const changedCells = estimateChangedCells(prevState, currState);

  // å¦‚æœå˜åŒ–è¶…è¿‡ 20%ï¼Œå…¨é‡æ¸²æŸ“å¯èƒ½æ›´å¿«
  return changedCells < totalCells * 0.2;
}
```

**æ€§èƒ½å¯¹æ¯”**:

| å˜åŒ–æ¯”ä¾‹ | Diff è®¡ç®— | Diff è¾“å‡º | æ€»æˆæœ¬ | å…¨é‡æ¸²æŸ“ | æ›´å¿«çš„æ–¹æ¡ˆ |
|---------|----------|----------|--------|---------|----------|
| 1% | 2ms | 0.2ms | 2.2ms | 100ms | å·®åˆ†æ¸²æŸ“ |
| 10% | 2ms | 2ms | 4ms | 100ms | å·®åˆ†æ¸²æŸ“ |
| 50% | 2ms | 50ms | 52ms | 100ms | å·®åˆ†æ¸²æŸ“ |
| 90% | 2ms | 90ms | 92ms | 100ms | å·®åˆ†æ¸²æŸ“ |
| 100% | 2ms | 100ms | 102ms | 100ms | å…¨é‡æ¸²æŸ“ |

**é˜ˆå€¼åˆ†æ**:
- å˜åŒ– < 20%: å·®åˆ†æ¸²æŸ“æ˜æ˜¾æ›´å¿«
- å˜åŒ– 20-80%: å·®åˆ†æ¸²æŸ“ç•¥å¿«
- å˜åŒ– > 80%: ä¸¤è€…æ¥è¿‘ï¼Œå…¨é‡æ¸²æŸ“å¯èƒ½æ›´ç®€å•

### å®é™…åº”ç”¨

**åœºæ™¯ 1: å°æ›´æ–° (æ¨èå·®åˆ†æ¸²æŸ“)**
```typescript
// ç”¨æˆ·è¾“å…¥ä¸€ä¸ªå­—ç¬¦
// å˜åŒ–: 1-2 cells
// å·®åˆ†æ¸²æŸ“: 2ms + 0.02ms = 2.02ms
// å…¨é‡æ¸²æŸ“: 100ms
// æ€§èƒ½æå‡: 50x
```

**åœºæ™¯ 2: é¦–æ¬¡æ¸²æŸ“ (æ¨èå…¨é‡æ¸²æŸ“)**
```typescript
// åº”ç”¨å¯åŠ¨
// å˜åŒ–: 100% cells
// å·®åˆ†æ¸²æŸ“: 2ms + 100ms = 102ms
// å…¨é‡æ¸²æŸ“: 100ms
// æ€§èƒ½æå‡: -2%
```

**åœºæ™¯ 3: å®½åº¦å˜åŒ– (æ¨èå…¨é‡æ¸²æŸ“)**
```typescript
// ç»ˆç«¯çª—å£å¤§å°æ”¹å˜
// å˜åŒ–: 80-100% cells
// å·®åˆ†æ¸²æŸ“: 2ms + 90ms = 92ms
// å…¨é‡æ¸²æŸ“: 100ms
// æ€§èƒ½æå‡: 8% (ä¸æ˜æ˜¾)
```

### æ­£ç¡®çš„ç­–ç•¥

**åŠ¨æ€é€‰æ‹©**:
```typescript
class SmartRenderer {
  render(prevState: State | null, currState: State): void {
    if (!prevState) {
      // é¦–æ¬¡æ¸²æŸ“ï¼Œä½¿ç”¨å…¨é‡æ¸²æŸ“
      this.fullRender(currState);
    } else if (this.widthChanged(prevState, currState)) {
      // å®½åº¦å˜åŒ–ï¼Œä½¿ç”¨å…¨é‡æ¸²æŸ“
      this.fullRender(currState);
    } else {
      // å¸¸è§„æ›´æ–°ï¼Œä½¿ç”¨å·®åˆ†æ¸²æŸ“
      this.diffRender(prevState, currState);
    }
  }
}
```

**å…³é”®åŸåˆ™**:
- ä¸è¦ç›²ç›®ä½¿ç”¨å·®åˆ†æ¸²æŸ“
- æ ¹æ®åœºæ™¯é€‰æ‹©æœ€ä¼˜ç­–ç•¥
- æµ‹é‡å®é™…æ€§èƒ½ï¼Œä¸è¦å‡­ç›´è§‰

---

## è¯¯åŒº 2: "Widget å¯ä»¥å®šä½åˆ°ä»»ä½•åœ°æ–¹"

### é”™è¯¯ç†è§£

**ç›´è§‰åˆ¤æ–­**:
- Widget æœ‰å®šä½ç³»ç»Ÿ
- å¯ä»¥æŒ‡å®š x, y åæ ‡
- æ‰€ä»¥å¯ä»¥å®šä½åˆ°ä»»ä½•åœ°æ–¹

**é”™è¯¯ç»“è®º**: Widget å¯ä»¥åƒ Web ä¸€æ ·è‡ªç”±å®šä½

### ä¸ºä»€ä¹ˆè¿™æ˜¯é”™çš„

**ç»ˆç«¯çš„é™åˆ¶**:

```typescript
// Web: æ— é™ç”»å¸ƒ
<div style="position: absolute; top: 1000px; left: 2000px;">
  Widget
</div>
// å¯ä»¥æ»šåŠ¨æŸ¥çœ‹

// Terminal: å›ºå®šè§†å£
terminal.write(1000, 2000, 'Widget');
// è¶…å‡ºç»ˆç«¯èŒƒå›´ï¼Œä¸å¯è§
```

**æ ¸å¿ƒå·®å¼‚**:

| ç‰¹æ€§ | Web | Terminal |
|------|-----|----------|
| ç”»å¸ƒå¤§å° | æ— é™ï¼ˆå¯æ»šåŠ¨ï¼‰ | å›ºå®šï¼ˆrows Ã— colsï¼‰ |
| è¶…å‡ºå¤„ç† | æ»šåŠ¨æ¡ | ä¸å¯è§ |
| å®šä½ç²¾åº¦ | åƒç´ çº§ | å­—ç¬¦çº§ |
| å“åº”å¼ | ç™¾åˆ†æ¯”ã€vh/vw | å›ºå®šè¡Œåˆ—æ•° |

**å®é™…é—®é¢˜**:

```typescript
// å°è¯•åœ¨ (100, 50) å®šä½ Widget
// ä½†ç»ˆç«¯åªæœ‰ 80Ã—24
const widget = new TooltipWidget('Hello');
const position = { x: 100, y: 50 };

renderWidget(widget, position);
// ç»“æœ: Widget ä¸å¯è§ï¼Œå› ä¸ºè¶…å‡ºç»ˆç«¯èŒƒå›´
```

### ä¸ºä»€ä¹ˆäººä»¬ä¼šè¿™æ ·æƒ³

**æ¥æº 1: Web å¼€å‘ç»éªŒ**
- CSS å¯ä»¥è‡ªç”±å®šä½
- è¶…å‡ºéƒ¨åˆ†å¯ä»¥æ»šåŠ¨
- è¿ç§»åˆ°ç»ˆç«¯æ—¶å¿½ç•¥äº†é™åˆ¶

**æ¥æº 2: å®šä½ API çš„è¯¯å¯¼**
- çœ‹åˆ° `{ x: number, y: number }` å°±è®¤ä¸ºå¯ä»¥ä»»æ„å€¼
- å¿½ç•¥äº†ç»ˆç«¯çš„ç‰©ç†é™åˆ¶

**æ¥æº 3: ç¼ºä¹è¾¹ç•Œæ„è¯†**
- æ²¡æœ‰è€ƒè™‘ Widget å°ºå¯¸
- æ²¡æœ‰è€ƒè™‘ç»ˆç«¯å°ºå¯¸
- æ²¡æœ‰è€ƒè™‘è¾¹ç•Œæƒ…å†µ

### æ­£ç¡®ç†è§£

**ç»ˆç«¯æ˜¯å›ºå®šè§†å£**:

```typescript
interface Terminal {
  width: number;   // å›ºå®šå®½åº¦ï¼ˆå¦‚ 80ï¼‰
  height: number;  // å›ºå®šé«˜åº¦ï¼ˆå¦‚ 24ï¼‰
}

// Widget å¿…é¡»åœ¨è§†å£å†…
function isVisible(
  widget: { width: number; height: number },
  position: { x: number; y: number },
  terminal: Terminal
): boolean {
  return position.x >= 0 &&
         position.y >= 0 &&
         position.x + widget.width <= terminal.width &&
         position.y + widget.height <= terminal.height;
}
```

**è¾¹ç•Œå¤„ç†ç­–ç•¥**:

**ç­–ç•¥ 1: Clamp (é™åˆ¶åœ¨è¾¹ç•Œå†…)**
```typescript
function clampPosition(
  widget: { width: number; height: number },
  position: { x: number; y: number },
  terminal: Terminal
): { x: number; y: number } {
  return {
    x: Math.max(0, Math.min(position.x, terminal.width - widget.width)),
    y: Math.max(0, Math.min(position.y, terminal.height - widget.height))
  };
}

// ç¤ºä¾‹
const widget = { width: 10, height: 3 };
const position = { x: 100, y: 50 };  // è¶…å‡ºèŒƒå›´
const terminal = { width: 80, height: 24 };

const clamped = clampPosition(widget, position, terminal);
// ç»“æœ: { x: 70, y: 21 } - é™åˆ¶åœ¨è¾¹ç•Œå†…
```

**ç­–ç•¥ 2: Clip (è£å‰ªè¶…å‡ºéƒ¨åˆ†)**
```typescript
function clipWidget(
  widget: Component,
  position: { x: number; y: number },
  terminal: Terminal
): string {
  const content = widget.render({ width: terminal.width, height: terminal.height, focused: false });
  const lines = content.split('\n');

  // åªæ¸²æŸ“å¯è§éƒ¨åˆ†
  const visibleLines = lines.slice(
    Math.max(0, -position.y),
    Math.max(0, terminal.height - position.y)
  );

  return visibleLines.map(line => {
    if (position.x < 0) {
      line = line.slice(-position.x);
    }
    if (position.x + line.length > terminal.width) {
      line = line.slice(0, terminal.width - position.x);
    }
    return line;
  }).join('\n');
}
```

**ç­–ç•¥ 3: Reposition (æ™ºèƒ½é‡å®šä½)**
```typescript
function smartPosition(
  widget: { width: number; height: number },
  anchor: { x: number; y: number },
  terminal: Terminal
): { x: number; y: number } {
  // é»˜è®¤åœ¨é”šç‚¹ä¸‹æ–¹
  let x = anchor.x;
  let y = anchor.y + 1;

  // å¦‚æœè¶…å‡ºå³è¾¹ç•Œï¼Œå·¦å¯¹é½
  if (x + widget.width > terminal.width) {
    x = terminal.width - widget.width;
  }

  // å¦‚æœè¶…å‡ºä¸‹è¾¹ç•Œï¼Œæ˜¾ç¤ºåœ¨é”šç‚¹ä¸Šæ–¹
  if (y + widget.height > terminal.height) {
    y = anchor.y - widget.height;
  }

  // å¦‚æœè¿˜æ˜¯è¶…å‡ºï¼Œä½¿ç”¨ clamp
  return clampPosition(widget, { x, y }, terminal);
}
```

### å®é™…åº”ç”¨

**Tooltip å®šä½**:
```typescript
function positionTooltip(
  text: string,
  anchor: { x: number; y: number }
): { x: number; y: number } {
  const tooltip = new TooltipWidget(text);
  const size = tooltip.getSize()!;
  const terminal = getTerminalSize();

  // æ™ºèƒ½å®šä½
  return smartPosition(size, anchor, terminal);
}

// ä½¿ç”¨
const position = positionTooltip('Press Enter to submit', { x: 70, y: 20 });
// å¦‚æœè¶…å‡ºè¾¹ç•Œï¼Œä¼šè‡ªåŠ¨è°ƒæ•´ä½ç½®
```

**å…³é”®åŸåˆ™**:
- å§‹ç»ˆæ£€æŸ¥è¾¹ç•Œ
- æä¾›å¤šç§å¤„ç†ç­–ç•¥
- ä¼˜å…ˆä¿è¯å¯è§æ€§

---

## è¯¯åŒº 3: "è‡ªå®šä¹‰ç¼–è¾‘å™¨åªéœ€è¦å®ç° render()"

### é”™è¯¯ç†è§£

**ç›´è§‰åˆ¤æ–­**:
- ç¼–è¾‘å™¨çš„æ ¸å¿ƒæ˜¯æ˜¾ç¤ºå†…å®¹
- render() è´Ÿè´£æ˜¾ç¤º
- æ‰€ä»¥åªéœ€è¦å®ç° render()

**é”™è¯¯ç»“è®º**: å®ç° render() å°±å®Œæˆäº†ç¼–è¾‘å™¨

### ä¸ºä»€ä¹ˆè¿™æ˜¯é”™çš„

**EditorComponent æ¥å£çš„å®Œæ•´æ€§**:

```typescript
interface EditorComponent {
  // æ¸²æŸ“å±‚ (ä½ è®¤ä¸ºçš„å…¨éƒ¨)
  render(ctx: RenderContext): Component;

  // äº¤äº’å±‚ (ä½ å¿½ç•¥çš„éƒ¨åˆ†)
  handleKey(key: KeyEvent): boolean;
  handleMouse?(mouse: MouseEvent): boolean;

  // çŠ¶æ€å±‚ (ä½ å¿½ç•¥çš„éƒ¨åˆ†)
  getValue(): string;
  setValue(value: string): void;

  // ç”Ÿå‘½å‘¨æœŸ (ä½ å¿½ç•¥çš„éƒ¨åˆ†)
  mount?(): void;
  unmount?(): void;
}
```

**åªå®ç° render() çš„é—®é¢˜**:

```typescript
class BrokenEditor implements EditorComponent {
  render(ctx: RenderContext): Component {
    return Text({ content: 'Hello' });
  }

  // ç¼ºå°‘ handleKey - æ— æ³•å“åº”è¾“å…¥
  // ç¼ºå°‘ getValue - æ— æ³•è·å–å€¼
  // ç¼ºå°‘ setValue - æ— æ³•è®¾ç½®å€¼
}

// ä½¿ç”¨
const editor = new BrokenEditor();
editor.handleKey({ name: 'a', sequence: 'a', ... });
// é”™è¯¯: handleKey is not a function

const value = editor.getValue();
// é”™è¯¯: getValue is not a function
```

**å®é™…åæœ**:
- æ— æ³•å“åº”ç”¨æˆ·è¾“å…¥
- æ— æ³•è·å–ç¼–è¾‘å™¨çš„å€¼
- æ— æ³•è®¾ç½®åˆå§‹å€¼
- æ— æ³•æ¸…ç†èµ„æº

### ä¸ºä»€ä¹ˆäººä»¬ä¼šè¿™æ ·æƒ³

**æ¥æº 1: è§†è§‰å¯¼å‘æ€ç»´**
- å…³æ³¨çœ‹å¾—è§çš„éƒ¨åˆ†ï¼ˆæ¸²æŸ“ï¼‰
- å¿½ç•¥çœ‹ä¸è§çš„éƒ¨åˆ†ï¼ˆè¾“å…¥å¤„ç†ã€çŠ¶æ€ç®¡ç†ï¼‰

**æ¥æº 2: ç®€åŒ–ç†è§£**
- è®¤ä¸ºç¼–è¾‘å™¨ = æ˜¾ç¤ºæ–‡æœ¬
- å¿½ç•¥äº†ç¼–è¾‘å™¨çš„äº¤äº’æœ¬è´¨

**æ¥æº 3: ç¼ºä¹æ¥å£æ„è¯†**
- æ²¡æœ‰ç†è§£æ¥å£çš„å®Œæ•´æ€§
- è®¤ä¸ºå¯ä»¥åªå®ç°éƒ¨åˆ†æ–¹æ³•

### æ­£ç¡®ç†è§£

**ç¼–è¾‘å™¨ = æ¸²æŸ“ + äº¤äº’ + çŠ¶æ€**:

```typescript
class CompleteEditor implements EditorComponent {
  // çŠ¶æ€
  private value: string = '';
  private cursor: number = 0;

  // æ¸²æŸ“å±‚: å¦‚ä½•å±•ç¤º
  render(ctx: RenderContext): Component {
    return Text({
      content: this.value,
      cursor: ctx.focused ? this.cursor : undefined
    });
  }

  // äº¤äº’å±‚: å¦‚ä½•å“åº”
  handleKey(key: KeyEvent): boolean {
    switch (key.name) {
      case 'backspace':
        if (this.cursor > 0) {
          this.value = this.value.slice(0, this.cursor - 1) +
                       this.value.slice(this.cursor);
          this.cursor--;
        }
        return true;

      default:
        if (key.sequence && !key.ctrl && !key.meta) {
          this.value = this.value.slice(0, this.cursor) +
                       key.sequence +
                       this.value.slice(this.cursor);
          this.cursor += key.sequence.length;
          return true;
        }
        return false;
    }
  }

  // çŠ¶æ€å±‚: å¦‚ä½•ç®¡ç†
  getValue(): string {
    return this.value;
  }

  setValue(value: string): void {
    this.value = value;
    this.cursor = value.length;
  }

  // ç”Ÿå‘½å‘¨æœŸ: å¦‚ä½•åˆå§‹åŒ–/æ¸…ç†
  mount(): void {
    // åˆå§‹åŒ–èµ„æº
  }

  unmount(): void {
    // æ¸…ç†èµ„æº
  }
}
```

**æ¯ä¸ªæ–¹æ³•çš„é‡è¦æ€§**:

**render()**:
- èŒè´£: å°†çŠ¶æ€è½¬æ¢ä¸ºå¯è§†åŒ–ç»„ä»¶
- é‡è¦æ€§: â­â­â­â­â­
- ç¼ºå°‘åæœ: æ— æ³•æ˜¾ç¤º

**handleKey()**:
- èŒè´£: å¤„ç†é”®ç›˜è¾“å…¥ï¼Œæ›´æ–°çŠ¶æ€
- é‡è¦æ€§: â­â­â­â­â­
- ç¼ºå°‘åæœ: æ— æ³•ç¼–è¾‘

**getValue()**:
- èŒè´£: è·å–ç¼–è¾‘å™¨çš„å½“å‰å€¼
- é‡è¦æ€§: â­â­â­â­â­
- ç¼ºå°‘åæœ: æ— æ³•æäº¤è¡¨å•

**setValue()**:
- èŒè´£: è®¾ç½®ç¼–è¾‘å™¨çš„å€¼
- é‡è¦æ€§: â­â­â­â­
- ç¼ºå°‘åæœ: æ— æ³•è®¾ç½®åˆå§‹å€¼

**mount()/unmount()**:
- èŒè´£: åˆå§‹åŒ–å’Œæ¸…ç†èµ„æº
- é‡è¦æ€§: â­â­â­
- ç¼ºå°‘åæœ: èµ„æºæ³„æ¼

### å®é™…åº”ç”¨

**æœ€å°å¯ç”¨ç¼–è¾‘å™¨**:
```typescript
class MinimalEditor implements EditorComponent {
  private value: string = '';

  render(ctx: RenderContext): Component {
    return Text({ content: this.value });
  }

  handleKey(key: KeyEvent): boolean {
    if (key.sequence && !key.ctrl && !key.meta) {
      this.value += key.sequence;
      return true;
    }
    return false;
  }

  getValue(): string {
    return this.value;
  }

  setValue(value: string): void {
    this.value = value;
  }
}

// è¿™æ˜¯æœ€å°å¯ç”¨çš„ç¼–è¾‘å™¨
// ç¼ºå°‘å…‰æ ‡ç§»åŠ¨ã€åˆ é™¤ç­‰åŠŸèƒ½ï¼Œä½†åŸºæœ¬å¯ç”¨
```

**å®Œæ•´ç¼–è¾‘å™¨**:
```typescript
class FullEditor implements EditorComponent {
  private value: string = '';
  private cursor: number = 0;
  private history: string[] = [];

  render(ctx: RenderContext): Component {
    // å®Œæ•´çš„æ¸²æŸ“é€»è¾‘
  }

  handleKey(key: KeyEvent): boolean {
    // å®Œæ•´çš„è¾“å…¥å¤„ç†
  }

  getValue(): string {
    return this.value;
  }

  setValue(value: string): void {
    this.value = value;
    this.cursor = value.length;
  }

  mount(): void {
    // åˆå§‹åŒ–å†å²è®°å½•
    this.history = [this.value];
  }

  unmount(): void {
    // æ¸…ç†å†å²è®°å½•
    this.history = [];
  }
}
```

**å…³é”®åŸåˆ™**:
- å®ç°å®Œæ•´çš„æ¥å£
- æ¯ä¸ªæ–¹æ³•éƒ½æœ‰å…¶èŒè´£
- ä¸è¦å¿½ç•¥ä»»ä½•éƒ¨åˆ†

---

## æ€»ç»“

### ä¸‰å¤§è¯¯åŒºå›é¡¾

**è¯¯åŒº 1: "å·®åˆ†æ¸²æŸ“æ€»æ˜¯æ›´å¿«"**
- âŒ é”™è¯¯: å¿½ç•¥äº† diff è®¡ç®—æˆæœ¬
- âœ… æ­£ç¡®: æ ¹æ®å˜åŒ–æ¯”ä¾‹é€‰æ‹©ç­–ç•¥
- ğŸ’¡ æ´å¯Ÿ: æ€§èƒ½ä¼˜åŒ–éœ€è¦æƒè¡¡ï¼Œä¸æ˜¯ç»å¯¹çš„

**è¯¯åŒº 2: "Widget å¯ä»¥å®šä½åˆ°ä»»ä½•åœ°æ–¹"**
- âŒ é”™è¯¯: å¿½ç•¥äº†ç»ˆç«¯çš„å›ºå®šè§†å£é™åˆ¶
- âœ… æ­£ç¡®: å¿…é¡»å¤„ç†è¾¹ç•Œæƒ…å†µ
- ğŸ’¡ æ´å¯Ÿ: ç»ˆç«¯ â‰  Webï¼Œä¸èƒ½ç›´æ¥è¿ç§»ç»éªŒ

**è¯¯åŒº 3: "è‡ªå®šä¹‰ç¼–è¾‘å™¨åªéœ€è¦å®ç° render()"**
- âŒ é”™è¯¯: å¿½ç•¥äº†äº¤äº’å’ŒçŠ¶æ€ç®¡ç†
- âœ… æ­£ç¡®: å®ç°å®Œæ•´çš„æ¥å£
- ğŸ’¡ æ´å¯Ÿ: ç¼–è¾‘å™¨ = æ¸²æŸ“ + äº¤äº’ + çŠ¶æ€

### å¦‚ä½•é¿å…è¿™äº›è¯¯åŒº

**1. ä¸è¦å‡­ç›´è§‰åˆ¤æ–­**
- æµ‹é‡å®é™…æ€§èƒ½
- ç†è§£æŠ€æœ¯æœ¬è´¨
- è€ƒè™‘æ‰€æœ‰å› ç´ 

**2. ä¸è¦ç›²ç›®è¿ç§»ç»éªŒ**
- ç†è§£ä¸åŒç¯å¢ƒçš„é™åˆ¶
- ä¸è¦å‡è®¾æ‰€æœ‰å¹³å°éƒ½ä¸€æ ·
- éªŒè¯å‡è®¾

**3. ä¸è¦ç®€åŒ–ç†è§£**
- ç†è§£å®Œæ•´çš„æ¥å£
- è€ƒè™‘æ‰€æœ‰èŒè´£
- ä¸è¦å¿½ç•¥ç»†èŠ‚

### æ·±å…¥å­¦ä¹ 

**å¦‚æœæƒ³æ·±å…¥ç†è§£æ€§èƒ½æƒè¡¡**:
- é˜…è¯» **07_å®æˆ˜ä»£ç _05_æ€§èƒ½ä¼˜åŒ–å®æˆ˜.md**
- å®é™…æµ‹é‡ä¸åŒç­–ç•¥çš„æ€§èƒ½

**å¦‚æœæƒ³æ·±å…¥ç†è§£è¾¹ç•Œå¤„ç†**:
- é˜…è¯» **03_æ ¸å¿ƒæ¦‚å¿µ_03_Widgetç³»ç»Ÿ.md**
- å®ç°å®Œæ•´çš„è¾¹ç•Œå¤„ç†é€»è¾‘

**å¦‚æœæƒ³æ·±å…¥ç†è§£ç¼–è¾‘å™¨æ¶æ„**:
- é˜…è¯» **03_æ ¸å¿ƒæ¦‚å¿µ_02_è‡ªå®šä¹‰ç¼–è¾‘å™¨.md**
- å®ç°å®Œæ•´çš„ç¼–è¾‘å™¨

---

**è®°ä½**: åç›´è§‰ç‚¹å¾€å¾€æ˜¯æ·±å…¥ç†è§£çš„èµ·ç‚¹ã€‚çº æ­£è¿™äº›è¯¯åŒºï¼Œä½ çš„ç†è§£ä¼šæ›´åŠ æ·±åˆ»ï¼

---

**ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2026-02-21
**ç»´æŠ¤è€…**: Claude Code
