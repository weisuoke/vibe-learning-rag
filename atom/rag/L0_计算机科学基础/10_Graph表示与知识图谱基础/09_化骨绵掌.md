# 化骨绵掌

> 10个2分钟知识卡片 - 快速掌握Graph和知识图谱核心要点

---

## 卡片1：Graph的本质

**一句话：** Graph = 节点(Vertex) + 边(Edge)，用于表示实体之间的关系网络。

**举例：**
```python
# 最简单的Graph
graph = {
    "A": ["B", "C"],  # A连接到B和C
    "B": ["C"],       # B连接到C
    "C": []           # C无出边
}
```

**应用：** 知识图谱、社交网络、推荐系统、路径规划

---

## 卡片2：邻接表 vs 邻接矩阵

**一句话：** 邻接表省空间适合稀疏图，邻接矩阵查询快适合密集图。

**对比：**
| 特性 | 邻接表 | 邻接矩阵 |
|------|--------|----------|
| 空间 | O(V+E) | O(V²) |
| 查询边 | O(degree) | O(1) |
| 获取邻居 | O(1) | O(V) |
| 适用 | 稀疏图 | 密集图 |

**应用：** 99%的实际应用（知识图谱、社交网络）都应该使用邻接表

---

## 卡片3：有向图 vs 无向图

**一句话：** 有向图的边有方向(A→B ≠ B→A)，无向图的边无方向(A-B = B-A)。

**举例：**
```python
# 有向图：知识图谱
kg = {"张三": ["阿里巴巴"]}  # 张三→阿里巴巴（工作于）

# 无向图：社交网络
social = {
    "Alice": ["Bob"],
    "Bob": ["Alice"]  # 朋友关系对称
}
```

**应用：** 知识图谱用有向图，社交网络用无向图

---

## 卡片4：知识图谱三元组(SPO)

**一句话：** 三元组(Subject, Predicate, Object)是知识图谱的基本存储单元。

**举例：**
```python
# 三元组
("张三", "工作于", "阿里巴巴")
("阿里巴巴", "位于", "杭州")
("马云", "创立", "阿里巴巴")

# 可以回答：
# Q: 张三在哪工作？ → 阿里巴巴
# Q: 阿里巴巴在哪？ → 杭州
```

**应用：** RAG系统的结构化知识存储、多跳推理

---

## 卡片5：实体关系提取

**一句话：** 从非结构化文本中识别实体并提取关系，是构建知识图谱的关键步骤。

**方法：**
```python
# 方法1：LLM提取（推荐）
text = "张三在阿里巴巴工作"
triples = llm.extract(text)
# [("张三", "工作于", "阿里巴巴")]

# 方法2：规则提取（快速但不准确）
# 方法3：混合方法（生产环境推荐）
```

**应用：** 自动构建知识图谱、文档到图的转换

---

## 卡片6：GraphRAG架构

**一句话：** GraphRAG = 实体关系提取 + 知识图谱构建 + 社区检测 + 混合检索 + 生成答案。

**核心流程：**
```
文档 → 提取三元组 → 构建图谱 → 社区检测 →
生成摘要 → 混合检索 → 生成答案
```

**性能提升（2026年数据）：**
- 搜索精度：70% → 99%
- 准确率：提升3.4倍
- 幻觉率：显著降低

**应用：** 复杂问答、多跳推理、知识发现

---

## 卡片7：三种检索策略

**一句话：** 局部检索精确、全局检索宏观、混合检索平衡。

**对比：**
```python
# 局部检索：基于实体邻居
local = ["张三 工作于 阿里巴巴"]

# 全局检索：基于社区摘要
global_ctx = ["社区主题：互联网公司"]

# 混合检索：组合三种方式
hybrid = local + global_ctx + vector
```

**应用：** 简单问答用局部，开放问题用全局，复杂问题用混合

---

## 卡片8：社区检测

**一句话：** 将图划分为语义相关的社区，为每个社区生成摘要，支持全局检索。

**算法：**
```python
# Louvain算法（常用）
communities = louvain(graph)

# Leiden算法（更好）
communities = leiden(graph)

# 为每个社区生成摘要
for comm in communities:
    summary = llm.summarize(comm)
```

**应用：** GraphRAG的核心创新，提供宏观主题理解

---

## 卡片9：多跳推理

**一句话：** 通过图遍历发现实体之间的多跳关系，支持复杂问答。

**示例：**
```python
# 问题：张三的老板的出生地？
# 推理链：
张三 → 工作于 → 阿里巴巴 → 创始人 → 马云 → 出生于 → 杭州

# BFS找最短路径
path = bfs(kg, "张三", "杭州")
# ["张三", "阿里巴巴", "杭州"]
```

**应用：** 复杂问答、关系发现、推理链可视化

---

## 卡片10：图神经网络(GNN)

**一句话：** GNN通过邻居聚合学习节点表示，用于节点分类、链接预测等任务。

**核心思想：**
```python
# 消息传递
for layer in gnn:
    # 1. 聚合邻居特征
    neighbor_features = aggregate(node.neighbors)

    # 2. 更新节点特征
    node.features = update(node.features, neighbor_features)
```

**应用：** 实体类型预测、关系推理、知识图谱补全

---

## 快速参考表

### 核心概念速查

| 概念 | 定义 | 时间复杂度 | 应用场景 |
|------|------|-----------|----------|
| **邻接表** | 字典存储邻居 | 空间O(V+E) | 稀疏图（推荐） |
| **邻接矩阵** | 二维数组 | 空间O(V²) | 密集图 |
| **有向图** | 边有方向 | - | 知识图谱 |
| **无向图** | 边无方向 | - | 社交网络 |
| **三元组** | (S, P, O) | - | 知识存储 |
| **GraphRAG** | 图检索+生成 | - | 复杂问答 |
| **局部检索** | 实体邻居 | O(degree) | 精确查询 |
| **全局检索** | 社区摘要 | O(1) | 主题查询 |
| **多跳推理** | 图遍历 | O(V+E) | 关系发现 |
| **GNN** | 邻居聚合 | O(E) | 节点分类 |

### 选择决策树

```
需要表示关系网络？
  ├─ 是 → 使用Graph
  │   ├─ 稀疏图（边数<V²/2）？
  │   │   ├─ 是 → 邻接表 ⭐
  │   │   └─ 否 → 邻接矩阵
  │   ├─ 关系有方向？
  │   │   ├─ 是 → 有向图（知识图谱）
  │   │   └─ 否 → 无向图（社交网络）
  │   └─ 需要RAG？
  │       ├─ 简单问答 → 传统RAG
  │       └─ 复杂问答 → GraphRAG ⭐
  └─ 否 → 使用其他数据结构
```

### 2026年技术栈

| 用途 | 推荐工具 | 说明 |
|------|----------|------|
| **图操作** | NetworkX | Python原生，快速原型 |
| **图数据库** | Neo4j | 生产级，性能优秀 |
| **GraphRAG** | Microsoft GraphRAG | 官方实现 |
| **实体提取** | OpenAI GPT-4 | LLM提取 |
| **GNN** | PyTorch Geometric | 图神经网络 |
| **可视化** | Matplotlib + NetworkX | 图谱可视化 |

### 性能对比（2026年数据）

| 指标 | 传统RAG | GraphRAG | 提升 |
|------|---------|----------|------|
| **搜索精度** | 70% | 99% | +41% |
| **准确率** | 30% | 102% | 3.4倍 |
| **幻觉率** | 高 | 低 | 显著 |
| **可解释性** | 低 | 高 | 显著 |

---

## 学习路径建议

### 第1天：基础概念
- 卡片1-3：Graph基础、邻接表/矩阵、有向/无向图
- 实战：手写Graph类

### 第2天：知识图谱
- 卡片4-5：三元组、实体关系提取
- 实战：使用NetworkX构建知识图谱

### 第3天：GraphRAG
- 卡片6-8：GraphRAG架构、检索策略、社区检测
- 实战：实现简化版GraphRAG

### 第4天：高级应用
- 卡片9-10：多跳推理、GNN
- 实战：使用PyTorch Geometric

---

## 记忆口诀

**Graph三要素：**
- 节点存实体
- 边存关系
- 方向看场景

**选择邻接表：**
- 稀疏图首选
- 空间省一半
- 实际应用多

**GraphRAG流程：**
- 提取三元组
- 构建知识图谱
- 检测社区
- 生成摘要
- 混合检索
- 生成答案

**三种检索：**
- 局部精确
- 全局宏观
- 混合平衡

---

## 常见误区提醒

### ❌ 误区1：邻接矩阵总是更快
**正确**：只在查询边时O(1)，获取邻居需要O(V)，稀疏图反而更慢

### ❌ 误区2：知识图谱就是简单的三元组存储
**正确**：需要Schema设计、索引优化、推理规则、查询优化

### ❌ 误区3：GraphRAG只是向量检索+图检索
**正确**：需要实体提取、社区检测、摘要生成、混合检索策略

---

## 实战检查清单

### 基础能力
- [ ] 能手写邻接表Graph类
- [ ] 理解邻接表和邻接矩阵的权衡
- [ ] 能区分有向图和无向图的应用

### 知识图谱
- [ ] 能使用NetworkX构建知识图谱
- [ ] 理解三元组(SPO)结构
- [ ] 能使用LLM提取实体关系

### GraphRAG
- [ ] 理解GraphRAG的完整管道
- [ ] 能实现局部/全局/混合检索
- [ ] 理解社区检测的作用

### 高级应用
- [ ] 能实现多跳推理
- [ ] 理解GNN的基本原理
- [ ] 能使用PyTorch Geometric

---

**记住：** 这10个卡片涵盖了Graph和知识图谱的核心要点，每天复习一遍，一周内就能掌握！
