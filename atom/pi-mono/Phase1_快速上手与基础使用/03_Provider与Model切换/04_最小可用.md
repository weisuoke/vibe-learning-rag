# 最小可用

> **20% 核心知识解决 80% 问题**

---

## 核心知识（必学）

### 1. 三个基本概念

**Provider**：LLM 服务提供商（如 Anthropic、OpenAI）

**Model**：具体的模型（如 claude-3-5-sonnet-20241022）

**Scoped Models**：预配置的 3-5 个常用模型

### 2. 三种切换方法

| 方法 | 快捷键/命令 | 使用场景 |
|------|-------------|----------|
| **Scoped Models** | `Ctrl+P` | 日常开发（最常用） |
| **交互式命令** | `/model` | 临时切换 |
| **CLI 参数** | `--model` | 脚本自动化 |

### 3. 三个配置文件

```bash
~/.pi/agent/
├── models.json      # 模型定义
├── auth.json        # API 密钥
└── settings.json    # 用户设置
```

---

## 快速上手（10 分钟）

### 步骤 1：配置 API 密钥（2 分钟）

```bash
# 创建认证文件
mkdir -p ~/.pi/agent

cat > ~/.pi/agent/auth.json <<EOF
{
  "anthropic": {
    "apiKey": "sk-ant-api03-YOUR_KEY_HERE"
  }
}
EOF

# 设置权限
chmod 600 ~/.pi/agent/auth.json
```

### 步骤 2：配置 Scoped Models（3 分钟）

```bash
cat > ~/.pi/agent/settings.json <<EOF
{
  "defaultModel": "claude-3-5-haiku-20241022",
  "scopedModels": [
    "claude-3-5-haiku-20241022",
    "claude-3-5-sonnet-20241022",
    "claude-opus-4-20250514"
  ]
}
EOF
```

### 步骤 3：测试切换（5 分钟）

```bash
# 启动 Pi
pi

# 测试默认模型
> Hello

# 按 Ctrl+P 切换到 Sonnet
# 再次测试
> Hello

# 查看当前模型
> /session
```

---

## 日常使用（80% 场景）

### 场景 1：简单任务用 Haiku

```bash
pi  # 默认使用 Haiku

> Format this JSON
> Fix this typo
> Add comments to this function
```

### 场景 2：复杂任务切换到 Sonnet

```bash
# 按 Ctrl+P 切换
> Refactor this component
> Design this API
> Optimize this algorithm
```

### 场景 3：极端复杂任务用 Opus

```bash
# 按 Ctrl+P 两次切换
> Design the entire system architecture
> Solve this complex algorithm problem
```

---

## 成本优化（核心策略）

### 模型选择原则

```
简单任务 → Haiku ($0.8/MTok)
中等任务 → Sonnet ($3/MTok)
复杂任务 → Opus ($15/MTok)
```

### 成本对比

```typescript
// 每天 100 次交互

// 全部用 Opus：$15/天 = $450/月
// 智能选择：$1.84/天 = $55/月
// 节省：88%
```

---

## 常用命令（5 个）

```bash
# 1. 选择模型
> /model

# 2. 查看会话信息
> /session

# 3. 重载配置
> /reload

# 4. 配置 Scoped Models
> /scoped-models

# 5. 帮助
> /help
```

---

## 配置模板（复制即用）

### 最小配置

```json
// ~/.pi/agent/auth.json
{
  "anthropic": {
    "apiKey": "YOUR_KEY"
  }
}

// ~/.pi/agent/settings.json
{
  "defaultModel": "claude-3-5-haiku-20241022",
  "scopedModels": [
    "claude-3-5-haiku-20241022",
    "claude-3-5-sonnet-20241022"
  ]
}
```

### 推荐配置

```json
// ~/.pi/agent/settings.json
{
  "defaultModel": "claude-3-5-haiku-20241022",
  "scopedModels": [
    "claude-3-5-haiku-20241022",
    "claude-3-5-sonnet-20241022",
    "claude-opus-4-20250514"
  ],
  "maxTokens": 4096
}
```

---

## 故障排查（3 个常见问题）

### 问题 1：API Key 无效

```bash
# 检查文件权限
ls -la ~/.pi/agent/auth.json
# 应该显示：-rw------- (600)

# 重新设置权限
chmod 600 ~/.pi/agent/auth.json
```

### 问题 2：模型不可用

```bash
# 重载配置
> /reload

# 查看可用模型
> /model
```

### 问题 3：Ctrl+P 不工作

```bash
# 检查 Scoped Models 配置
cat ~/.pi/agent/settings.json

# 确保 scopedModels 数组不为空
```

---

## 学习路径

### 现在就能用（10 分钟）

1. 配置 API 密钥
2. 配置 Scoped Models
3. 学会 Ctrl+P 切换

### 进阶学习（1 小时）

1. 阅读 [03_核心概念_01_Provider定义与配置.md](./03_核心概念_01_Provider定义与配置.md)
2. 阅读 [03_核心概念_03_Scoped_Models快速切换.md](./03_核心概念_03_Scoped_Models快速切换.md)
3. 阅读 [07_实战代码_01_基础Provider配置.md](./07_实战代码_01_基础Provider配置.md)

### 深入掌握（3 小时）

阅读完整的 22 个文件

---

## 记忆卡片

### 卡片 1：三个概念

```
Provider = 服务商（Anthropic、OpenAI）
Model = 具体模型（Sonnet、Haiku）
Scoped Models = 常用模型列表（3-5 个）
```

### 卡片 2：三种切换

```
Ctrl+P = 快速切换（日常）
/model = 交互选择（临时）
--model = CLI 参数（脚本）
```

### 卡片 3：成本优化

```
Haiku = $0.8/MTok（简单任务）
Sonnet = $3/MTok（中等任务）
Opus = $15/MTok（复杂任务）
```

---

## 下一步

**如果你想**：
- 深入理解原理 → 阅读 [02_第一性原理.md](./02_第一性原理.md)
- 学习所有概念 → 阅读 6 个核心概念文件
- 实战演练 → 阅读 6 个实战代码文件
- 快速查询 → 阅读 [09_化骨绵掌.md](./09_化骨绵掌.md)

---

**记住**：掌握这 20% 的核心知识，你就能解决 80% 的日常问题。
