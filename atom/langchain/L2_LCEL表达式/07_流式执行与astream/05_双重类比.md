# åŒé‡ç±»æ¯”

## ç±»æ¯”è¯´æ˜

æœ¬æ–‡æ¡£é€šè¿‡**å‰ç«¯å¼€å‘ç±»æ¯”**å’Œ**æ—¥å¸¸ç”Ÿæ´»ç±»æ¯”**å¸®åŠ©ç†è§£æµå¼æ‰§è¡Œçš„æ ¸å¿ƒæ¦‚å¿µã€‚

---

## æ ¸å¿ƒæ¦‚å¿µç±»æ¯”

### æµå¼æ‰§è¡Œ (Streaming)

#### å‰ç«¯ç±»æ¯”ï¼šServer-Sent Events (SSE)

```javascript
// å‰ç«¯ï¼šSSE å®æ—¶æ¥æ”¶æœåŠ¡å™¨æ¨é€
const eventSource = new EventSource('/api/stream');

eventSource.onmessage = (event) => {
    // é€æ­¥æ¥æ”¶æ•°æ®
    console.log('æ”¶åˆ°æ•°æ®:', event.data);
    updateUI(event.data);  // ç«‹å³æ›´æ–°ç•Œé¢
};

// vs ä¼ ç»Ÿ HTTP è¯·æ±‚
fetch('/api/data')
    .then(res => res.json())
    .then(data => {
        // ç­‰å¾…å…¨éƒ¨æ•°æ®åæ‰æ›´æ–°
        updateUI(data);
    });
```

**å¯¹åº” LangChain**ï¼š
```python
# æµå¼æ‰§è¡Œ
async for chunk in chain.astream(input):
    print(chunk.content, end="")  # é€æ­¥è¾“å‡º

# vs ä¼ ç»Ÿè°ƒç”¨
result = chain.invoke(input)
print(result.content)  # ä¸€æ¬¡æ€§è¾“å‡º
```

---

#### æ—¥å¸¸ç”Ÿæ´»ç±»æ¯”ï¼šçœ‹ç›´æ’­ vs çœ‹å½•æ’­

| ç‰¹æ€§ | ç›´æ’­ï¼ˆæµå¼ï¼‰ | å½•æ’­ï¼ˆæ‰¹é‡ï¼‰ |
|------|-------------|-------------|
| **è§‚çœ‹ä½“éªŒ** | å®æ—¶çœ‹åˆ°å†…å®¹ | ç­‰å¾…ä¸‹è½½å®Œæˆ |
| **äº’åŠ¨æ€§** | å¯ä»¥å®æ—¶äº’åŠ¨ | æ— æ³•å®æ—¶äº’åŠ¨ |
| **ç­‰å¾…æ—¶é—´** | ç«‹å³å¼€å§‹ | éœ€è¦ç­‰å¾… |
| **æ€»æ—¶é•¿** | ç›¸åŒ | ç›¸åŒ |

**å…³é”®æ´å¯Ÿ**ï¼šæµå¼ä¸æ˜¯"æ›´å¿«"ï¼Œè€Œæ˜¯"æ„Ÿè§‰æ›´å¿«" - ç”¨æˆ·ç«‹å³çœ‹åˆ°è¾“å‡ºå¼€å§‹ã€‚

---

### `stream_mode="updates"` - Agent è¿›åº¦æµå¼

#### å‰ç«¯ç±»æ¯”ï¼šReact DevTools ç»„ä»¶æ ‘æ›´æ–°

```javascript
// React DevTools æ˜¾ç¤ºç»„ä»¶æ›´æ–°è¿‡ç¨‹
<App>
  <Header />          // âœ… å·²æ¸²æŸ“
  <Content>           // ğŸ”„ æ­£åœ¨æ¸²æŸ“
    <Article />       // â³ ç­‰å¾…æ¸²æŸ“
    <Comments />      // â³ ç­‰å¾…æ¸²æŸ“
  </Content>
  <Footer />          // â³ ç­‰å¾…æ¸²æŸ“
</App>

// æ¯ä¸ªç»„ä»¶æ¸²æŸ“å®Œæˆåï¼ŒDevTools å®æ—¶æ›´æ–°
```

**å¯¹åº” LangChain**ï¼š
```python
# Agent æ‰§è¡Œæµç¨‹
for chunk in agent.stream(input, stream_mode="updates"):
    for node_name, data in chunk.items():
        print(f"[{node_name}] æ‰§è¡Œå®Œæˆ")

# è¾“å‡ºï¼š
# [model] æ‰§è¡Œå®Œæˆ      - LLM ç”Ÿæˆå·¥å…·è°ƒç”¨
# [tools] æ‰§è¡Œå®Œæˆ      - å·¥å…·æ‰§è¡Œ
# [model] æ‰§è¡Œå®Œæˆ      - LLM ç”Ÿæˆæœ€ç»ˆå“åº”
```

---

#### æ—¥å¸¸ç”Ÿæ´»ç±»æ¯”ï¼šå¤–å–é…é€è¿›åº¦

```
è®¢å•çŠ¶æ€æ›´æ–°ï¼š
1. [å•†å®¶æ¥å•] âœ… å·²å®Œæˆ
2. [å•†å®¶å¤‡é¤] âœ… å·²å®Œæˆ
3. [éª‘æ‰‹å–é¤] ğŸ”„ è¿›è¡Œä¸­
4. [é…é€ä¸­] â³ ç­‰å¾…
5. [å·²é€è¾¾] â³ ç­‰å¾…
```

**å…³é”®æ´å¯Ÿ**ï¼š`updates` æ¨¡å¼è®©ä½ çœ‹åˆ° Agent çš„æ¯ä¸€æ­¥æ‰§è¡Œè¿›åº¦ï¼Œå°±åƒå¤–å– App æ˜¾ç¤ºé…é€çŠ¶æ€ã€‚

---

### `stream_mode="messages"` - LLM ä»¤ç‰Œæµå¼

#### å‰ç«¯ç±»æ¯”ï¼šæ‰“å­—æœºæ•ˆæœ (Typewriter Effect)

```javascript
// å‰ç«¯æ‰“å­—æœºæ•ˆæœ
const text = "Hello, World!";
let index = 0;

const typeWriter = setInterval(() => {
    if (index < text.length) {
        document.getElementById("output").innerHTML += text.charAt(index);
        index++;
    } else {
        clearInterval(typeWriter);
    }
}, 100);  // æ¯ 100ms è¾“å‡ºä¸€ä¸ªå­—ç¬¦
```

**å¯¹åº” LangChain**ï¼š
```python
# LLM ä»¤ç‰Œæµå¼
async for token, metadata in agent.stream(input, stream_mode="messages"):
    print(token.content, end="", flush=True)

# è¾“å‡ºæ•ˆæœï¼š
# H e l l o ,   W o r l d !
# (é€å­—è¾“å‡º)
```

---

#### æ—¥å¸¸ç”Ÿæ´»ç±»æ¯”ï¼šè¯­éŸ³è½¬æ–‡å­—å®æ—¶æ˜¾ç¤º

```
ç”¨æˆ·è¯´è¯ï¼š
"ä»Šå¤©å¤©æ°”çœŸä¸é”™"

å®æ—¶è½¬æ–‡å­—ï¼š
ä»Š â†’ ä»Šå¤© â†’ ä»Šå¤©å¤© â†’ ä»Šå¤©å¤©æ°” â†’ ä»Šå¤©å¤©æ°”çœŸ â†’ ä»Šå¤©å¤©æ°”çœŸä¸ â†’ ä»Šå¤©å¤©æ°”çœŸä¸é”™
```

**å…³é”®æ´å¯Ÿ**ï¼š`messages` æ¨¡å¼è®©ç”¨æˆ·çœ‹åˆ° LLM çš„"æ€è€ƒè¿‡ç¨‹"ï¼Œå°±åƒè¯­éŸ³è½¬æ–‡å­—çš„å®æ—¶æ˜¾ç¤ºã€‚

---

### `stream_mode="custom"` - è‡ªå®šä¹‰æ•°æ®æµå¼

#### å‰ç«¯ç±»æ¯”ï¼šæ–‡ä»¶ä¸Šä¼ è¿›åº¦æ¡

```javascript
// å‰ç«¯æ–‡ä»¶ä¸Šä¼ è¿›åº¦
const xhr = new XMLHttpRequest();

xhr.upload.addEventListener('progress', (event) => {
    if (event.lengthComputable) {
        const percentComplete = (event.loaded / event.total) * 100;
        updateProgressBar(percentComplete);  // æ›´æ–°è¿›åº¦æ¡
        console.log(`ä¸Šä¼ è¿›åº¦: ${percentComplete}%`);
    }
});

xhr.open('POST', '/upload');
xhr.send(formData);
```

**å¯¹åº” LangChain**ï¼š
```python
from langgraph.config import get_stream_writer

def process_files(files: list) -> str:
    writer = get_stream_writer()

    for i, file in enumerate(files):
        progress = (i + 1) / len(files) * 100
        writer(f"å¤„ç†è¿›åº¦: {progress:.1f}%")
        # å¤„ç†æ–‡ä»¶

    return "å®Œæˆ"

# æµå¼è¾“å‡ºè‡ªå®šä¹‰è¿›åº¦
for chunk in agent.stream(input, stream_mode="custom"):
    print(chunk)  # è¾“å‡º: "å¤„ç†è¿›åº¦: 33.3%", "å¤„ç†è¿›åº¦: 66.7%", ...
```

---

#### æ—¥å¸¸ç”Ÿæ´»ç±»æ¯”ï¼šæ´—è¡£æœºçŠ¶æ€æ˜¾ç¤º

```
æ´—è¡£æœºæ˜¾ç¤ºå±ï¼š
1. "æ³¨æ°´ä¸­..." (5 åˆ†é’Ÿ)
2. "æ´—æ¶¤ä¸­..." (15 åˆ†é’Ÿ)
3. "æ¼‚æ´—ä¸­..." (10 åˆ†é’Ÿ)
4. "è„±æ°´ä¸­..." (5 åˆ†é’Ÿ)
5. "æ´—æ¶¤å®Œæˆ"
```

**å…³é”®æ´å¯Ÿ**ï¼š`custom` æ¨¡å¼è®©ä½ å‘é€ä»»æ„è‡ªå®šä¹‰ä¿¡æ¯ï¼Œå°±åƒæ´—è¡£æœºæ˜¾ç¤ºå½“å‰çŠ¶æ€ã€‚

---

## å¤šæ¨¡å¼ç»„åˆç±»æ¯”

### å‰ç«¯ç±»æ¯”ï¼šChrome DevTools Network + Console

```javascript
// Network é¢æ¿ï¼šæ˜¾ç¤ºè¯·æ±‚è¿›åº¦
fetch('/api/data')
    .then(res => {
        console.log('è¯·æ±‚å®Œæˆ');  // Console è¾“å‡º
        return res.json();
    })
    .then(data => {
        console.log('æ•°æ®è§£æå®Œæˆ');  // Console è¾“å‡º
        updateUI(data);
    });

// åŒæ—¶çœ‹åˆ°ï¼š
// - Network é¢æ¿ï¼šè¯·æ±‚çŠ¶æ€ï¼ˆç±»ä¼¼ updatesï¼‰
// - Console é¢æ¿ï¼šæ—¥å¿—è¾“å‡ºï¼ˆç±»ä¼¼ customï¼‰
// - Preview é¢æ¿ï¼šå“åº”å†…å®¹ï¼ˆç±»ä¼¼ messagesï¼‰
```

**å¯¹åº” LangChain**ï¼š
```python
# å¤šæ¨¡å¼ç»„åˆ
for mode, data in agent.stream(
    input,
    stream_mode=["updates", "messages", "custom"]
):
    if mode == "updates":
        print(f"[æ­¥éª¤] {list(data.keys())}")  # ç±»ä¼¼ Network é¢æ¿
    elif mode == "messages":
        token, metadata = data
        print(token.content, end="")  # ç±»ä¼¼ Preview é¢æ¿
    elif mode == "custom":
        print(f"[æ—¥å¿—] {data}")  # ç±»ä¼¼ Console é¢æ¿
```

---

### æ—¥å¸¸ç”Ÿæ´»ç±»æ¯”ï¼šé¤å…ç‚¹é¤ç³»ç»Ÿ

```
é¡¾å®¢è§†è§’ï¼ˆå¤šç§ä¿¡æ¯åŒæ—¶æ˜¾ç¤ºï¼‰ï¼š
1. è®¢å•çŠ¶æ€ï¼š[å·²ä¸‹å•] â†’ [åˆ¶ä½œä¸­] â†’ [å·²å®Œæˆ]  (updates)
2. å¨æˆ¿åŠ¨æ€ï¼š"æ­£åœ¨åˆ‡èœ..." â†’ "æ­£åœ¨ç‚’èœ..." â†’ "æ­£åœ¨è£…ç›˜..."  (custom)
3. èœå“å±•ç¤ºï¼šå®æ—¶çœ‹åˆ°èœå“åˆ¶ä½œè¿‡ç¨‹  (messages)
```

**å…³é”®æ´å¯Ÿ**ï¼šå¤šæ¨¡å¼ç»„åˆè®©ä½ åŒæ—¶çœ‹åˆ°å¤šç§ä¿¡æ¯ï¼Œå°±åƒé¤å…çš„ç»¼åˆæ˜¾ç¤ºç³»ç»Ÿã€‚

---

## æ€§èƒ½ä¼˜åŒ–ç±»æ¯”

### å¼‚æ­¥ vs åŒæ­¥

#### å‰ç«¯ç±»æ¯”ï¼šasync/await vs åŒæ­¥é˜»å¡

```javascript
// åŒæ­¥é˜»å¡ï¼ˆä¸æ¨èï¼‰
function fetchDataSync() {
    const data1 = fetchSync('/api/data1');  // é˜»å¡ 2 ç§’
    const data2 = fetchSync('/api/data2');  // é˜»å¡ 2 ç§’
    return [data1, data2];  // æ€»å…± 4 ç§’
}

// å¼‚æ­¥å¹¶å‘ï¼ˆæ¨èï¼‰
async function fetchDataAsync() {
    const [data1, data2] = await Promise.all([
        fetch('/api/data1'),  // å¹¶å‘æ‰§è¡Œ
        fetch('/api/data2')   // å¹¶å‘æ‰§è¡Œ
    ]);
    return [data1, data2];  // æ€»å…± 2 ç§’
}
```

**å¯¹åº” LangChain**ï¼š
```python
# åŒæ­¥æµå¼ï¼ˆé˜»å¡ï¼‰
for chunk in chain.stream(input):
    process(chunk)  # é˜»å¡ä¸»çº¿ç¨‹

# å¼‚æ­¥æµå¼ï¼ˆéé˜»å¡ï¼‰
async for chunk in chain.astream(input):
    await process(chunk)  # ä¸é˜»å¡ä¸»çº¿ç¨‹
```

---

#### æ—¥å¸¸ç”Ÿæ´»ç±»æ¯”ï¼šå•çª—å£ vs å¤šçª—å£é“¶è¡Œ

| ç‰¹æ€§ | å•çª—å£ï¼ˆåŒæ­¥ï¼‰ | å¤šçª—å£ï¼ˆå¼‚æ­¥ï¼‰ |
|------|---------------|---------------|
| **å¤„ç†æ–¹å¼** | ä¸€ä¸ªä¸€ä¸ªæ’é˜Ÿ | å¤šä¸ªåŒæ—¶å¤„ç† |
| **ç­‰å¾…æ—¶é—´** | é•¿ | çŸ­ |
| **æ•ˆç‡** | ä½ | é«˜ |

**å…³é”®æ´å¯Ÿ**ï¼šå¼‚æ­¥æµå¼å°±åƒå¤šçª—å£é“¶è¡Œï¼Œå¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡ã€‚

---

## æµå¼ vs æ‰¹é‡ç±»æ¯”

### å‰ç«¯ç±»æ¯”ï¼šæ‡’åŠ è½½ vs å…¨é‡åŠ è½½

```javascript
// å…¨é‡åŠ è½½ï¼ˆæ‰¹é‡ï¼‰
const allImages = await fetch('/api/images?limit=1000');
allImages.forEach(img => renderImage(img));  // ç­‰å¾…å…¨éƒ¨åŠ è½½

// æ‡’åŠ è½½ï¼ˆæµå¼ï¼‰
const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            loadImage(entry.target);  // é€æ­¥åŠ è½½
        }
    });
});
```

**å¯¹åº” LangChain**ï¼š
```python
# æ‰¹é‡è°ƒç”¨
results = chain.batch([input1, input2, input3])  # ç­‰å¾…å…¨éƒ¨å®Œæˆ

# æµå¼è°ƒç”¨
for input_data in [input1, input2, input3]:
    async for chunk in chain.astream(input_data):
        print(chunk.content, end="")  # é€æ­¥è¾“å‡º
```

---

### æ—¥å¸¸ç”Ÿæ´»ç±»æ¯”ï¼šè‡ªåŠ©é¤ vs ç‚¹é¤

| ç‰¹æ€§ | è‡ªåŠ©é¤ï¼ˆæ‰¹é‡ï¼‰ | ç‚¹é¤ï¼ˆæµå¼ï¼‰ |
|------|---------------|-------------|
| **è·å–æ–¹å¼** | ä¸€æ¬¡æ€§æ‹¿å¾ˆå¤š | ä¸€é“é“ä¸Šèœ |
| **ç­‰å¾…æ—¶é—´** | éœ€è¦ç­‰å¾…å‡†å¤‡ | ç«‹å³å¼€å§‹ |
| **ä½“éªŒ** | ä¸€æ¬¡æ€§æ»¡è¶³ | é€æ­¥æ»¡è¶³ |

**å…³é”®æ´å¯Ÿ**ï¼šæµå¼å°±åƒç‚¹é¤ï¼Œä¸€é“é“ä¸Šèœï¼Œä¸éœ€è¦ç­‰å¾…å…¨éƒ¨å‡†å¤‡å¥½ã€‚

---

## é«˜çº§åœºæ™¯ç±»æ¯”

### Subgraph æµå¼

#### å‰ç«¯ç±»æ¯”ï¼šåµŒå¥—ç»„ä»¶çš„æ¸²æŸ“è¿½è¸ª

```javascript
// React åµŒå¥—ç»„ä»¶
<App>
  <Dashboard>
    <Chart />         // å­ç»„ä»¶
    <Table />         // å­ç»„ä»¶
  </Dashboard>
  <Sidebar>
    <Menu />          // å­ç»„ä»¶
    <Profile />       // å­ç»„ä»¶
  </Sidebar>
</App>

// React DevTools å¯ä»¥è¿½è¸ªæ¯ä¸ªå­ç»„ä»¶çš„æ¸²æŸ“
```

**å¯¹åº” LangChain**ï¼š
```python
# Subgraph æµå¼
for namespace, mode, data in agent.stream(
    input,
    stream_mode="updates",
    subgraphs=True  # å¯ç”¨å­å›¾æµå¼
):
    print(f"å‘½åç©ºé—´: {namespace}")
    print(f"èŠ‚ç‚¹: {list(data.keys())}")

# è¾“å‡ºï¼š
# å‘½åç©ºé—´: ()                    - ä¸» Agent
# èŠ‚ç‚¹: ['model']
# å‘½åç©ºé—´: ('tools:call_123',)  - å­ Agent
# èŠ‚ç‚¹: ['sub_model']
```

---

#### æ—¥å¸¸ç”Ÿæ´»ç±»æ¯”ï¼šå¿«é€’è½¬è¿è¿½è¸ª

```
ä¸»å¿«é€’ï¼š
1. [åŒ—äº¬] å·²å‘è´§
2. [å¤©æ´¥] è½¬è¿ä¸­å¿ƒ
   â””â”€ å­å¿«é€’ Aï¼š[å¤©æ´¥ä»“åº“] â†’ [å¤©æ´¥é…é€ç«™]
   â””â”€ å­å¿«é€’ Bï¼š[å¤©æ´¥ä»“åº“] â†’ [å¤©æ´¥é…é€ç«™]
3. [åŒ—äº¬] å·²é€è¾¾
```

**å…³é”®æ´å¯Ÿ**ï¼šSubgraph æµå¼è®©ä½ è¿½è¸ªåµŒå¥— Agent çš„æ‰§è¡Œï¼Œå°±åƒå¿«é€’è½¬è¿çš„è¯¦ç»†è¿½è¸ªã€‚

---

### Human-in-the-loop æµå¼

#### å‰ç«¯ç±»æ¯”ï¼šè¡¨å•éªŒè¯ + å®æ—¶åé¦ˆ

```javascript
// è¡¨å•æäº¤å‰éªŒè¯
form.addEventListener('submit', async (e) => {
    e.preventDefault();

    // å®æ—¶æ˜¾ç¤ºéªŒè¯è¿›åº¦
    showProgress('éªŒè¯é‚®ç®±...');
    const emailValid = await validateEmail(email);

    if (!emailValid) {
        // ä¸­æ–­å¹¶ç­‰å¾…ç”¨æˆ·ä¿®æ­£
        showError('é‚®ç®±æ ¼å¼é”™è¯¯ï¼Œè¯·ä¿®æ­£');
        return;  // ä¸­æ–­æµç¨‹
    }

    showProgress('éªŒè¯æ‰‹æœºå·...');
    const phoneValid = await validatePhone(phone);

    if (!phoneValid) {
        showError('æ‰‹æœºå·æ ¼å¼é”™è¯¯ï¼Œè¯·ä¿®æ­£');
        return;  // ä¸­æ–­æµç¨‹
    }

    // ç»§ç»­æäº¤
    showProgress('æäº¤ä¸­...');
    await submitForm();
});
```

**å¯¹åº” LangChain**ï¼š
```python
from langchain.agents.middleware import HumanInTheLoopMiddleware

agent = create_agent(
    model="gpt-4o-mini",
    tools=[...],
    middleware=[
        HumanInTheLoopMiddleware(interrupt_on={"tool_name": True})
    ],
    checkpointer=checkpointer
)

# æµå¼æ‰§è¡Œ + ä¸­æ–­å¤„ç†
for mode, data in agent.stream(input, stream_mode=["updates", "messages"]):
    if mode == "__interrupt__":
        # ç­‰å¾…äººå·¥å®¡æ ¸
        decision = get_user_decision()
        # ç»§ç»­æ‰§è¡Œ
        agent.stream(Command(resume=decision), ...)
```

---

#### æ—¥å¸¸ç”Ÿæ´»ç±»æ¯”ï¼šæœºåœºå®‰æ£€æµç¨‹

```
æ—…å®¢æµç¨‹ï¼š
1. [å€¼æœº] âœ… å®Œæˆ
2. [å®‰æ£€] ğŸ”„ è¿›è¡Œä¸­
   â””â”€ å‘ç°å¯ç–‘ç‰©å“ â†’ â¸ï¸ æš‚åœ â†’ ç­‰å¾…äººå·¥æ£€æŸ¥
   â””â”€ äººå·¥ç¡®è®¤å®‰å…¨ â†’ â–¶ï¸ ç»§ç»­
3. [ç™»æœº] â³ ç­‰å¾…
```

**å…³é”®æ´å¯Ÿ**ï¼šHuman-in-the-loop æµå¼è®©ä½ åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æš‚åœå¹¶ç­‰å¾…äººå·¥å†³ç­–ï¼Œå°±åƒå®‰æ£€æµç¨‹ã€‚

---

## æ€§èƒ½å¼€é”€ç±»æ¯”

### å‰ç«¯ç±»æ¯”ï¼šè™šæ‹Ÿæ»šåŠ¨ vs å…¨é‡æ¸²æŸ“

```javascript
// å…¨é‡æ¸²æŸ“ï¼ˆæ— å¼€é”€ï¼Œä½†ä½“éªŒå·®ï¼‰
const renderAll = () => {
    items.forEach(item => {
        container.appendChild(createItem(item));
    });
};

// è™šæ‹Ÿæ»šåŠ¨ï¼ˆå°å¼€é”€ï¼Œä½“éªŒå¥½ï¼‰
const renderVirtual = () => {
    const visibleItems = getVisibleItems();  // é¢å¤–è®¡ç®—
    visibleItems.forEach(item => {
        container.appendChild(createItem(item));
    });
};

// å¼€é”€ï¼šè™šæ‹Ÿæ»šåŠ¨å¢åŠ  ~5-10% è®¡ç®—ï¼Œä½†ç”¨æˆ·ä½“éªŒæå‡ 10 å€
```

**å¯¹åº” LangChain**ï¼š
```python
# æ‰¹é‡è°ƒç”¨ï¼ˆæ— å¼€é”€ï¼‰
result = chain.invoke(input)

# æµå¼è°ƒç”¨ï¼ˆ<10% å¼€é”€ï¼Œ2025 ä¼˜åŒ–åï¼‰
async for chunk in chain.astream(input):
    print(chunk.content, end="")

# å¼€é”€ï¼šæµå¼å¢åŠ  <10% è®¡ç®—ï¼Œä½†ç”¨æˆ·ä½“éªŒæå‡æ˜¾è‘—
```

---

### æ—¥å¸¸ç”Ÿæ´»ç±»æ¯”ï¼šé«˜é“ vs æ™®é€šç«è½¦

| ç‰¹æ€§ | æ™®é€šç«è½¦ï¼ˆæ‰¹é‡ï¼‰ | é«˜é“ï¼ˆæµå¼ï¼‰ |
|------|-----------------|-------------|
| **æˆæœ¬** | ä½ | é«˜ 10% |
| **ä½“éªŒ** | æ…¢ | å¿« |
| **ä»·å€¼** | æˆæœ¬ä¼˜å…ˆ | ä½“éªŒä¼˜å…ˆ |

**å…³é”®æ´å¯Ÿ**ï¼šæµå¼çš„å°é¢å¼€é”€ï¼ˆ<10%ï¼‰æ¢æ¥çš„ç”¨æˆ·ä½“éªŒæå‡è¿œå¤§äºæˆæœ¬ã€‚

---

## ç±»æ¯”æ€»ç»“è¡¨

| LangChain æ¦‚å¿µ | å‰ç«¯ç±»æ¯” | æ—¥å¸¸ç”Ÿæ´»ç±»æ¯” | æ ¸å¿ƒæ´å¯Ÿ |
|---------------|----------|-------------|---------|
| **æµå¼æ‰§è¡Œ** | Server-Sent Events | çœ‹ç›´æ’­ vs çœ‹å½•æ’­ | æ„Ÿè§‰æ›´å¿«ï¼Œä¸æ˜¯çœŸçš„æ›´å¿« |
| **stream_mode="updates"** | React DevTools ç»„ä»¶æ ‘ | å¤–å–é…é€è¿›åº¦ | è¿½è¸ªæ¯ä¸€æ­¥æ‰§è¡Œ |
| **stream_mode="messages"** | æ‰“å­—æœºæ•ˆæœ | è¯­éŸ³è½¬æ–‡å­—å®æ—¶æ˜¾ç¤º | çœ‹åˆ°"æ€è€ƒè¿‡ç¨‹" |
| **stream_mode="custom"** | æ–‡ä»¶ä¸Šä¼ è¿›åº¦æ¡ | æ´—è¡£æœºçŠ¶æ€æ˜¾ç¤º | è‡ªå®šä¹‰è¿›åº¦ä¿¡å· |
| **å¤šæ¨¡å¼ç»„åˆ** | Chrome DevTools | é¤å…ç‚¹é¤ç³»ç»Ÿ | åŒæ—¶çœ‹åˆ°å¤šç§ä¿¡æ¯ |
| **å¼‚æ­¥æµå¼** | async/await | å¤šçª—å£é“¶è¡Œ | ä¸é˜»å¡ä¸»çº¿ç¨‹ |
| **æµå¼ vs æ‰¹é‡** | æ‡’åŠ è½½ vs å…¨é‡åŠ è½½ | ç‚¹é¤ vs è‡ªåŠ©é¤ | é€æ­¥æ»¡è¶³éœ€æ±‚ |
| **Subgraph æµå¼** | åµŒå¥—ç»„ä»¶æ¸²æŸ“ | å¿«é€’è½¬è¿è¿½è¸ª | è¿½è¸ªåµŒå¥—æ‰§è¡Œ |
| **Human-in-the-loop** | è¡¨å•éªŒè¯ | æœºåœºå®‰æ£€ | ä¸­æ–­å¹¶ç­‰å¾…å†³ç­– |
| **æ€§èƒ½å¼€é”€** | è™šæ‹Ÿæ»šåŠ¨ | é«˜é“ vs æ™®é€šç«è½¦ | å°å¼€é”€æ¢å¤§ä½“éªŒ |

---

## è®°å¿†æŠ€å·§

### å‰ç«¯å¼€å‘è€…è®°å¿†æ³•

- **æµå¼ = SSE**ï¼šæŒç»­æ¨é€æ•°æ®
- **updates = React DevTools**ï¼šç»„ä»¶æ›´æ–°è¿½è¸ª
- **messages = æ‰“å­—æœºæ•ˆæœ**ï¼šé€å­—è¾“å‡º
- **custom = è¿›åº¦æ¡**ï¼šè‡ªå®šä¹‰è¿›åº¦
- **å¼‚æ­¥ = async/await**ï¼šéé˜»å¡æ‰§è¡Œ

---

### éæŠ€æœ¯èƒŒæ™¯è®°å¿†æ³•

- **æµå¼ = ç›´æ’­**ï¼šå®æ—¶çœ‹åˆ°å†…å®¹
- **updates = å¤–å–è¿›åº¦**ï¼šæ¯ä¸€æ­¥éƒ½èƒ½çœ‹åˆ°
- **messages = è¯­éŸ³è½¬æ–‡å­—**ï¼šé€å­—æ˜¾ç¤º
- **custom = æ´—è¡£æœºçŠ¶æ€**ï¼šè‡ªå®šä¹‰æç¤º
- **å¼‚æ­¥ = å¤šçª—å£é“¶è¡Œ**ï¼šåŒæ—¶å¤„ç†å¤šä¸ªä»»åŠ¡

---

## å®æˆ˜åº”ç”¨ç±»æ¯”

### åœºæ™¯ 1ï¼šChatGPT å¼å¯¹è¯

**å‰ç«¯ç±»æ¯”**ï¼š
```javascript
// ç±»ä¼¼ ChatGPT çš„æ‰“å­—æ•ˆæœ
const streamResponse = async (prompt) => {
    const response = await fetch('/api/chat', {
        method: 'POST',
        body: JSON.stringify({ prompt })
    });

    const reader = response.body.getReader();
    const decoder = new TextDecoder();

    while (true) {
        const { done, value } = await reader.read();
        if (done) break;

        const chunk = decoder.decode(value);
        displayText(chunk);  // é€å­—æ˜¾ç¤º
    }
};
```

**LangChain å®ç°**ï¼š
```python
async for chunk in chain.astream({"input": prompt}):
    print(chunk.content, end="", flush=True)
```

---

### åœºæ™¯ 2ï¼šå¤šæ­¥ Agent ç›‘æ§

**æ—¥å¸¸ç±»æ¯”**ï¼š
```
é¡¹ç›®ç®¡ç†çœ‹æ¿ï¼š
1. [éœ€æ±‚åˆ†æ] âœ… å®Œæˆ
2. [è®¾è®¡æ–¹æ¡ˆ] ğŸ”„ è¿›è¡Œä¸­
3. [å¼€å‘å®ç°] â³ ç­‰å¾…
4. [æµ‹è¯•éªŒè¯] â³ ç­‰å¾…
5. [ä¸Šçº¿éƒ¨ç½²] â³ ç­‰å¾…
```

**LangChain å®ç°**ï¼š
```python
for chunk in agent.stream(input, stream_mode="updates"):
    for node_name, data in chunk.items():
        print(f"[{node_name}] âœ… å®Œæˆ")
```

---

### åœºæ™¯ 3ï¼šæ•°æ®å¤„ç†è¿›åº¦

**å‰ç«¯ç±»æ¯”**ï¼š
```javascript
// æ‰¹é‡å›¾ç‰‡å¤„ç†è¿›åº¦
const processImages = async (images) => {
    for (let i = 0; i < images.length; i++) {
        await processImage(images[i]);
        updateProgress((i + 1) / images.length * 100);
    }
};
```

**LangChain å®ç°**ï¼š
```python
from langgraph.config import get_stream_writer

def process_data(items: list) -> str:
    writer = get_stream_writer()
    for i, item in enumerate(items):
        writer(f"è¿›åº¦: {(i+1)/len(items)*100:.1f}%")
        # å¤„ç†é€»è¾‘
    return "å®Œæˆ"
```

---

## å‚è€ƒèµ„æº

- **å®˜æ–¹æ–‡æ¡£**ï¼šhttps://docs.langchain.com/oss/python/langchain/streaming/overview
- **ç›¸å…³çŸ¥è¯†ç‚¹**ï¼š
  - 01_30å­—æ ¸å¿ƒ - æ ¸å¿ƒå®šä¹‰
  - 04_æœ€å°å¯ç”¨ - æœ€å° API é›†
  - 07_å®æˆ˜ä»£ç  - å®Œæ•´ä»£ç ç¤ºä¾‹

---

**ç‰ˆæœ¬**ï¼šLangChain 0.3.x (2025-2026)
**æœ€åæ›´æ–°**ï¼š2026-02-21
**æ ¸å¿ƒç†å¿µ**ï¼šé€šè¿‡åŒé‡ç±»æ¯”ï¼ˆå‰ç«¯ + æ—¥å¸¸ç”Ÿæ´»ï¼‰é™ä½å­¦ä¹ é—¨æ§›ï¼Œå¿«é€Ÿå»ºç«‹ç›´è§‰ç†è§£ã€‚
