# Prompt Templates 模板系统 - 概览

## 知识点概述

**Prompt Templates 模板系统**是 Pi-mono 的核心定制化功能之一，通过 Markdown + YAML frontmatter + Bash 风格变量替换，实现提示词的复用、版本控制和团队协作。

**学习时长：** 1.5 小时
**难度等级：** ⭐⭐☆☆☆（中等偏易）
**前置知识：** Markdown 基础、Bash 基础、Git 基础

---

## 核心价值

### 为什么要学习 Prompt Templates？

1. **提高效率** - 避免重复编写相似的提示词
2. **保证质量** - 使用经过验证的模板，减少错误
3. **团队协作** - 共享最佳实践，统一团队标准
4. **版本控制** - 像管理代码一样管理提示词
5. **工程化** - 将提示词工程化，支持规模化应用

### 实际应用场景

- **代码审查** - 结构化的代码审查流程
- **测试生成** - 自动生成单元测试
- **文档生成** - 自动生成 API 文档
- **问题分析** - 系统化的问题分析流程
- **团队协作** - 统一的团队工作流

---

## 学习路径

### 快速上手（30分钟）

1. **[30字核心](./01_30字核心.md)** - 5分钟
   - 理解 Prompt Templates 的本质
   - 掌握三大核心特性

2. **[最小可用](./04_最小可用.md)** - 15分钟
   - 创建第一个模板
   - 学会基本使用方法

3. **[双重类比](./05_双重类比.md)** - 10分钟
   - 通过类比快速理解
   - 建立知识连接

### 深入理解（45分钟）

4. **[第一性原理](./02_第一性原理.md)** - 15分钟
   - 理解设计决策的原因
   - 掌握推理链

5. **[核心概念](./03_核心概念_01_Markdown模板.md)** - 20分钟
   - Markdown 模板格式
   - 变量插值语法
   - 模板加载机制

6. **[反直觉点](./06_反直觉点.md)** - 10分钟
   - 避免常见错误
   - 理解设计权衡

### 实战应用（30分钟）

7. **[实战代码](./07_实战代码_01_基础模板创建.md)** - 20分钟
   - 基础模板创建
   - 变量插值使用
   - 模板加载配置

8. **[面试必问](./08_面试必问.md)** - 10分钟
   - 掌握常见面试题
   - 准备实际案例

### 进阶提升（可选）

9. **[化骨绵掌](./09_化骨绵掌.md)** - 20分钟
   - 深层洞察
   - 设计哲学
   - 最佳实践

10. **[一句话总结](./10_一句话总结.md)** - 5分钟
    - 核心要点回顾
    - 记忆技巧

---

## 知识点结构

### 基础维度（8个文件）

| 文件 | 内容 | 学习时长 |
|------|------|---------|
| [01_30字核心](./01_30字核心.md) | 核心概念浓缩 | 5分钟 |
| [02_第一性原理](./02_第一性原理.md) | 设计推理链 | 15分钟 |
| [04_最小可用](./04_最小可用.md) | 快速上手指南 | 15分钟 |
| [05_双重类比](./05_双重类比.md) | TypeScript + 生活类比 | 10分钟 |
| [06_反直觉点](./06_反直觉点.md) | 常见误区 | 10分钟 |
| [08_面试必问](./08_面试必问.md) | 面试题库 | 10分钟 |
| [09_化骨绵掌](./09_化骨绵掌.md) | 深层洞察 | 20分钟 |
| [10_一句话总结](./10_一句话总结.md) | 核心要点 | 5分钟 |

### 核心概念（3个文件）

| 文件 | 内容 | 学习时长 |
|------|------|---------|
| [03_核心概念_01_Markdown模板](./03_核心概念_01_Markdown模板.md) | Markdown 格式详解 | 10分钟 |
| [03_核心概念_02_变量插值](./03_核心概念_02_变量插值.md) | Bash 风格变量语法 | 10分钟 |
| [03_核心概念_03_模板加载](./03_核心概念_03_模板加载.md) | 多源加载机制 | 10分钟 |

### 实战代码（3个文件）

| 文件 | 内容 | 学习时长 |
|------|------|---------|
| [07_实战代码_01_基础模板创建](./07_实战代码_01_基础模板创建.md) | TypeScript 创建模板 | 10分钟 |
| [07_实战代码_02_变量插值使用](./07_实战代码_02_变量插值使用.md) | 变量替换实现 | 10分钟 |
| [07_实战代码_03_模板加载配置](./07_实战代码_03_模板加载配置.md) | 加载器实现 | 10分钟 |

---

## 核心知识点

### 1. Markdown 模板

**格式：**
```markdown
---
description: Template description
---
Template content with $1 variables
```

**特点：**
- YAML frontmatter（可选）
- Markdown body（必需）
- 人类可读 + 机器可解析

### 2. 变量插值

**语法：**
- `$1`, `$2`, `$3` - 位置参数
- `$@` / `$ARGUMENTS` - 所有参数
- `${@:N}` - 从第 N 个参数开始
- `${@:N:L}` - 从第 N 个参数开始，取 L 个

**示例：**
```bash
/template arg1 arg2 arg3
# $1 = "arg1"
# $2 = "arg2"
# $@ = "arg1 arg2 arg3"
# ${@:2} = "arg2 arg3"
```

### 3. 模板加载

**加载顺序：**
1. 项目模板：`./.pi/prompts/` （优先级：高）
2. 全局模板：`~/.pi/agent/prompts/` （优先级：中）
3. 显式路径（优先级：低）

**特点：**
- 零配置
- 文件名即模板名
- 项目模板优先

---

## 快速参考

### 创建模板

```bash
# 创建全局模板
cat > ~/.pi/agent/prompts/greet.md << 'EOF'
---
description: Greet user
---
Hello, $1!
EOF

# 创建项目模板
cat > .pi/prompts/team-review.md << 'EOF'
---
description: Team code review
---
Review code: $1
EOF
```

### 使用模板

```bash
# 启动 pi
pi

# 使用模板
/greet World
/team-review src/utils.ts
```

### 变量语法速查

| 语法 | 说明 | 示例 |
|------|------|------|
| `$1` | 第一个参数 | `/greet Alice` → `$1` = "Alice" |
| `$2` | 第二个参数 | `/compare React Vue` → `$2` = "Vue" |
| `$@` | 所有参数 | `/files a b c` → `$@` = "a b c" |
| `${@:2}` | 从第2个开始 | `/compare base a b` → `${@:2}` = "a b" |
| `${@:2:2}` | 第2-3个参数 | `/process a b c d` → `${@:2:2}` = "b c" |

---

## 常见问题

### Q1: 模板不生效？

**检查清单：**
- ✅ 文件名是否正确？（`.md` 扩展名）
- ✅ 文件位置是否正确？
- ✅ YAML frontmatter 格式是否正确？
- ✅ 是否重启了 pi？

### Q2: 变量替换不工作？

**常见错误：**
```markdown
# ❌ 错误：使用了 Handlebars 语法
Hello, {{name}}!

# ✅ 正确：使用 Bash 风格语法
Hello, $1!
```

### Q3: 项目模板和全局模板有什么区别？

**区别：**
- 项目模板：`./.pi/prompts/`，优先级高，项目特定
- 全局模板：`~/.pi/agent/prompts/`，优先级低，跨项目通用

### Q4: 如何传递包含空格的参数？

**使用引号：**
```bash
✅ /review "src/utils/helper functions.ts"
❌ /review src/utils/helper functions.ts
```

### Q5: 模板修改后需要重启 Pi 吗？

**是的，需要重启。**

Pi-mono 会缓存模板，修改后不会自动重载。

---

## 最佳实践

### 1. 模板命名

```bash
# ✅ 推荐：小写 + 连字符
code-review.md
team-pr.md
docs-api.md

# ❌ 不推荐：大小写混合
CodeReview.md
TeamPR.md
```

### 2. 模板组织

```bash
# 使用前缀组织模板
~/.pi/agent/prompts/
├── code-review.md
├── code-refactor.md
├── docs-api.md
├── docs-readme.md
├── team-pr.md
└── team-bug.md
```

### 3. 版本控制

```bash
# 全局模板
cd ~/.pi/agent/prompts
git init
git add .
git commit -m "Initial templates"

# 项目模板
git add .pi/prompts/
git commit -m "Add team templates"
```

### 4. 模板质量

```markdown
# ✅ 好的模板
---
description: Comprehensive code review
---
You are an expert code reviewer.

Review the following code: $1

Focus on:
- Code quality
- Potential bugs
- Best practices

Provide specific, actionable feedback.

# ❌ 糟糕的模板
---
description: Review
---
Review $1
```

---

## 2025-2026 年最新趋势

根据 2025-2026 年的实际应用，Prompt Templates 已经成为 AI Agent 开发的标准实践：

### 行业验证

1. **[GitHub: Awesome AI System Prompts](https://github.com/dontriskit/awesome-ai-system-prompts)**
   - 所有提示都以 Markdown 格式存储
   - 使用 Git 进行版本控制

2. **[Reddit: LLM真实系统提示Markdown结构化](https://www.reddit.com/r/PromptEngineering/comments/1pseks9/for_people_building_real_systems_with_llms_how_do/)**
   - 将复杂提示视为 Markdown 数据
   - 支持变量插值和版本控制

3. **[Anthropic: Effective context engineering for AI agents](https://www.anthropic.com/engineering/effective-context-engineering-for-ai-agents)**
   - 结构化提示设计
   - 模板质量决定输出质量

### 最佳实践

- **Markdown 作为标准格式** - 易读、易写、易维护
- **Git 管理模板** - 版本控制、团队协作
- **结构化提示设计** - 明确角色、提供上下文、清晰指令
- **模板文档化** - 在模板中包含使用说明

---

## 学习检查清单

完成本知识点后，你应该能够：

### 基础能力
- [ ] 理解 Prompt Templates 的核心价值
- [ ] 创建 Markdown 格式的模板
- [ ] 使用 Bash 风格变量插值
- [ ] 理解模板加载的优先级

### 实践能力
- [ ] 创建全局模板和项目模板
- [ ] 使用位置参数、所有参数、参数切片
- [ ] 为团队创建标准模板库
- [ ] 使用 Git 管理模板

### 高级能力
- [ ] 理解设计决策的第一性原理
- [ ] 编写高质量的模板
- [ ] 实现模板加载器（TypeScript）
- [ ] 优化模板性能和可维护性

---

## 下一步学习

完成 Prompt Templates 后，建议学习：

1. **[Skills 技能包开发](../14_Skills技能包开发/)** - 功能封装
2. **[Extensions 扩展开发基础](../15_Extensions扩展开发基础/)** - 核心扩展机制
3. **[自定义工具注册](../16_自定义工具注册/)** - 工具开发

---

## 参考资源

### 官方资源
- **Pi-mono 源码**: https://github.com/badlogic/pi-mono
- **Extension 示例**: https://github.com/badlogic/pi-mono/tree/main/examples/extensions
- **Skills 示例**: https://github.com/badlogic/pi-mono/tree/main/examples/skills

### 社区资源
- **[Awesome AI System Prompts](https://github.com/dontriskit/awesome-ai-system-prompts)** - 系统提示精选集
- **[Claude Code Prompts](https://github.com/Rtur2003/Claude-Code-Promts)** - Claude 提示模板库
- **[Context Engineering](https://github.com/bonigarcia/context-engineering)** - 上下文工程模板

### 学习资源
- **[Anthropic: Effective context engineering](https://www.anthropic.com/engineering/effective-context-engineering-for-ai-agents)** - 官方指南
- **[Reddit: Prompt Engineering](https://www.reddit.com/r/PromptEngineering/)** - 社区讨论
- **[The Ultimate Guide to AI Prompt Engineering [2025]](https://www.v7labs.com/blog/prompt-engineering-guide)** - 完整指南

---

## 总结

**Prompt Templates 的核心价值：**

1. **极简主义** - 零依赖、零配置、零学习成本
2. **开发者友好** - 使用熟悉的格式和语法
3. **版本控制友好** - 易于使用 Git 管理
4. **团队协作友好** - 共享最佳实践
5. **工程化** - 将提示词工程化，支持规模化应用

**记住这一句话：**

> Pi-mono 的 Prompt Templates 证明了：最好的工具不是功能最多的，而是最容易使用、最容易维护、最容易协作的。

---

**版本：** v1.0
**最后更新：** 2026-02-20
**维护者：** Claude Code

**文档完整性：** ✅ 15/15 文件已生成
