# RunnablePassthrough 高级用法 - 完整学习指南

> **系统化学习 RunnablePassthrough 的所有知识点**

---

## 学习路径

### 第一步：快速入门（30分钟）

1. **[30字核心](./01_30字核心.md)** - 用30字理解核心概念
2. **[一句话总结](./10_一句话总结.md)** - 一句话记住精髓
3. **[最小可用](./04_最小可用.md)** - 20%核心知识解决80%问题

### 第二步：深入理解（2小时）

4. **[第一性原理](./02_第一性原理.md)** - 从根本原理理解必然性
5. **[双重类比](./05_双重类比.md)** - 前端开发 + 日常生活类比
6. **[反直觉点](./06_反直觉点.md)** - 避免常见误区

### 第三步：核心概念（3小时）

7. **[assign 方法](./03_核心概念_01_assign方法.md)** - 深入 assign 方法原理
8. **[数据透传与增强](./03_核心概念_02_数据透传与增强.md)** - 两种核心模式
9. **[上下文保持](./03_核心概念_03_上下文保持.md)** - 上下文管理机制

### 第四步：实战代码（4小时）

10. **[基础用法](./07_实战代码_01_基础用法.md)** - 完整可运行示例
11. **[assign 方法详解](./07_实战代码_02_assign方法详解.md)** - assign 高级技巧
12. **[RAG 上下文注入](./07_实战代码_03_RAG上下文注入.md)** - RAG 实战场景
13. **[复杂链构建](./07_实战代码_04_复杂链构建.md)** - 复杂链模式
14. **[生产环境最佳实践](./07_实战代码_05_生产环境最佳实践.md)** - 生产级实践

### 第五步：巩固提升（1小时）

15. **[面试必问](./08_面试必问.md)** - 高频面试题及出彩回答
16. **[化骨绵掌](./09_化骨绵掌.md)** - 10张知识卡片快速复习

---

## 核心知识点

### 1. 基础概念
- RunnablePassthrough 是什么
- 为什么需要数据透传
- assign 方法的作用

### 2. 两种核心用法
- **直接透传**：`RunnablePassthrough()` - 原样返回输入
- **assign 方法**：`RunnablePassthrough.assign()` - 添加新字段

### 3. 三个核心概念
- **assign 方法**：在原有字典基础上添加新字段
- **数据透传与增强**：两种核心的数据处理模式
- **上下文保持**：RAG 管道的关键机制

### 4. 五个实战场景
- 基础用法
- assign 方法详解
- RAG 上下文注入
- 复杂链构建
- 生产环境最佳实践

---

## 学习建议

### 初学者路径
1. 先读 [30字核心](./01_30字核心.md) 和 [最小可用](./04_最小可用.md)
2. 运行 [基础用法](./07_实战代码_01_基础用法.md) 中的代码
3. 理解 [双重类比](./05_双重类比.md)
4. 实践 [RAG 上下文注入](./07_实战代码_03_RAG上下文注入.md)

### 进阶学习路径
1. 深入 [第一性原理](./02_第一性原理.md)
2. 掌握 [核心概念](./03_核心概念_01_assign方法.md)
3. 学习 [复杂链构建](./07_实战代码_04_复杂链构建.md)
4. 应用 [生产环境最佳实践](./07_实战代码_05_生产环境最佳实践.md)

### 面试准备路径
1. 复习 [化骨绵掌](./09_化骨绵掌.md) 的10张卡片
2. 练习 [面试必问](./08_面试必问.md) 的问题
3. 理解 [反直觉点](./06_反直觉点.md) 避免踩坑

---

## 核心要点速查

| 概念 | 用法 | 场景 |
|------|------|------|
| 直接透传 | `RunnablePassthrough()` | 保持原始输入 |
| assign 方法 | `RunnablePassthrough.assign(field=runnable)` | 添加新字段 |
| 链式 assign | 多个 assign 串联 | 多步骤累积 |
| itemgetter | `itemgetter("key") \| runnable` | 提取特定字段 |

---

## 常见问题

### Q1: 什么时候用 RunnablePassthrough？
**A**: 需要保持原始输入或在原有数据基础上添加新字段时。

### Q2: assign 和直接透传有什么区别？
**A**: 
- 直接透传：原样返回，支持任何类型
- assign：添加新字段，只支持字典

### Q3: 为什么 RAG 必须用 RunnablePassthrough？
**A**: RAG 需要同时访问问题和上下文，必须保持问题才能生成正确的 prompt。

---

## 参考资源

**官方文档（2025-2026）**：
- [RunnablePassthrough API Reference](https://reference.langchain.com/v0.3/python/core/runnables/langchain_core.runnables.passthrough.RunnablePassthrough.html)
- [LCEL Concepts](https://python.langchain.com/docs/concepts/lcel)

**2025-2026 最佳实践**：
- [Building Production-Ready AI Pipelines](https://medium.com/@sajo02/building-production-ready-ai-pipelines-with-langchain-runnables-a-complete-lcel-guide-2f9b27f6d557)
- [Master LangChain in 2025](https://towardsai.net/p/machine-learning/master-langchain-in-2025-from-rag-to-tools-complete-guide)
- [LangChain Best Practices](https://www.swarnendu.de/blog/langchain-best-practices)

---

**版本**: v1.0
**最后更新**: 2026-02-19
**适用**: LangChain 0.3+, Python 3.13+
