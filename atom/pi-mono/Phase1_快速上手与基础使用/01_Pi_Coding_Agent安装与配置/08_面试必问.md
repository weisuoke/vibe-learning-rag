# 面试必问

> Pi Coding Agent 安装与配置的高频面试问题与出彩回答

---

## 问题："请介绍一下 Pi Coding Agent 的安装和配置流程"

### 普通回答（❌ 不出彩）

"Pi Coding Agent 通过 npm 全局安装，然后配置 API 密钥或使用 OAuth 登录，就可以使用了。"

**问题：**
- 太简单，没有展示深度理解
- 没有说明为什么这样设计
- 没有提到实际应用中的考虑

---

### 出彩回答（✅ 推荐）

> **Pi Coding Agent 的安装与配置体现了三层设计理念：**
>
> **1. 极简安装（npm 全局安装）**
>
> Pi 选择 npm 全局安装而不是二进制分发，原因是：
> - Node.js 生态的标准做法，跨平台兼容性好
> - 全局安装后任何目录都能使用 `pi` 命令
> - 更新简单（`npm update -g`）
> - 可以从源码运行（`./pi-test.sh`），方便开发和调试
>
> ```bash
> # 生产使用
> npm install -g @mariozechner/pi-coding-agent
> pi
>
> # 开发调试
> git clone https://github.com/badlogic/pi-mono.git
> npm install && npm run build
> ./pi-test.sh
> ```
>
> **2. 统一认证抽象（支持 15+ Provider）**
>
> Pi 通过 pi-ai 包提供统一的 LLM API 抽象，支持两种认证方式：
>
> - **API 密钥**：适合生产环境，精确控制成本和权限
>   - 环境变量：`export ANTHROPIC_API_KEY=sk-ant-...`
>   - auth.json：持久化存储，支持密钥管理工具（`"!op read 'op://vault/key'"`）
>   - 优先级：CLI 参数 > auth.json > 环境变量
>
> - **OAuth 订阅**：适合个人使用，无需管理密钥
>   - `/login` 命令启动浏览器认证
>   - Token 自动刷新，存储在 `~/.pi/agent/auth.json`
>   - 支持 Claude Pro、ChatGPT Plus、GitHub Copilot 等
>
> **3. 分层配置系统（全局 + 项目）**
>
> Pi 的配置遵循"就近原则"，优先级为：
> ```
> CLI 参数 > .pi/settings.json > ~/.pi/agent/settings.json > 默认值
> ```
>
> 这种设计的价值在于：
> - 全局配置：个人偏好（主题、默认模型）
> - 项目配置：项目特定需求（上下文、自定义工具）
> - 团队协作：项目配置可提交到 Git，团队共享
>
> **与实际应用的联系：**
>
> 在实际工作中，我会这样配置 Pi：
>
> ```bash
> # 1. 全局配置（个人偏好）
> ~/.pi/agent/settings.json:
> {
>   "theme": "dark",
>   "defaultProvider": "anthropic",
>   "defaultModel": "claude-sonnet-4"
> }
>
> # 2. 项目配置（团队共享）
> .pi/settings.json:
> {
>   "defaultModel": "claude-opus-4",  # 这个项目需要更强的模型
>   "compaction": {
>     "keepRecentTokens": 50000  # 长上下文需求
>   }
> }
>
> .pi/AGENTS.md:
> """
> # 项目规范
> - TypeScript + ESLint + Prettier
> - 测试框架：Jest
> - 提交前必须通过 lint 和 test
> """
>
> # 3. 提交到 Git（团队协作）
> git add .pi/
> git commit -m "Add Pi configuration for team"
> ```
>
> **Pi 与 Claude Code 的区别：**
>
> Pi 不是 Claude Code 的简化版，而是完全不同的设计理念：
> - Claude Code：功能完整的开箱即用工具
> - Pi：极简核心 + 可扩展框架（通过 TypeScript Extensions）
>
> Pi 可以作为 SDK 嵌入到自己的应用中（参考 openclaw/openclaw 项目），这是 Claude Code 做不到的。

---

### 为什么这个回答出彩？

1. ✅ **多层次解释**：从安装、认证、配置三个层面系统性说明
2. ✅ **原理深度**：解释了为什么选择 npm、为什么支持多 Provider、为什么需要分层配置
3. ✅ **代码示例**：提供了具体的配置示例，展示实际应用能力
4. ✅ **对比分析**：说明了 API 密钥 vs OAuth、Pi vs Claude Code 的区别
5. ✅ **实际应用**：展示了在团队协作中如何配置 Pi
6. ✅ **架构理解**：提到了 pi-ai 包的统一抽象、SDK 嵌入等高级概念

---

## 追问："如果在生产环境部署 Pi，你会如何配置？"

### 出彩回答（✅ 推荐）

> **生产环境部署 Pi 需要考虑安全性、成本控制和可维护性：**
>
> **1. 认证方式：使用 API 密钥 + 密钥管理工具**
>
> ```bash
> # 不推荐：明文存储
> export ANTHROPIC_API_KEY=sk-ant-...
>
> # 推荐：使用密钥管理工具
> # ~/.pi/agent/auth.json
> {
>   "anthropic": {
>     "type": "api_key",
>     "key": "!op read 'op://vault/anthropic/api-key'"
>     # 从 1Password 读取，不存储明文
>   }
> }
>
> # 或使用环境变量（CI/CD）
> # 在 GitHub Actions 中
> - name: Run Pi
>   env:
>     ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
>   run: pi -p "Review this PR"
> ```
>
> **2. 成本控制：设置限额和监控**
>
> ```bash
> # 在 Anthropic Console 中：
> # - 设置每月最大消费（如 $500）
> # - 限制 API 调用频率
> # - 配置告警（消费达到 80% 时通知）
>
> # 使用便宜的模型处理简单任务
> pi --model claude-sonnet-4  # 成本低
>
> # 只在复杂任务时使用强大模型
> pi --model claude-opus-4  # 能力强但成本高
> ```
>
> **3. 配置管理：项目配置 + 环境变量**
>
> ```bash
> # .pi/settings.json（提交到 Git）
> {
>   "defaultProvider": "anthropic",
>   "defaultModel": "claude-sonnet-4",
>   "retry": {
>     "enabled": true,
>     "maxRetries": 3
>   },
>   "compaction": {
>     "enabled": true,
>     "keepRecentTokens": 30000
>   }
> }
>
> # 敏感信息通过环境变量注入
> # .env（不提交到 Git）
> ANTHROPIC_API_KEY=sk-ant-...
> ```
>
> **4. 安全性：文件权限 + 审计日志**
>
> ```bash
> # 确保 auth.json 权限正确
> chmod 600 ~/.pi/agent/auth.json
>
> # 定期轮换 API 密钥
> # 每 90 天更换一次
>
> # 审计日志（通过 Extension 实现）
> # 记录所有工具调用和 API 请求
> ```
>
> **5. 高可用：多 Provider 备份**
>
> ```bash
> # 配置多个 Provider
> # ~/.pi/agent/auth.json
> {
>   "anthropic": { "type": "api_key", "key": "..." },
>   "openai": { "type": "api_key", "key": "..." },
>   "xai": { "type": "api_key", "key": "..." }
> }
>
> # 主 Provider 不可用时自动切换
> # （需要通过 Extension 实现）
> ```

---

## 学习检查

掌握这些面试问题后，你应该能够：

- [ ] 系统性地介绍 Pi 的安装与配置流程
- [ ] 解释 Pi 的设计理念和架构选择
- [ ] 说明不同认证方式的适用场景
- [ ] 展示在生产环境中的配置最佳实践
- [ ] 对比 Pi 与其他 AI Coding Agent 的区别

---

**来源：**
- [Pi-mono README](https://github.com/badlogic/pi-mono/blob/main/packages/coding-agent/README.md) - 2026-02-17
- [Providers 文档](https://github.com/badlogic/pi-mono/blob/main/packages/coding-agent/docs/providers.md) - 2026-02-17
- [Settings 文档](https://github.com/badlogic/pi-mono/blob/main/packages/coding-agent/docs/settings.md) - 2026-02-17
- [Mario Zechner 博客](https://mariozechner.at/posts/2025-11-30-pi-coding-agent) - 设计理念
