# 实战代码 02：多模型协作场景

> 展示如何利用不同模型的优势进行成本优化和任务分配

---

## 场景概述

通过配置 Scoped Models 快速切换模型，根据任务复杂度选择合适的模型。

---

## 配置 Scoped Models

```bash
pi
> /scoped-models claude-haiku-4 claude-sonnet-4 claude-opus-4

Scoped models configured:
1. claude-haiku-4 (fast, $0.25/$1.25 per 1M tokens)
2. claude-sonnet-4 (balanced, $3/$15 per 1M tokens)
3. claude-opus-4 (powerful, $15/$75 per 1M tokens)

Use Ctrl+P to cycle forward, Shift+Ctrl+P to cycle backward
```

---

## 任务 1：简单代码生成（Haiku）

```bash
> /model claude-haiku-4

> 请写一个函数判断字符串是否为回文

AI: [生成简单函数]
```

**生成代码：**
```typescript
function isPalindrome(str: string): boolean {
  const cleaned = str.toLowerCase().replace(/[^a-z0-9]/g, '');
  return cleaned === cleaned.split('').reverse().join('');
}
```

**成本：** ~$0.01

---

## 任务 2：代码审查（Sonnet）

```bash
> Ctrl+P  # 切换到 Sonnet

> 请审查 @src/api/users.ts 的代码质量

AI: [详细分析代码质量、安全问题、性能优化建议]
```

**成本：** ~$0.05

---

## 任务 3：架构设计（Opus）

```bash
> Ctrl+P  # 切换到 Opus

> 请设计一个分布式用户认证系统，支持 10M+ 用户

AI: [深度架构设计，包括：
- 微服务拆分
- 数据库分片策略
- 缓存层设计
- 负载均衡方案
- 安全考虑
- 监控和告警]
```

**成本：** ~$0.30

---

## 成本对比

| 任务类型 | 推荐模型 | 成本 | 质量 |
|---------|---------|------|------|
| 简单代码生成 | Haiku | $0.01 | ⭐⭐⭐ |
| 代码审查 | Sonnet | $0.05 | ⭐⭐⭐⭐ |
| 架构设计 | Opus | $0.30 | ⭐⭐⭐⭐⭐ |

**总成本：** $0.36（如果全用 Opus：$0.90）
**节省：** 60%

---

**来源：**
- [Pi Coding Agent README](https://github.com/badlogic/pi-mono/blob/main/packages/coding-agent/README.md) - 2026-02
- [Providers 文档](https://github.com/badlogic/pi-mono/blob/main/packages/coding-agent/docs/providers.md) - 2026-02
