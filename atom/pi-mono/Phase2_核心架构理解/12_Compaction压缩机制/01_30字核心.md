# 30字核心

**Compaction 是 Pi-mono 的上下文压缩机制，通过自动总结历史对话来突破 LLM 上下文窗口限制，实现长期对话。**

---

## 为什么需要这30个字？

在 AI Agent 开发中，**上下文管理**是最核心的挑战之一。LLM 的上下文窗口是有限的（如 Claude Opus 4 的 200K tokens），但实际对话可能远超这个限制。

Compaction 解决的核心问题：
- **问题**：对话历史越来越长，超过上下文窗口
- **方案**：自动压缩旧对话为摘要，保留最近对话
- **结果**：Agent 可以进行无限长的对话

---

## 一句话记住

**Compaction = 自动整理笔记本，把旧笔记总结成摘要，腾出空间记录新内容。**

---

## 在 Pi-mono 中的体现

```typescript
// 当上下文接近上限时，自动触发压缩
if (contextTokens > contextWindow - reserveTokens) {
  await compactSession(); // 压缩历史对话
}
```

这就是 Compaction 的核心：**自动、智能、无感知**。

---

**下一步**：理解 Compaction 的第一性原理 → `02_第一性原理.md`
