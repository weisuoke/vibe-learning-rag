# 面试必问

关于文本分块的高频面试问题及出彩回答。

---

## 问题1："在 RAG 系统中，如何选择合适的分块策略？"

### 普通回答（❌ 不出彩）

"一般用 LangChain 的 RecursiveCharacterTextSplitter，设置 chunk_size 为 500，overlap 为 50 就行了。"

### 出彩回答（✅ 推荐）

> **选择分块策略需要考虑三个维度：**
>
> **1. 文档特性维度**
>
> 不同类型的文档需要不同的分块策略：
> - **结构化文档**（Markdown、HTML）：优先按标题/章节分块，保持结构完整
> - **代码文件**：按函数/类分块，使用语言感知的分块器
> - **对话记录**：按对话轮次分块，保持问答配对
> - **纯文本**：递归字符分块，在自然边界切分
>
> **2. 检索需求维度**
>
> 根据检索场景调整块大小：
> - **精准问答**：小块（300-500字符），提高检索精度
> - **摘要生成**：大块（1000-2000字符），保留更多上下文
> - **多轮对话**：中等块（500-800字符），平衡精度和上下文
>
> **3. 系统约束维度**
>
> 考虑技术限制：
> - Embedding 模型的 token 限制
> - LLM 的 context window 大小
> - 向量数据库的存储成本
>
> **实际工作中的做法：**
>
> 我通常会先用递归字符分块作为 baseline，然后通过评估指标（如召回率、答案质量）来调优。如果发现特定类型文档效果不好，再针对性地使用专门的分块器。
>
> 比如在之前的项目中，我们发现技术文档用 Markdown 标题分块效果更好，因为每个章节是一个独立的知识单元。

### 为什么这个回答出彩？

1. ✅ **展示了系统性思维**：从三个维度分析，而不是给一个固定答案
2. ✅ **体现了实战经验**：提到了 baseline + 调优的方法论
3. ✅ **给出了具体例子**：用实际项目经验佐证观点
4. ✅ **没有过度复杂化**：承认递归分块是好的起点

---

## 问题2："chunk_size 和 chunk_overlap 应该怎么设置？"

### 普通回答（❌ 不出彩）

"chunk_size 设置 500，overlap 设置 50，这是常用的配置。"

### 出彩回答（✅ 推荐）

> **这两个参数的设置需要理解它们的本质作用：**
>
> **chunk_size 的本质是精度与完整性的权衡：**
>
> ```
> 小块（200-400）：
> - 优点：检索精度高，向量表示更聚焦
> - 缺点：上下文可能不完整，需要检索更多块
> - 适用：精准问答、FAQ 检索
>
> 大块（800-1500）：
> - 优点：上下文完整，减少检索次数
> - 缺点：可能包含噪音，检索精度下降
> - 适用：摘要生成、长文档理解
> ```
>
> **chunk_overlap 的本质是边界信息的保护：**
>
> 重叠的目的是防止重要信息被切断，而不是复制内容。所以：
> - 重叠比例通常是 chunk_size 的 10-20%
> - 绝对值一般在 50-100 字符
> - 过大的重叠会导致存储浪费和检索冗余
>
> **我的经验法则：**
>
> | 场景 | chunk_size | overlap | 原因 |
> |------|------------|---------|------|
> | 问答系统 | 400 | 50 | 精准匹配优先 |
> | 文档摘要 | 1200 | 100 | 上下文完整优先 |
> | 代码检索 | 800 | 100 | 保持函数完整 |
>
> **更重要的是：** 这些只是起点，实际效果需要通过评估来验证。我会用一组测试问题来评估不同配置的召回率和答案质量，然后选择最优配置。

### 为什么这个回答出彩？

1. ✅ **解释了参数的本质**：不只是给数字，而是解释为什么
2. ✅ **给出了具体场景**：不同场景有不同的最佳配置
3. ✅ **强调了评估的重要性**：参数需要通过实验验证
4. ✅ **展示了工程思维**：有方法论，不是拍脑袋

---

## 问题3："分块策略对 RAG 系统效果有多大影响？"

### 普通回答（❌ 不出彩）

"影响挺大的，分块不好检索效果就不好。"

### 出彩回答（✅ 推荐）

> **分块策略是 RAG 系统中最容易被低估的环节，但它对最终效果的影响是基础性的。**
>
> **影响的三个层面：**
>
> **1. 检索精度层面**
>
> 分块决定了检索的最小粒度。如果一个问题的答案跨越了两个块，那么单独检索任何一个块都无法得到完整答案。
>
> ```
> 问题："Python GIL 对多线程有什么影响？"
>
> 糟糕的分块：
> Chunk 1: "GIL 是全局解释器锁..."
> Chunk 2: "...所以多线程在 CPU 密集型任务中没有优势"
> → 检索到 Chunk 1，但答案不完整
>
> 好的分块：
> Chunk 1: "GIL 是全局解释器锁，它使得多线程在 CPU 密集型任务中没有优势..."
> → 检索到完整答案
> ```
>
> **2. 上下文质量层面**
>
> 分块质量直接影响送给 LLM 的上下文质量。垃圾进，垃圾出。
>
> **3. 系统成本层面**
>
> 分块策略影响：
> - 向量数据库的存储量
> - Embedding API 的调用次数
> - LLM 的 token 消耗
>
> **我的实际经验：**
>
> 在一个技术文档问答项目中，我们仅通过优化分块策略（从固定大小改为 Markdown 标题分块），就将答案准确率从 65% 提升到了 82%，而没有改变任何其他组件。
>
> **所以我的观点是：** 在优化 RAG 系统时，分块策略应该是第一个检查和调优的环节，因为它的投入产出比最高。

### 为什么这个回答出彩？

1. ✅ **量化了影响**：给出了具体的数字（65% → 82%）
2. ✅ **多层面分析**：从精度、质量、成本三个角度
3. ✅ **有实际案例**：用真实项目经验支撑观点
4. ✅ **给出了可操作的建议**：分块是第一个应该优化的环节

---

## 面试技巧总结

| 问题类型 | 回答策略 |
|----------|----------|
| "怎么选择/设置" | 先讲原理，再给具体建议，最后强调需要评估 |
| "有什么影响" | 分层面分析，给具体数字，举实际例子 |
| "有什么区别" | 用表格对比，说明各自适用场景 |

**通用技巧：**
1. 不要只给一个固定答案，展示你理解背后的权衡
2. 用实际项目经验佐证你的观点
3. 强调评估和迭代的重要性
4. 展示系统性思维，而不是零散的知识点

---

**下一步：** [09_化骨绵掌](./09_化骨绵掌.md) - 10个2分钟知识卡片
